"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[899],{66805:function(e,t,n){n.d(t,{H:function(){return d}});var r=n(92809),i=n(77417),a=n(58448),o=n(14347),c=n(85893);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=function(e){var t=e.children,n=e.content,r=e.context,s=e.data,d=e.disabled,l=e.handleClick,p=e.size,f=e.type;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(i.Z,{size:"sm"}),(0,c.jsxs)(a.Z,{align:"flex-end",children:[t,(0,c.jsx)(o.Z,u({content:n,context:r,disabled:d,onClick:l,size:p,type:f},s))]})]})};d.defaultProps={content:"Add",context:"secondary",disabled:!1,size:"sm",type:"button"}},76800:function(e,t,n){n.d(t,{M:function(){return p}});var r=n(92809),i=n(10219),a=n(42426),o=n(19716),c=n(22796),s=n(85893),u=["control","errors","name","space"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p=function(e){var t=e.control,n=e.errors,r=e.name,d=e.space,p=(0,i.Z)(e,u);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,l({control:t,errors:n,locale:a.Z,name:r},p)),d&&(0,s.jsx)(c.Z,{marginBottom:"sm"})]})};p.defaultProps={space:!0}},50899:function(e,t,n){n.d(t,{G:function(){return Q}});var r,i=n(92809),a=n(67294),o=n(93633),c=n(52209),s=(0,n(54397).Ps)(r||(r=(0,c.Z)(["\n  query MEDIAS(\n    $category: String\n    $entity: String\n    $entityId: Int\n    $limit: Int\n    $offset: Int\n    $q: String\n    $type: String\n    $adminId: Int\n    $meta: jsonb\n  ) {\n    items: Media_Entity(\n      limit: $limit\n      offset: $offset\n      where: {\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n        Medium: {\n          adminId: { _eq: $adminId }\n          caption: { _ilike: $q }\n          category: { _eq: $category }\n          type: { _eq: $type }\n          meta: { _contains: $meta }\n        }\n      }\n      order_by: { Medium: { createdAt: desc } }\n    ) {\n      id\n      entity\n      entityId\n      mediaId\n      item: Medium {\n        id\n        caption\n        category\n        createdAt\n        expiryAt\n        filename\n        name\n        type\n        meta\n        userId\n        user: User {\n          id\n          nameFirst\n          nameLast\n        }\n      }\n    }\n    meta: Media_Entity_aggregate(\n      where: {\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n        Medium: {\n          adminId: { _eq: $adminId }\n          caption: { _ilike: $q }\n          category: { _eq: $category }\n          type: { _eq: $type }\n          meta: { _contains: $meta }\n        }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]))),u=n(24237),d=n(80880),l=n(71070),p=n(47357),f=n(29444),m=n(91126),y=n(62906),g=n(80284),h=n(52568),v=n(77417),b=n(58448),j=n(14347),x=n(73165),O=n(80318),w=n(75709),P=n(53825),Z=n(18944),k=n(66805),S=n(85893),I=function(e){var t=e.mediaId,n=e.onSuccess,r=(0,w.D)(P.CI,{variables:{id:t},onCompleted:function(){return n(t)}}),i=(0,O.Z)(r,2),a=i[0],o=i[1].loading;return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(Z.Z,{children:"Are you sure you want to delete this?"}),(0,S.jsx)(k.H,{content:"Delete",context:"danger",disabled:o,handleClick:a})]})},_=n(30266),D=n(64687),C=n.n(D),M=n(18862),z=n(97721),$=n(4513),E=n(52002),A=n(22796),q=n(11570),N=n(55657),F=function(e,t){return"image"===e?null!==t&&void 0!==t&&t.thumbnails&&null!==t&&void 0!==t&&t.thumbnails.length?function(){return(0,S.jsx)(N.Z,{context:"success",icon:"check",size:"sm",title:"Yes"})}:function(){return(0,S.jsx)(N.Z,{context:"warning",icon:"times",size:"sm",title:"No"})}:function(){return(0,S.jsx)(N.Z,{context:"dark",icon:"minus",size:"sm",title:"Unavailable"})}},R=n(6987),T=n(55863);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var B=function(e){var t=e.media,n=e.toggleShow,r=(0,a.useState)(!1),i=r[0],o=r[1],c=t.caption,s=t.createdAt,u=t.entity,d=t.entityId,l=t.filename,f=t.mediaId,m=t.meta,y=t.name,g=t.type,h=t.user,v=(0,w.D)(P.o7,{onCompleted:function(e){o(!1),e&&n&&n()}}),b=(0,O.Z)(v,2),x=b[0],Z=b[1].error,k=[{key:"ID",value:f},{key:"Name",value:y||l},{key:"Caption",value:c},{key:"Entity",value:u?"".concat(u,"#").concat(d):"-"},{key:"Type",value:g},{key:"Uploaded by",value:"".concat(null===h||void 0===h?void 0:h.nameFirst," ").concat(null===h||void 0===h?void 0:h.nameLast)},{key:"Created at",value:(0,M.Z)(s)}];"image"===g&&k.push({key:"Thumbnails",value:F(g,m)});var I=function(){var e=(0,_.Z)(C().mark((function e(){var t,n,r,i;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),n="".concat("https://d1hk88326p7ilp.cloudfront.net","/").concat(null!==m&&void 0!==m&&null!==(t=m.original)&&void 0!==t&&t.relativePath?m.original.relativePath:l),r=(0,R.V)(),(i=new window.FormData).append("sizes",r),i.append("url",n),e.next=8,window.fetch("https://aws-staging.cleverly.works/image/process",{method:"POST",body:i}).then((function(e){return e.json()})).then((function(e){var t,n,r=V({},m)||{},i=e.key,a=e.data.find((function(e){return"large"===e.name}));i.startsWith("https://d1hk88326p7ilp.cloudfront.net")&&(i=i.replace("".concat("https://d1hk88326p7ilp.cloudfront.net","/"),"")),n=a?a.relativePath:i,r.original={relativePath:i},r.thumbnails=e.data||null;var o={extension:null===(t=n)||void 0===t?void 0:t.split(".").pop(),filename:n,meta:r};x({variables:{changes:o,id:f}})})).catch((function(e){(0,T.Tb)({message:e,section:"fetch"})}));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),D=null!==m&&void 0!==m&&m.thumbnails?"Regenerate thumbnails":"Generate thumbnails";return i?(0,S.jsx)(z.Z,{indicator:(0,S.jsx)($.Z,{})}):(0,S.jsxs)(S.Fragment,{children:["image"===g&&(0,S.jsx)(p.Z,{alt:c||l,src:"".concat("https://d1hk88326p7ilp.cloudfront.net","/").concat(l)}),(0,S.jsx)(E.Z,{rows:k}),(0,S.jsx)(A.Z,{}),"image"===g&&(0,S.jsx)(j.Z,{content:D,context:"secondary",disabled:i,onClick:I}),(0,S.jsx)(A.Z,{}),Z&&(0,S.jsx)(q.Z,{content:"There was a problem generating thumbnails",context:"warning"})]})};B.defaultProps={type:"image"};var H=n(26933),J=n(81185),L=n(49705),G=n(1323);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Q=function(e){var t=e.carousel,n=e.category,r=e.children,i=e.data,c=(e.details,e.entity),u=e.entityId,O=e.filters,w=(e.limit,e.listView),P=e.mediaMeta,Z=e.onMediaAdd,k=e.onMediaRemove,_=(e.pagination,e.showActionButtons),D=e.showEntityColumn,C=e.showItemActions,M=e.summary,z=e.type,$=(0,L.x)({filters:O}),E=$.initialData,A=$.ref,q=(0,G.x)(),N=q.hasRole,R=q.user,T=(0,a.useContext)(d.Z),U=(0,o.a)(s,{variables:K(K({},E),{},{entity:c,entityId:u,category:n,adminId:R.adminId,meta:P})}),V=U.data,W=(V=void 0===V?{items:[],meta:{aggregate:{totalCount:0}}}:V).items,Q=V.meta,ee=U.loading,te=U.refetch,ne=function(e){T.close(),i.length||te(),Z&&Z(e)},re=function(e){T.close(),i.length||te(),k&&k(e)},ie=[{context:"primary",icon:["fas","info-circle"],onClick:function(e,t){return function(e){T.show({content:(0,S.jsx)(B,{media:e.data,toggleShow:T.close}),submit:!1,title:"Media Details",width:"50%"})}(t)},tooltip:"Details"}];N("admin")&&ie.push({context:"danger",icon:["fas","trash"],onClick:function(e,t){return function(e){T.show({content:(0,S.jsx)(I,{mediaId:e.data.id,onSuccess:re}),submit:!1,title:"Delete Media"})}(t)},tooltip:"Delete"});var ae=[{hidden:!0},{hidden:!0},{hidden:!0,text:"Caption"},{hidden:!1,text:"File"},{hidden:!D,text:"Entity"},{formatter:function(e){var t,n=e.row;return(0,S.jsx)(Y,{children:(null===n||void 0===n||null===(t=n.authority)||void 0===t?void 0:t.adminOnly)&&(0,S.jsx)(l.Z,{content:"Admin user only",children:(0,S.jsx)(p.Z,{alt:"Admin Only",src:"/messaging/admin-only.svg"})})})},text:"",tooltip:"Only Admin can see"},{formatter:(0,f.Z)("/dashboard/users/view","userId","uploaded"),text:"Uploaded by"},{hidden:!w,text:"Thumbnails"},{hidden:!C,formatter:m.Z,formatterData:ie,text:"Actions"}],oe=[],ce=W.map((function(e){var t=e.entity,n=e.entityId,r=e.id,i=e.item,a=i.caption,o=i.filename,c=i.meta,s=i.name,u=i.type,d=i.user;return{data:i,id:r,userId:null===d||void 0===d?void 0:d.id,file:function(){return(0,S.jsx)(y.Z,{onClick:function(e){return function(e,t){e.preventDefault(),window.open("".concat("https://d1hk88326p7ilp.cloudfront.net","/").concat(t))}(e,o)},children:a||s||o})},entity:t&&"".concat(t,"#").concat(n),authority:c,uploaded:"".concat(null===d||void 0===d?void 0:d.nameFirst," ").concat(null===d||void 0===d?void 0:d.nameLast),thumbnails:F(u,c),actions:""}})),se=(W.forEach((function(e){var t=e.item,n=t.caption,r=t.filename;"image"===t.type&&oe.push({caption:n,filename:r})})),oe),ue=se.length;return(0,S.jsxs)(g.Z,{fitParentHeight:!0,open:!0,title:M,children:[r,t&&ue>0&&(0,S.jsx)(X,{children:(0,S.jsx)(h.Z,{fullWidth:!0,height:"200px",numberOfItems:1,showNavs:!1,showPagination:!0,slides:se.map((function(e){var t=e.caption,n=e.filename;return{node:(0,S.jsx)(p.Z,{alt:t,src:"".concat("https://d1hk88326p7ilp.cloudfront.net","/").concat(n)}),text:" "}}))})}),(0,S.jsx)(J.t,{columns:ae,loading:ee,fullHeight:!0,paginationSize:!1,meta:Q,ref:A,refetch:te,rows:ce}),_&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(v.Z,{size:"sm"}),(0,S.jsxs)(b.Z,{align:"flex-end",children:[(!z||"document"===z)&&(0,S.jsx)(j.Z,{content:"Add Document",context:"secondary",onClick:function(e){e.stopPropagation(),T.show({content:(0,S.jsx)(H.z,{accept:".pdf, .doc, .docx, .xlsx",adminId:R.adminId,category:n,entity:c,entityId:u,expiryShow:!1,mediaMeta:P,onSuccess:ne,type:"document"}),title:"Upload Documents"})},size:"sm"}),(!z||"image"===z||"avatar"===z)&&(0,S.jsx)(j.Z,{content:"Add ".concat((0,x.Z)(z||"Image")),context:"secondary",onClick:function(e){e.stopPropagation(),T.show({content:(0,S.jsx)(H.z,{accept:"image/*",adminId:R.adminId,category:n,entity:c,entityId:u,expiryShow:!1,mediaMeta:P,multiple:!0,onSuccess:ne,type:"image"}),title:"Upload Photos"})},size:"sm"})]})]})]})},Y=u.ZP.div.withConfig({displayName:"table__StyledIcon",componentId:"sc-evooes-0"})(["width:24px;"]),X=u.ZP.div.withConfig({displayName:"table__StyledCarousel",componentId:"sc-evooes-1"})(["border:1px solid #eee;"]);Q.defaultProps={carousel:!0,category:null,data:[],details:!1,filters:{},limit:20,listView:!1,mediaMeta:null,showActionButtons:!0,showEntityColumn:!1,showItemActions:!0,summary:"Media",type:null}},26933:function(e,t,n){n.d(t,{z:function(){return $}});var r=n(92809),i=n(30266),a=n(80318),o=n(64687),c=n.n(o),s=n(67294),u=n(42283),d=n(79665),l=n(30381),p=n.n(l),f=n(75709),m=n(53825),y=n(43566),g=n(97721),h=n(4513),v=n(97202),b=n(65375),j=n(71247),x=n(84550),O=n(31990),w=n(18944),P=n(66805),Z=n(76800),k=n(3805),S=n(19501),I=(0,S.Ry)().shape({caption:(0,S.Z_)(),dropzone:(0,S.nK)().required()}),_=n(1323),D=n(55863),C=n(85893);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var $=function(e){var t=e.accept,n=e.adminId,r=e.category,o=e.entity,l=e.entityId,S=e.expiryShow,M=e.mediaMeta,$=e.multiple,E=e.onSuccess,A=e.type,q=e.showSubmitButton,N=(0,s.useState)(!1),F=N[0],R=N[1],T=(0,s.useState)(!1),U=T[0],V=T[1],B=(0,_.x)().hasRole,H=(0,u.cI)({resolver:(0,d.S)(I)}),J=H.control,L=H.errors,G=H.handleSubmit,W=H.register,K=H.reset,Q=(0,s.useContext)(y.Z).user,Y=(0,f.D)(m.xM),X=(0,a.Z)(Y,2),ee=X[0],te=X[1].loading,ne=(0,f.D)(m.tv),re=(0,a.Z)(ne,2),ie=re[0],ae=re[1].loading,oe=function(){var e=(0,i.Z)(c().mark((function e(t){var a,s,u,d,f;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.adminOnly,s=t.caption,u=t.dropzone,d=t.expiryAt,e.prev=1,R(!0),V(!1),e.t0=Promise,e.next=7,u.map(function(){var e=(0,i.Z)(c().mark((function e(t){var i,o,u,l,f,m,y,g;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=10;break}return e.next=3,(0,k.V)(t,A);case 3:return o=e.sent,u=null,l=null,"image"===A?(f=o.key,m=o.data.find((function(e){return"large"===e.name})),u=m?m.relativePath:f,l={original:{relativePath:f},thumbnails:o.data||null}):u=o.key,y=function(){return"invoice"===r||a?z(z(z({},l),M),{},{adminOnly:!0}):z(z({},l),M)},g={adminId:n,category:r,caption:s,expiryAt:d?p()(d).utc().format():null,extension:null===(i=u)||void 0===i?void 0:i.split(".").pop(),userId:Q.id,filename:u,meta:y(),type:A},e.abrupt("return",g);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:return e.t1=e.sent,e.next=10,e.t0.all.call(e.t0,e.t1);case 10:f=e.sent,ee({variables:{objects:f}}).then(function(){var e=(0,i.Z)(c().mark((function e(t){var n,r,i;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.data,r=n.insert_Media.returning,!o||!l){e.next=6;break}return i=r.map((function(e){return{mediaId:e.id,entity:o,entityId:l}})),e.next=6,ie({variables:{objects:i}});case 6:K(),R(!1),E&&E(r);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=19;break;case 14:e.prev=14,e.t2=e.catch(1),R(!1),V(!0),(0,D.Tb)({message:e.t2,section:"upload"});case 19:case"end":return e.stop()}}),e,null,[[1,14]])})));return function(t){return e.apply(this,arguments)}}(),ce={control:J,errors:L,register:W};if(F||te||ae)return(0,C.jsx)(g.Z,{indicator:(0,C.jsx)(h.Z,{})});var se="image/*"===t?t+", .heic":t;return(0,C.jsxs)(v.Z,{id:"offCanvasForm",handleSubmit:G(oe),children:[(0,C.jsx)(b.Z,{label:"Caption",children:(0,C.jsx)(j.Z,z(z({},ce),{},{name:"caption"}))}),B("admin")&&(0,C.jsx)(x.Z,z(z({},ce),{},{data:[{id:"adminOnly",label:"Admin Only",value:!0}],name:"adminOnly"})),S&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(b.Z,{label:"Expiry"}),(0,C.jsx)(Z.M,z(z({},ce),{},{name:"expiryAt"}))]}),(0,C.jsx)(b.Z,{label:"Media"}),(0,C.jsx)(u.Qr,z(z({},ce),{},{as:(0,C.jsx)(O.Z,{accept:se,multiple:$}),name:"dropzone"})),U&&(0,C.jsx)(w.Z,{context:"danger",content:"Can not upload Media"}),q&&(0,C.jsx)(P.H,{content:"Submit",type:"submit"})]})};$.defaultProps={accept:O.Z.defaultProps.accept,category:null,expiryShow:!0,mediaMeta:null,showSubmitButton:!1,type:"image"}},53825:function(e,t,n){n.d(t,{xM:function(){return u},tv:function(){return d},CI:function(){return l},o7:function(){return p}});var r,i,a,o,c=n(52209),s=n(54397),u=(0,s.Ps)(r||(r=(0,c.Z)(["\n  mutation AddMedia($objects: [Media_insert_input!]!) {\n    insert_Media(objects: $objects) {\n      returning {\n        id\n        filename\n      }\n    }\n  }\n"]))),d=(0,s.Ps)(i||(i=(0,c.Z)(["\n  mutation AddMediaEntity($objects: [Media_Entity_insert_input!]!) {\n    insert_Media_Entity(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),l=(0,s.Ps)(a||(a=(0,c.Z)(["\n  mutation DeleteMedia($id: Int!) {\n    delete_Media_by_pk(id: $id) {\n      id\n    }\n  }\n"]))),p=(0,s.Ps)(o||(o=(0,c.Z)(["\n  mutation UpdateMedia($changes: Media_set_input, $id: Int!) {\n    update_Media_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"])))},6987:function(e,t,n){n.d(t,{V:function(){return r}});var r=function(){var e="cleverly-staging-media";return JSON.stringify([{width:32,height:32,bucket:e,sizeName:"vSmall",fit:"inside"},{width:200,height:200,bucket:e,sizeName:"small",fit:"inside"},{width:600,height:600,bucket:e,sizeName:"medium",fit:"inside"},{width:1200,height:1200,bucket:e,sizeName:"large",fit:"inside"}])}},3805:function(e,t,n){n.d(t,{V:function(){return c}});var r=n(30266),i=n(64687),a=n.n(i),o=n(6987),c=function(){var e=(0,r.Z)(a().mark((function e(t,n){var r,i,c,s,u;return a().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r="cleverly-staging-media",i="https://aws-staging.cleverly.works/aws/s3/upload",(c=new window.FormData).append("file",t,t.name),e.t0=n,e.next="image"===e.t0?7:"document"===e.t0?10:"audio"===e.t0?14:18;break;case 7:return s="https://aws-staging.cleverly.works/image/process",c.append("sizes",(0,o.V)()),e.abrupt("break",19);case 10:case 14:return c.append("bucket",r),c.append("folder","".concat(n,"s")),s=i,e.abrupt("break",19);case 18:return e.abrupt("break",19);case 19:return e.next=21,window.fetch(s,{method:"POST",body:c});case 21:return u=e.sent,e.abrupt("return",u.json());case 23:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},81185:function(e,t,n){n.d(t,{t:function(){return s}});var r=n(67294),i=n(11163),a=n(30493),o=n(52002),c=n(85893),s=(0,r.forwardRef)((function(e,t){var n=e.columns,s=e.history,u=e.initialSort,d=e.isResetTable,l=e.loading,p=e.meta,f=e.paginationSize,m=e.refetch,y=e.rowClick,g=e.rows,h=(0,i.useRouter)(),v=h.query,b=void 0===v?{}:v,j=(0,r.useState)(parseInt(null===b||void 0===b?void 0:b.page,10)||1),x=j[0],O=j[1],w=(0,r.useState)(a.C1.paginationSize),P=w[0],Z=w[1];u||(u={item:"createdAt",order:"desc"}),(0,r.useEffect)((function(){O(1)}),[d]);var k=(0,r.useState)({item:u.item,order:u.order}),S=k[0],I=k[1],_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=h.query,n=void 0===t?{}:t;e>1?n.page=e:delete n.page;var r=Object.keys(n).length>0;if(r){var i=Object.keys(n).map((function(t){return"page"===t?"".concat(t,"=").concat(e):"".concat(t,"=").concat(n[t])})).join("&&");return"?".concat(i)}return{}};(0,r.useImperativeHandle)(t,(function(){return{currentPage:x,pageSize:P,sort:S,resetPagination:function(){!function(){I({item:u.item,order:u.order}),O(1);var e=_();h.push(e),Z(a.C1.paginationSize)}()}}}));return(0,c.jsx)(o.Z,{columns:n,loading:l,paginationSize:f,pagination:p&&!0,paginationProps:p&&{currentPage:x,onPageChange:function(e){var t=_(e);s&&h.push(t),O(e),m&&m()},onPageSizeChange:function(e){e!==a.C1.paginationSize&&(Z(e),m&&m())},pageCount:Math.ceil(p.aggregate.totalCount/P),perPage:P},rowClick:y,rows:g,sort:S,setSort:function(e){var t=e.item,n=e.order;I({item:t,order:n}),m&&m()}})}));s.defaultProps={history:!0,loading:!0,paginationSize:!1}},49705:function(e,t,n){n.d(t,{x:function(){return d}});var r=n(92809),i=n(67294),a=n(63867),o=n(30493),c=n(34770);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var d=function(e){var t,n,s,d,l,p,f,m,y,g,h,v=e.filters,b=e.initialSort,j=(0,i.useRef)();(0,i.useEffect)((function(){var e;(null===j||void 0===j||null===(e=j.current)||void 0===e?void 0:e.currentPage)>1&&(null===j||void 0===j||j.current.resetPagination(),(0,a.Z)("?page=1"))}),[v]);var x=b||{item:"createdAt",order:"desc"},O=(0,r.Z)({},(null===(t=j.current)||void 0===t?void 0:t.sort.item)||x.item,x.inneritem?(0,r.Z)({},x.inneritem,(null===(n=j.current)||void 0===n?void 0:n.sort.order)||x.order):(null===(s=j.current)||void 0===s?void 0:s.sort.order)||x.order);return{initialData:u(u({},v),{},{limit:"Infinity"===(null===(d=j.current)||void 0===d?void 0:d.pageSize)?null:parseInt(null===(l=j.current)||void 0===l?void 0:l.pageSize,10)||o.C1.paginationSize,offset:((null===(p=j.current)||void 0===p?void 0:p.currentPage)-1||0)*((null===(f=j.current)||void 0===f?void 0:f.pageSize)||o.C1.paginationSize),orderBy:(0,c.c)(null===(m=j.current)||void 0===m||null===(y=m.sort)||void 0===y||null===(g=y.item)||void 0===g?void 0:g.replace(/ORDER/i,null===(h=j.current)||void 0===h?void 0:h.sort.order))||O}),initialSort:b,ref:j}}},34770:function(e,t,n){n.d(t,{s:function(){return r},c:function(){return i}});var r=function(e){try{JSON.parse(e)}catch(t){return!1}return!0},i=function(e){try{return JSON.parse(e)}catch(t){return!1}}}}]);