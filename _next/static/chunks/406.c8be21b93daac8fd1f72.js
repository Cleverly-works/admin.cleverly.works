"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[406],{76800:function(t,e,r){r.d(e,{M:function(){return p}});var n=r(92809),a=r(10219),o=r(42426),s=r(19716),c=r(22796),u=r(85893),i=["control","errors","name","space"];function d(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?d(Object(r),!0).forEach((function(e){(0,n.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var p=function(t){var e=t.control,r=t.errors,n=t.name,d=t.space,p=(0,a.Z)(t,i);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(s.Z,l({control:e,errors:r,locale:o.Z,name:n},p)),d&&(0,u.jsx)(c.Z,{marginBottom:"sm"})]})};p.defaultProps={space:!0}},89829:function(t,e,r){r.d(e,{x:function(){return j}});var n=r(92809),a=r(67294),o=r(42283),s=r(83894),c=r(97202),u=r(78215),i=r(2356),d=r(65375),l=r(58448),p=r(14347),f=r(95146),y=r(76800),b=r(85893);function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function m(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(Object(r),!0).forEach((function(e){(0,n.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var j=function(t){var e=t.defaultValues,r=(t.open,t.reset),n=t.submit,h=t.setAsAt,j=t.setUserId,O=t.user,v=(0,o.cI)({defaultValues:e}),g=v.control,Z=v.errors,S=v.handleSubmit,w=v.setValue,A=v.watch,P={control:g,errors:Z},x=A("asAt",e.asAt),I=A("userId");(0,a.useEffect)((function(){h((0,s.Z)(x||new Date)),j&&j((null===I||void 0===I?void 0:I.value)||e.userId)}),[x,I]);return(0,b.jsxs)(c.Z,{id:"offCanvasFilterForm",handleSubmit:S((function(t){var e,r={userId:(null===(e=t.userId)||void 0===e?void 0:e.value)||null,asAt:(0,s.Z)(t.asAt)};n(r)})),children:[(0,b.jsxs)(u.Z,{children:[(0,b.jsx)(i.Z,{md:6,children:(0,b.jsx)(d.Z,{label:"As At",children:(0,b.jsx)(y.M,m(m({},P),{},{dateFormat:"d MMM yyyy",name:"asAt",todayButton:!1,placeholder:"As At",isClearable:!1,shouldCloseOnSelect:!0}))})}),"admin"===O.accountType&&(0,b.jsx)(i.Z,{md:6,children:(0,b.jsx)(f.P,m(m({},P),{},{accountId:O.accountId,label:"User",name:"userId",placeholder:"Select user",type:"user"}))})]}),(0,b.jsxs)(l.Z,{align:"flex-end",children:[(0,b.jsx)(p.Z,{content:"Clear",context:"danger",onClick:function(){r((function(t){var e=t.asAt,r=t.userId;w("asAt",e),w("userId",r)}))},size:"sm"}),(0,b.jsx)(p.Z,{content:"Search",context:"secondary",type:"submit",size:"sm"})]})]})};j.defaultProps={open:!1}},30406:function(t,e,r){r.r(e),r.d(e,{default:function(){return q}});var n,a=r(92809),o=r(67294),s=r(93633),c=r(52209),u=(0,r(54397).Ps)(n||(n=(0,c.Z)(["\n  query GetDashboard(\n    $accountId: Int\n    $adminId: Int\n    $asAt: timestamptz\n    $monthStart: timestamptz\n    $dayStart: timestamptz\n    $yearStart: timestamptz\n  ) {\n    dashboardTiles: getDashboard_HomeTiles(\n      args: {\n        adminId: $adminId\n        asAt: $asAt\n        accountId: $accountId\n        monthStart: $monthStart\n        dayStart: $dayStart\n        yearStart: $yearStart\n      }\n    ) {\n      upliftRequested\n    }\n  }\n"]))),i=r(11163),d=r(83894),l=r(23855),p=r(43703),f=r(69119),y=r(38148),b=r(5597),h=r(24237),m=r(80284),j=r(22796),O=r(78215),v=r(2356),g=r(76931),Z=r(89829),S="/dashboard/issues",w=function(t){var e=t.asAt,r=t.dashboardTiles,n=t.user,a=e?(0,b.Z)(e,"yyyy-MM-dd"):"",o=(r[0]||{}).upliftRequested;return[{title:"Create job",to:"".concat(S,"/manage"),value:"Create a work order"},{title:"Your Jobs",to:"".concat(S,"?show=pending"),value:"Pending jobs"},{title:"Your Jobs",to:"".concat(S,"?show=raised"),value:"Raised jobs"},{title:"Your Jobs",to:"".concat(S,"?show=current"),value:"Upcoming and in progress jobs"},{title:"Job History",to:"".concat(S,"?show=past"),value:"View your past jobs"},{colourConfig:{0:"success",5:"danger",6:"warning"},title:"Uplift requested",to:"".concat(S,"?asAt=").concat(a,"&tileName=upliftRequested&accountId=").concat(n.accountId),value:o||0},{title:"More",to:"/dashboard/users/view?id=".concat(n.id),value:"Account and notifications"}]},A=r(85893);function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function x(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){(0,a.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var I=[],D=(0,d.Z)(new Date),C=(0,h.ZP)(g.Z).withConfig({displayName:"dashboard__StyledTile",componentId:"sc-18u8fd2-0"})(["min-height:130px;div{font-size:32px;}"]),q=function(t){var e,r=t.user,n=(0,i.useRouter)(),a=n.query.asAt?(0,d.Z)((0,l.Z)(n.query.asAt)):D,c=(0,o.useState)({dashboardTiles:{}}),h=c[0],g=c[1],S=(0,o.useState)(a),P=S[0],q=S[1],E=(0,o.useState)({monthStart:(0,p.Z)(P),todayEnd:(0,d.Z)(P),todayStart:(0,f.Z)(P),yearStart:(0,y.Z)(P)}),M=E[0],$=E[1],k=(0,o.useState)(!(null===(e=n.query)||void 0===e||!e.asAt))[0];(0,o.useEffect)((function(){$({monthStart:(0,p.Z)(P),todayEnd:(0,d.Z)(P),todayStart:(0,f.Z)(P),yearStart:(0,y.Z)(P)}),i.default.push({pathname:"/dashboard",query:{asAt:(0,b.Z)(P,"yyyy-MM-dd")}})}),[P]);var z=(r.accountType,{query:u,variables:{accountId:r.accountId,adminId:r.adminId,asAt:P,monthStart:M.monthStart,dayStart:M.todayStart,yearStart:M.yearStart}}),T=z.query,_=z.variables,F=(0,s.a)(T,{variables:x({},_),onCompleted:function(t){g(t)}}).loading;I=w(x(x({asAt:P},h),{},{user:r}));return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(m.Z,{fitParentHeight:!0,open:!0,title:"Filters",children:(0,A.jsx)(Z.x,{defaultValues:{asAt:P},open:k,reset:function(t){t({asAt:D}),q(D),i.default.push({pathname:"/dashboard",query:{}})},user:r,submit:function(t){var e=t.asAt;i.default.push({pathname:"/dashboard",query:{asAt:(0,b.Z)(e,"yyyy-MM-dd")}})},setAsAt:q})}),(0,A.jsx)(j.Z,{}),(0,A.jsx)(O.Z,{children:I.map((function(t,e){return(0,A.jsx)(v.Z,{md:6,lg:3,sm:12,children:(0,A.jsx)(C,{body:t.value,colourConfig:t.colourConfig,loading:F,rounded:!0,size:"xs",title:t.title,to:t.to},t.title)},e)}))})]})}}}]);