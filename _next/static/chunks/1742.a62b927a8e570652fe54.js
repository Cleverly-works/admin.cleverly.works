"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1742],{76800:function(t,e,r){r.d(e,{M:function(){return y}});var n=r(92809),a=r(10219),o=r(42426),s=r(19716),c=r(22796),u=r(85893),i=["control","errors","name","space"];function d(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?d(Object(r),!0).forEach((function(e){(0,n.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var y=function(t){var e=t.control,r=t.errors,n=t.name,d=t.space,y=(0,a.Z)(t,i);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(s.Z,l({control:e,errors:r,locale:o.Z,name:n},y)),d&&(0,u.jsx)(c.Z,{marginBottom:"sm"})]})};y.defaultProps={space:!0}},89829:function(t,e,r){r.d(e,{x:function(){return j}});var n=r(92809),a=r(67294),o=r(42283),s=r(83894),c=r(97202),u=r(78215),i=r(2356),d=r(65375),l=r(58448),y=r(14347),f=r(95146),p=r(76800),b=r(85893);function m(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?m(Object(r),!0).forEach((function(e){(0,n.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var j=function(t){var e=t.defaultValues,r=(t.open,t.reset),n=t.submit,m=t.setAsAt,j=t.setUserId,v=t.user,O=(0,o.cI)({defaultValues:e}),g=O.control,Z=O.errors,P=O.handleSubmit,S=O.setValue,A=O.watch,w={control:g,errors:Z},x=A("asAt",e.asAt),I=A("userId");(0,a.useEffect)((function(){m((0,s.Z)(x||new Date)),j&&j((null===I||void 0===I?void 0:I.value)||e.userId)}),[x,I]);return(0,b.jsxs)(c.Z,{id:"offCanvasFilterForm",handleSubmit:P((function(t){var e,r={userId:(null===(e=t.userId)||void 0===e?void 0:e.value)||null,asAt:(0,s.Z)(t.asAt)};n(r)})),children:[(0,b.jsxs)(u.Z,{children:[(0,b.jsx)(i.Z,{md:6,children:(0,b.jsx)(d.Z,{label:"As At",children:(0,b.jsx)(p.M,h(h({},w),{},{dateFormat:"d MMM yyyy",name:"asAt",todayButton:!1,placeholder:"As At",isClearable:!1,shouldCloseOnSelect:!0}))})}),"admin"===v.accountType&&(0,b.jsx)(i.Z,{md:6,children:(0,b.jsx)(f.P,h(h({},w),{},{accountId:v.accountId,label:"User",name:"userId",placeholder:"Select user",type:"user"}))})]}),(0,b.jsxs)(l.Z,{align:"flex-end",children:[(0,b.jsx)(y.Z,{content:"Clear",context:"danger",onClick:function(){r((function(t){var e=t.asAt,r=t.userId;S("asAt",e),S("userId",r)}))},size:"sm"}),(0,b.jsx)(y.Z,{content:"Search",context:"secondary",type:"submit",size:"sm"})]})]})};j.defaultProps={open:!1}},51063:function(t,e,r){var n=r(5597),a="/dashboard/issues";e.Z=function(t){var e=t.asAt,r=t.dashboardTiles,o=t.user,s=r[0]||{},c=s.reactiveJobsToday,u=s.plannedJobsToday,i=e?(0,n.Z)(e,"yyyy-MM-dd"):"";return[{title:"Job Offers",to:"".concat(a,"?show=offered"),value:"Manage offered jobs"},{colourConfig:{15:"success",30:"danger",31:"warning"},title:"Today's Reactive Jobs",to:"".concat(a,"?asAt=").concat(i,"&tileName=reactiveJobsToday"),value:c||0},{colourConfig:{10:"success",20:"danger",21:"warning"},title:"Today's PPM Jobs",to:"".concat(a,"?asAt=").concat(i,"&tileName=plannedJobsToday"),value:u||0},{title:"Your Jobs",to:"".concat(a,"?show=current"),value:"Upcoming and active jobs"},{title:"All PPM Jobs",to:"".concat(a,"?type=ppm"),value:"PPM jobs"},{title:"All Quotes",to:"/dashboard/quotes",value:"Quotes"},{title:"Job History",to:"".concat(a,"?show=past"),value:"Past jobs and payments"},{title:"More",to:"/dashboard/users/view?id=".concat(o.id),value:"Account and notifications"}]}},77147:function(t,e,r){r.d(e,{n:function(){return o}});var n,a=r(52209),o=(0,r(54397).Ps)(n||(n=(0,a.Z)(["\n  query GetDashboard(\n    $accountId: Int\n    $adminId: Int\n    $asAt: timestamptz\n    $monthStart: timestamptz\n    $dayStart: timestamptz\n    $yearStart: timestamptz\n  ) {\n    dashboardTiles: getDashboard_HomeTiles(\n      args: {\n        adminId: $adminId\n        asAt: $asAt\n        accountId: $accountId\n        monthStart: $monthStart\n        dayStart: $dayStart\n        yearStart: $yearStart\n      }\n    ) {\n      plannedJobsToday\n      reactiveJobsToday\n    }\n  }\n"])))},31742:function(t,e,r){r.r(e);var n=r(92809),a=r(67294),o=r(93633),s=r(77147),c=r(11163),u=r(83894),i=r(23855),d=r(43703),l=r(69119),y=r(38148),f=r(5597),p=r(24237),b=r(80284),m=r(22796),h=r(78215),j=r(2356),v=r(76931),O=r(89829),g=r(51063),Z=r(85893);function P(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function S(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?P(Object(r),!0).forEach((function(e){(0,n.Z)(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var A=[],w=(0,u.Z)(new Date),x=(0,p.ZP)(v.Z).withConfig({displayName:"dashboard__StyledTile",componentId:"sc-xuhl3d-0"})(["min-height:130px;div{font-size:32px;}"]);e.default=function(t){var e,r=t.user,n=(0,c.useRouter)(),p=n.query.asAt?(0,u.Z)((0,i.Z)(n.query.asAt)):w,v=(0,a.useState)({dashboardTiles:{}}),P=v[0],I=v[1],D=(0,a.useState)(p),M=D[0],T=D[1],C=(0,a.useState)({monthStart:(0,d.Z)(M),todayEnd:(0,u.Z)(M),todayStart:(0,l.Z)(M),yearStart:(0,y.Z)(M)}),E=C[0],J=C[1],$=(0,a.useState)(!(null===(e=n.query)||void 0===e||!e.asAt))[0];(0,a.useEffect)((function(){J({monthStart:(0,d.Z)(M),todayEnd:(0,u.Z)(M),todayStart:(0,l.Z)(M),yearStart:(0,y.Z)(M)}),c.default.push({pathname:"/dashboard",query:{asAt:(0,f.Z)(M,"yyyy-MM-dd")}})}),[M]);var q=(r.accountType,{query:s.n,variables:{accountId:r.accountId,adminId:r.adminId,asAt:M,monthStart:E.monthStart,dayStart:E.todayStart,yearStart:E.yearStart}}),k=q.query,z=q.variables,_=(0,o.a)(k,{variables:S({},z),onCompleted:function(t){I(t)}}).loading;A=(0,g.Z)(S(S({asAt:M},P),{},{user:r}));return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(b.Z,{fitParentHeight:!0,open:!0,title:"Filters",children:(0,Z.jsx)(O.x,{defaultValues:{asAt:M},open:$,reset:function(t){t({asAt:w}),T(w),c.default.push({pathname:"/dashboard",query:{}})},user:r,submit:function(t){var e=t.asAt;c.default.push({pathname:"/dashboard",query:{asAt:(0,f.Z)(e,"yyyy-MM-dd")}})},setAsAt:T})}),(0,Z.jsx)(m.Z,{}),(0,Z.jsx)(h.Z,{children:A.map((function(t,e){return(0,Z.jsx)(j.Z,{md:6,lg:3,sm:12,children:(0,Z.jsx)(x,{body:t.value,colourConfig:t.colourConfig,rounded:!0,size:"xs",title:t.title,to:t.to,loading:_},t.title)},e)}))})]})}}}]);