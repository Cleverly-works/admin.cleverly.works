(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8737],{66805:function(e,t,n){"use strict";n.d(t,{H:function(){return m}});var r=n(92809),a=n(77417),u=n(58448),i=n(14347),c=n(85893);function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m=function(e){var t=e.children,n=e.content,r=e.context,o=e.data,m=e.disabled,l=e.handleClick,d=e.size,p=e.type;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(a.Z,{size:"sm"}),(0,c.jsxs)(u.Z,{align:"flex-end",children:[t,(0,c.jsx)(i.Z,s({content:n,context:r,disabled:m,onClick:l,size:d,type:p},o))]})]})};m.defaultProps={content:"Add",context:"secondary",disabled:!1,size:"sm",type:"button"}},14439:function(e,t,n){"use strict";n.d(t,{S:function(){return p}});var r=n(92809),a=n(78215),u=n(2356),i=n(34868),c=n(55657),o=n(85893);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=[{label:"Normal (Hour)",name:"supplierHourRate"},{label:"OOH (Hour)",name:"supplierHourRateOOH"},{label:"Premium (Hour)",name:"supplierHourRatePremium"}],d=[{label:"Normal (Day)",name:"supplierDayRate"},{label:"OOH (Day)",name:"supplierDayRateOOH"},{label:"Premium (Day)",name:"supplierDayRatePremium"}],p=function(e){e.editMode;var t={errors:e.errors,register:e.register};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(a.Z,{children:l.map((function(e,n){var r=e.icon,a=e.label,s=e.name;return(0,o.jsx)(u.Z,{md:4,children:(0,o.jsx)(i.Z,m(m({currencySymbol:r?(0,o.jsx)(c.Z,{icon:r}):"\xa3"},t),{},{label:a,name:s,vat:"Ex VAT"}))},"".concat(s,"-").concat(n))}))}),(0,o.jsx)(a.Z,{children:d.map((function(e,n){var r=e.icon,a=e.label,s=e.name;return(0,o.jsx)(u.Z,{md:4,children:(0,o.jsx)(i.Z,m(m({currencySymbol:r?(0,o.jsx)(c.Z,{icon:r}):"\xa3"},t),{},{label:a,name:s,vat:"Ex VAT"}))},"".concat(s,"-").concat(n))}))})]})}},85025:function(e,t,n){"use strict";n.d(t,{D:function(){return u}});var r,a=n(52209),u=(0,n(54397).Ps)(r||(r=(0,a.Z)(['\n  query GetService($id: Int!) {\n    service: Service_by_pk(id: $id) {\n      id\n      name\n      countryId\n      currencyId\n      customerDayRate\n      customerDayRateOOH\n      customerDayRatePremium\n      customerHourRate\n      customerHourRateOOH\n      customerHourRatePremium\n      supplierDayRate\n      supplierDayRateOOH\n      supplierDayRatePremium\n      supplierHourRate\n      supplierHourRateOOH\n      supplierHourRatePremium\n      minimumInterval\n      minimumLength\n      status\n      callOutHourRate\n      callOutHourRateOOH\n      callOutHourRatePremium\n      accounts: Service_Entities(where: { entity: { _eq: "Account" } }) {\n        id\n        dayRate\n        hourRate\n        entity\n        entityId\n        account: Account {\n          id\n          type\n          name\n        }\n      }\n    }\n    taxonomy: Taxonomy(where: { status: { _eq: "active" }, type: { _eq: "jobTags" } }) {\n      id\n      name\n      status\n      meta\n    }\n  }\n'])))},1135:function(e,t,n){"use strict";n.d(t,{zb:function(){return s},mh:function(){return m},E_:function(){return l}});var r,a,u,i,c=n(52209),o=n(54397),s=(0,o.Ps)(r||(r=(0,c.Z)(['\n  query GetServices(\n    $countryId: Int\n    $currencyId: Int\n    $limit: Int\n    $offset: Int\n    $q: String\n    $status: String\n    $orderBy: Service_order_by!\n  ) {\n    services: Service(\n      limit: $limit\n      offset: $offset\n      where: {\n        countryId: { _eq: $countryId }\n        currencyId: { _eq: $currencyId }\n        name: { _ilike: $q }\n        status: { _eq: $status }\n      }\n      order_by: [$orderBy]\n    ) {\n      id\n      name\n      customerDayRate\n      customerHourRate\n      supplierDayRate\n      supplierHourRate\n      status\n      createdAt\n      country: Country {\n        id\n        name\n      }\n      currency: Currency {\n        id\n        symbol\n      }\n      accounts: Service_Entities(where: { entity: { _eq: "Account" } }) {\n        id\n        dayRate\n        dayRateOOH\n        dayRatePremium\n        hourRate\n        hourRateOOH\n        hourRatePremium\n        minimumInterval\n        minimumLength\n        callOutHourRate\n        callOutHourRateOOH\n        callOutHourRatePremium\n        notes\n        delivery\n        createdAt\n        updatedAt\n        entity\n        entityId\n        serviceId\n        service: Service {\n          id\n          name\n          countryId\n          currencyId\n          customerDayRate\n          customerDayRateOOH\n          customerDayRatePremium\n          customerHourRate\n          customerHourRateOOH\n          customerHourRatePremium\n          supplierDayRate\n          supplierDayRateOOH\n          supplierDayRatePremium\n          supplierHourRate\n          supplierHourRateOOH\n          supplierHourRatePremium\n          minimumInterval\n          minimumLength\n        }\n        account: Account {\n          id\n          type\n          name\n        }\n      }\n    }\n    meta: Service_aggregate(\n      where: {\n        countryId: { _eq: $countryId }\n        currencyId: { _eq: $currencyId }\n        name: { _ilike: $q }\n        status: { _eq: $status }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),m=((0,o.Ps)(a||(a=(0,c.Z)(['\n  query GetService($id: Int!) {\n    service: Service_by_pk(id: $id) {\n      id\n      name\n      countryId\n      currencyId\n      customerDayRate\n      customerDayRateOOH\n      customerDayRatePremium\n      customerHourRate\n      customerHourRateOOH\n      customerHourRatePremium\n      supplierDayRate\n      supplierDayRateOOH\n      supplierDayRatePremium\n      supplierHourRate\n      supplierHourRateOOH\n      supplierHourRatePremium\n      minimumInterval\n      minimumLength\n      accounts: Service_Entities(where: { entity: { _eq: "Account" } }) {\n        id\n        dayRate\n        dayRateOOH\n        dayRatePremium\n        hourRate\n        hourRateOOH\n        hourRatePremium\n        minimumInterval\n        minimumLength\n        callOutHourRate\n        callOutHourRateOOH\n        callOutHourRatePremium\n        notes\n        delivery\n        createdAt\n        updatedAt\n        entity\n        entityId\n        serviceId\n        service: Service {\n          id\n          name\n          countryId\n          currencyId\n          customerDayRate\n          customerDayRateOOH\n          customerDayRatePremium\n          customerHourRate\n          customerHourRateOOH\n          customerHourRatePremium\n          supplierDayRate\n          supplierDayRateOOH\n          supplierDayRatePremium\n          supplierHourRate\n          supplierHourRateOOH\n          supplierHourRatePremium\n          minimumInterval\n          minimumLength\n        }\n      }\n    }\n  }\n']))),(0,o.Ps)(u||(u=(0,c.Z)(["\n  mutation AddService($services: [Service_insert_input!]!) {\n    insert_Service(objects: $services) {\n      returning {\n        id\n      }\n    }\n  }\n"])))),l=(0,o.Ps)(i||(i=(0,c.Z)(["\n  mutation UpdateService($id: Int!, $changes: Service_set_input) {\n    update_Service_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"])))},17044:function(e,t,n){"use strict";n.d(t,{O:function(){return r}});var r=[{text:"Country",value:""},{text:"United Kingdom",value:1},{text:"Ireland",value:4}]},27567:function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var r=[{text:"Currency",value:""},{text:"GBP",value:1},{text:"AUD",value:2},{text:"EUR",value:3}]},75838:function(e,t,n){"use strict";n.d(t,{bg:function(){return r},WG:function(){return a}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],a=[{text:"Status",value:""},{text:"Open",value:"open"},{text:"Resolved",value:"resolved"},{text:"Closed",value:"closed"}]},35092:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return J}});var r=n(66918),a=n(30266),u=n(80318),i=n(64687),c=n.n(i),o=n(67294),s=n(11163),m=n(38460),l=n(75709),d=n(1135),p=n(85025),y=n(42283),O=n(79665),R=n(97202),v=n(78215),f=n(2356),b=n(80284),x=n(66805),H=n(92809),h=n(65375),j=n(71247),P=n(46482),g=n(11570),D=n(17044),Z=n(27567),I=n(75838),_=n(85893);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){(0,H.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e){var t=e.errors,n=e.register,r=e.inactiveAlert,a=e.taxonomy,u={errors:t,register:n};return(0,_.jsx)(b.Z,{open:!0,title:"Details",children:(0,_.jsxs)(v.Z,{children:[(0,_.jsx)(f.Z,{md:3,children:(0,_.jsx)(h.Z,{label:"Name",children:(0,_.jsx)(j.Z,w(w({},u),{},{name:"name"}))})}),(0,_.jsx)(f.Z,{md:3,children:(0,_.jsx)(h.Z,{label:"Country",children:(0,_.jsx)(P.Z,w(w({},u),{},{name:"countryId",options:D.O}))})}),(0,_.jsx)(f.Z,{md:3,children:(0,_.jsx)(h.Z,{label:"Currency",children:(0,_.jsx)(P.Z,w(w({},u),{},{name:"currencyId",options:Z.m}))})}),(0,_.jsx)(f.Z,{md:3,children:(0,_.jsx)(h.Z,{label:"Status",children:(0,_.jsx)(P.Z,w(w({},u),{},{name:"status",options:I.bg}))})}),r&&(0,_.jsx)(f.Z,{md:12,children:(0,_.jsx)(g.Z,{content:"This service is used in the Job Descriptions Categories(".concat(a.name,")"),context:"warning"})})]})})},$=n(34868),E=n(55657),k=[{label:"Normal Rate (Hour)",name:"customerHourRate"},{label:"OOH Rate (Hour)",name:"customerHourRateOOH"},{label:"Premium Rate (Hour)",name:"customerHourRatePremium"},{label:"Normal Rate (Day)",name:"customerDayRate"},{label:"OOH Rate (Day)",name:"customerDayRateOOH"},{label:"Premium Rate (Day)",name:"customerDayRatePremium"},{label:"Call Out Rate (Hour)",name:"callOutHourRate"},{label:"Call Out Rate OOH (Hour)",name:"callOutHourRateOOH"},{label:"Call Out Rate Premium (Hour)",name:"callOutHourRatePremium"},{icon:"clock",label:"Minimum Interval (Minutes)",name:"minimumInterval"},{icon:"clock",label:"Minimum Length (Minutes)",name:"minimumLength"}],A=function(e){e.editMode;var t=e.errors,n=e.register;return(0,_.jsx)(b.Z,{open:!0,title:"Customers",children:(0,_.jsx)(v.Z,{children:k.map((function(e,r){var a=e.icon,u=e.label,i=e.name;return(0,_.jsx)(f.Z,{md:4,children:(0,_.jsx)($.Z,{currencySymbol:a?(0,_.jsx)(E.Z,{icon:a}):"\xa3",errors:t,label:u,name:i,register:n,vat:a&&"clock"===a?"":"Ex VAT"})},"".concat(i,"-").concat(r))}))})})},C=n(14439),N=n(29444),L=n(73165),M=n(80285),T=n(52002),z=function(e){var t=e.data,n=[{hidden:!0},{formatter:(0,N.Z)("/dashboard","accountId","name","url"),text:"Account"},{text:"Type"},{text:"Hour Rate"},{text:"Day Rate"},{hidden:!0},{hidden:!0}];return(0,_.jsx)(b.Z,{open:!0,title:"Accounts",children:(0,_.jsx)(T.Z,{columns:n,rows:t.map((function(e){return{id:e.id,name:e.account.name,type:(0,L.Z)(e.account.type),hourRate:e.hourRate&&(0,M.Z)(e.hourRate),dayRate:e.dayRate&&(0,M.Z)(e.dayRate),accountId:e.account.id,url:"supplier"===e.account.type?"/dashboard/suppliers/view":"/dashboard/customers/view"}}))})})};z.defaultProps={data:[]};var G=n(19501),V=(0,G.Ry)().shape({name:(0,G.Z_)().required(),countryId:(0,G.Z_)().required(),currencyId:(0,G.Z_)().required(),customerDayRate:(0,G.Rx)().required(),customerDayRateOOH:(0,G.Rx)(),customerDayRatePremium:(0,G.Rx)(),customerHourRate:(0,G.Rx)().required(),customerHourRateOOH:(0,G.Rx)(),customerHourRatePremium:(0,G.Rx)(),minimumInterval:(0,G.Rx)().required(),minimumLength:(0,G.Rx)().required(),supplierDayRate:(0,G.Rx)().required(),supplierDayRateOOH:(0,G.Rx)(),supplierDayRatePremium:(0,G.Rx)(),supplierHourRate:(0,G.Rx)().required(),supplierHourRateOOH:(0,G.Rx)(),supplierHourRatePremium:(0,G.Rx)(),status:(0,G.Z_)().oneOf(["active","inactive"]).required()}),U=n(1323),B={countryId:1,currencyId:1,status:"active"},F="/dashboard/services",X=function(){var e=(0,U.x)().user,t=(0,y.cI)({defaultValues:B,resolver:(0,O.S)(V)}),n=t.control,r=t.errors,i=t.handleSubmit,H=t.register,h=t.reset,j=t.watch,P=(0,o.useState)(!1),g=P[0],D=P[1],Z=function(e,t){return t.find((function(t){var n,r,a;return(null===(n=t.meta)||void 0===n||null===(r=n.template)||void 0===r||null===(a=r.serviceSelected)||void 0===a?void 0:a.value)===Number(e)}))},I=j("status"),S=(0,s.useRouter)().query,w=(0,m.t)(p.D,{variables:{id:S.id}}),$=(0,u.Z)(w,2),E=$[0],k=$[1],N=k.loading,L=k.data,M=(L=void 0===L?{service:[],taxonomy:[]}:L).service,T=L.taxonomy;(0,o.useEffect)((function(){S.id&&E()}),[]),(0,o.useEffect)((function(){S.id&&D(Z(S.id,T)&&"inactive"===I)}),[I]),(0,o.useEffect)((function(){S.id&&!N&&M&&h(M)}),[N]);var G=(0,l.D)(d.mh,{onCompleted:function(){s.default.push(F)}}),X=(0,u.Z)(G,1)[0],J=(0,l.D)(d.E_,{onCompleted:function(){s.default.push(F)}}),K=(0,u.Z)(J,1)[0],W=function(){var t=(0,a.Z)(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(S.id){t.next=6;break}return n.adminId=e.accountId,t.next=4,X({variables:{services:[n]}});case 4:t.next=8;break;case 6:return t.next=8,K({variables:{id:S.id,changes:n}});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return!N&&(0,_.jsxs)(R.Z,{handleSubmit:i(W),children:[(0,_.jsxs)(v.Z,{children:[(0,_.jsxs)(f.Z,{md:8,children:[(0,_.jsx)(q,{errors:r,register:H,inactiveAlert:g,taxonomy:S.id&&Z(S.id,T)}),(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(A,{control:n,editMode:!!S.id,errors:r,register:H}),(0,_.jsx)(b.Z,{open:!0,title:"Suppliers",children:(0,_.jsx)(C.S,{control:n,editMode:!!S.id,errors:r,register:H})})]})]}),(0,_.jsx)(f.Z,{md:4,children:S.id&&(0,_.jsx)(z,{data:M.accounts})})]}),(0,_.jsx)(x.H,{content:"Submit",type:"submit"})]})},J=function(){return(0,_.jsx)(r.Z,{pageHeading:{heading:"Services - Manage"},View:(0,_.jsx)(X,{})})}},40096:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/services/manage",function(){return n(35092)}])}},function(e){e.O(0,[284,4195,5312,2002,7134,3486,2877,9774,2888,179],(function(){return t=40096,e(e.s=t);var t}));var t=e.O();_N_E=t}]);