(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1617],{66805:function(e,t,n){"use strict";n.d(t,{H:function(){return c}});var a=n(92809),s=n(77417),o=n(58448),i=n(14347),l=n(85893);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var c=function(e){var t=e.children,n=e.content,a=e.context,r=e.data,c=e.disabled,u=e.handleClick,d=e.size,m=e.type;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.Z,{size:"sm"}),(0,l.jsxs)(o.Z,{align:"flex-end",children:[t,(0,l.jsx)(i.Z,p({content:n,context:a,disabled:c,onClick:u,size:d,type:m},r))]})]})};c.defaultProps={content:"Add",context:"secondary",disabled:!1,size:"sm",type:"button"}},27834:function(e,t,n){"use strict";n.d(t,{I4:function(){return k},AX:function(){return v},fo:function(){return w},JA:function(){return S},WF:function(){return I},Px:function(){return P},a8:function(){return C},r1:function(){return x},MT:function(){return O},nE:function(){return D},nh:function(){return J},$E:function(){return U},uz:function(){return Z},ge:function(){return q},ZA:function(){return A},tW:function(){return _}});var a,s,o,i,l,r,p,c,u,d,m,b,y,f,g,T,h=n(52209),j=n(54397),k=(0,j.Ps)(a||(a=(0,h.Z)(["\n  mutation InsertAccountUser($objects: [Account_User_insert_input!]!) {\n    insert_Account_User(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),v=(0,j.Ps)(s||(s=(0,h.Z)(["\n  mutation UpdateUser(\n    $id: Int!\n    $accountUserId: Int!\n    $accountUserChanges: Account_User_set_input\n    $changes: User_set_input\n    $updateAccountUser: Boolean!\n  ) {\n    update_Account_User_by_pk(pk_columns: { id: $accountUserId }, _set: $accountUserChanges)\n      @include(if: $updateAccountUser) {\n      id\n    }\n    update_User_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),w=(0,j.Ps)(o||(o=(0,h.Z)(["\n  query GetUsers(\n    $accountId: Int\n    $accountType: String\n    $date: timestamptz\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: User_order_by!\n    $status: String\n  ) {\n    users: User(\n      limit: $limit\n      offset: $offset\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [\n          { email: { _ilike: $q } }\n          { nameFirst: { _ilike: $q } }\n          { nameLast: { _ilike: $q } }\n        ]\n        status: { _eq: $status }\n      }\n      order_by: [$orderBy]\n    ) {\n      id\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n        userLocations: User_Account_Locations {\n          accountLocationId\n        }\n      }\n    }\n    meta: User_aggregate(\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        status: { _eq: $status }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]))),S=(0,j.Ps)(i||(i=(0,h.Z)(["\n  query GetUser($id: Int!) {\n    user: User_by_pk(id: $id) {\n      id\n      fullName\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n      }\n    }\n  }\n"]))),I=(0,j.Ps)(l||(l=(0,h.Z)(["\n  query CheckDuplicateEmail($email: String!) {\n    users: User_public(where: { email: { _eq: $email } }) {\n      id\n      nameFirst\n      nameLast\n      email\n      phone\n    }\n  }\n"]))),P=(0,j.Ps)(r||(r=(0,h.Z)(["\n  fragment UserFields on User {\n    id\n    email\n    nameFirst\n    nameLast\n    fullName\n    phone\n    status\n  }\n"]))),C=(0,j.Ps)(p||(p=(0,h.Z)(["\n  mutation SendGoogleAuthCode($code: String!, $id: Int!, $type: String!) {\n    createGoogleToken(code: $code, id: $id, type: $type) {\n      success\n      tokens\n      error\n    }\n  }\n"]))),x=(0,j.Ps)(c||(c=(0,h.Z)(["\n  mutation GenerateMSURL($type: String!, $id: Int!) {\n    genenrateMSURL(id: $id, type: $type) {\n      url\n    }\n  }\n"]))),O=(0,j.Ps)(u||(u=(0,h.Z)(["\n  mutation signoutMS($id: Int!, $type: String!, $email: String!) {\n    signoutMS(id: $id, type: $type, email: $email) {\n      error\n      msId\n      success\n    }\n  }\n"]))),D=(0,j.Ps)(d||(d=(0,h.Z)(["\n  query getAccountMeta($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      meta\n    }\n  }\n"]))),J=(0,j.Ps)(m||(m=(0,h.Z)(["\n  query user($id: Int!) {\n    user: User_by_pk(id: $id) {\n      meta\n    }\n  }\n"]))),U=(0,j.Ps)(b||(b=(0,h.Z)(["\n  mutation updateAccount($accountId: Int!, $set: Account_set_input!) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $set) {\n      id\n    }\n  }\n"]))),Z=(0,j.Ps)(y||(y=(0,h.Z)(["\n  mutation updateUserMeta($userId: Int!, $meta: jsonb!) {\n    update_User_by_pk(pk_columns: { id: $userId }, _set: { meta: $meta }) {\n      id\n      meta\n    }\n  }\n"]))),q=(0,j.Ps)(f||(f=(0,h.Z)(['\n  query userDevices($accountId: Int!) {\n    users: User(\n      where: {\n        Account_Users: { accountId: { _eq: $accountId }, status: { _eq: "active" } }\n        UserDevices: { status: { _eq: "active" } }\n        status: { _eq: "active" }\n      }\n    ) {\n      id\n      fullName\n      devices: UserDevices(\n        order_by: { updatedAt: desc_nulls_last }\n        where: { status: { _eq: "active" } }\n        limit: 1\n      ) {\n        id\n        playerId\n      }\n    }\n  }\n']))),A=(0,j.Ps)(g||(g=(0,h.Z)(['\n  query GetAccountLocations($accountId: Int, $limit: Int, $offset: Int) {\n    location: Location(\n      offset: $offset\n      limit: $limit\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      id\n      name\n      accountLocations: Account_Locations {\n        id\n      }\n      addresses: Addresses(where: { entity: { _eq: "Location" }, registered: { _eq: true } }) {\n        id\n        status\n        address: Address {\n          id\n          name\n          addressLine1\n          postCode\n        }\n      }\n    }\n    meta: Location_aggregate(\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),_=(0,j.Ps)(T||(T=(0,h.Z)(["\n  mutation InsertUserAccountLocations(\n    $accountUserId: Int!\n    $objects: [User_Account_Location_insert_input!]!\n  ) {\n    delete_User_Account_Location(where: { accountUserId: { _eq: $accountUserId } }) {\n      affected_rows\n    }\n    insert_User_Account_Location(objects: $objects) {\n      affected_rows\n      returning {\n        id\n      }\n    }\n  }\n"])))},20154:function(e,t,n){"use strict";n.d(t,{t:function(){return a}});var a=[{text:"P1",value:1},{text:"P2",value:2},{text:"P3",value:3},{text:"P4",value:4},{text:"P5",value:5}]},91998:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return Re}});var a,s,o,i=n(66918),l=n(67294),r=n(11163),p=n(92743),c=n(80318),u=n(38460),d=n(52209),m=n(54397),b=(0,m.Ps)(a||(a=(0,d.Z)(["\n  query CommunicationSetting($adminId: Int!, $category: String) {\n    items: CommunicationSetting(\n      where: { adminId: { _eq: $adminId }, category: { _eq: $category } }\n    ) {\n      id\n      name\n      title\n      description\n      category\n      systemTemplate\n      email\n      emailTemplate\n      emailTemplateData\n      emailSubjectTemplate\n      emailBodyTemplate\n      notification\n      notificationHeading\n      notificationSubtitle\n      notificationContent\n      sms\n      smsTemplate\n      slack\n      slackTemplate\n      task\n      taskPriority\n      taskTemplate\n      toast\n      toastTemplate\n      whatsapp\n      whatsappTemplate\n      status\n      meta\n      updatedAt\n      admin: Admin {\n        id\n        name\n      }\n      user: User {\n        nameFirst\n        nameLast\n      }\n    }\n  }\n"]))),y=(0,m.Ps)(s||(s=(0,d.Z)(["\n  mutation AddCommunicationSetting($object: CommunicationSetting_insert_input!) {\n    insert_CommunicationSetting_one(object: $object) {\n      id\n    }\n  }\n"]))),f=(0,m.Ps)(o||(o=(0,d.Z)(["\n  mutation UpdateCommunicationSetting($id: Int!, $changes: CommunicationSetting_set_input) {\n    update_CommunicationSetting_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),g=n(43566),T=n(30266),h=n(64687),j=n.n(h),k=n(75709),v=n(80880),w=n(18944),S=n(91126),I=n(80284),P=n(52002),C=n(78586),x=n(92809),O=n(42283),D=n(79665),J=n(97202),U=n(78215),Z=n(2356),q=n(65375),A=n(71247),_=n(46482),B=n(84550),H=n(22796),L=n(34610),N=n(83528),$=n(77417),Q=n(50710),E=n(14347),V=n(66805),F=n(55657),R=n(55863),M=n(85893),z=n(34155);function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(e){var t=Y({},e);return t.sendTo&&(t.meta={sendTo:t.sendTo},delete t.sendTo),t},G=function(e,t){return e.enabled.includes(t)?e[t]?function(){return(0,M.jsx)(F.Z,{context:"success",icon:"check",size:"sm",title:"Enabled"})}:function(){return(0,M.jsx)(F.Z,{context:"warning",icon:"times",size:"sm",title:"Disabled"})}:function(){return(0,M.jsx)(F.Z,{context:"dark",icon:"minus",size:"sm",title:"Unavailable"})}},K=function(){var e=(0,T.Z)(j().mark((function e(t){var n,a;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=z.env.NEXT_PUBLIC_SITE||"cleverly",a="".concat(t.name,"-").concat(n,"-").concat(t.adminId),e.next=4,window.fetch("".concat("https://aws-staging.cleverly.works","/aws/ses/create-template"),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({instance:n,subject:t.emailSubjectTemplate,template:a,templateData:t.emailBodyTemplate})}).then((function(e){return e.json()})).then((function(e){console.info("Success:",e)})).catch((function(e){(0,R.Tb)({message:e,section:"fetch"})}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=(0,T.Z)(j().mark((function e(t,n){var a,s,o;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=z.env.NEXT_PUBLIC_SITE||"cleverly",s="".concat(t.name,"-").concat(a,"-").concat(t.adminId),o=n("emailTemplateData"),e.next=5,window.fetch("".concat("https://aws-staging.cleverly.works","/aws/ses/test-render"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:t.emailSubjectTemplate,template:s,templateData:o})}).then((function(e){return e.json()})).then((function(e){return console.info("Success:",e),e})).catch((function(e){(0,R.Tb)({message:e,section:"fetch"})}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),te=function(){var e=(0,T.Z)(j().mark((function e(t,n,a,s){var o,i,l,r,p;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=s.admin.emailSettings,i=z.env.NEXT_PUBLIC_SITE||"cleverly",l="".concat(t.name,"-").concat(i,"-").concat(t.adminId),r=n("emailTo"),p=n("emailTemplateData"),e.next=7,window.fetch("".concat("https://aws-staging.cleverly.works","/aws/ses/send-template"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reply:'"'.concat(o.replyToName,'" <').concat(o.replyToEmail,">"),source:'"'.concat(o.replyToName,'" <job@cleverly.works>'),subject:t.emailSubjectTemplate,template:l,templateData:p,to:r})}).then((function(e){return e.json()})).then((function(e){console.info("Success:",e)})).catch((function(e){(0,R.Tb)({message:e,section:"fetch"}),a(e.response.data.error)}));case 7:case"end":return e.stop()}}),e)})));return function(t,n,a,s){return e.apply(this,arguments)}}(),ne=function(e){var t=e.data;return(0,M.jsx)("div",{dangerouslySetInnerHTML:function(){var e=t.data.RenderedTemplate.indexOf("<!doctype html>"),n=t.data.RenderedTemplate.indexOf("</html>");return{__html:t.data.RenderedTemplate.substring(e,n+7)}}()})};function ae(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ae(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var oe=function(e){var t=e.app,n=e.defaultValues,a=void 0===n?{}:n,s=e.errors,o=e.getValues,i=e.register,r=e.setValue,p=e.watch,c=(0,l.useContext)(v.Z),u=(0,l.useState)(!1),d=u[0],m=u[1],b=(0,l.useState)(!1),y=b[0],f=b[1],g=p("email",a.email);g="false"!==g&&Boolean(g);var h=function(){var e=(0,T.Z)(j().mark((function e(t){var n;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),t.stopPropagation(),e.next=4,ee(a,o);case 4:(n=e.sent).success&&c.show({content:(0,M.jsx)(ne,{data:n}),submit:!1,title:"Email Preview",width:"70%"});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=(0,T.Z)(j().mark((function e(n){return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),n.stopPropagation(),e.next=4,te(a,o,m,t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S={errors:s,register:i},I=se(se({},S),{},{context:"secondary",size:"sm"});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"Email",children:(0,M.jsx)(L.Z,se(se({},I),{},{onToggle:function(e){r("email",e)},toggled:g}))}),g&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"Subject",children:(0,M.jsx)(A.Z,se(se({},S),{},{name:"emailSubjectTemplate"}))}),(0,M.jsx)(q.Z,{label:"Content",children:(0,M.jsx)(N.Z,se(se({},S),{},{name:"emailBodyTemplate",rows:8}))}),(null===a||void 0===a?void 0:a.tags)&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(H.Z,{}),(0,M.jsxs)(w.Z,{children:["Available tags: ",a.tags.map((function(e){return"{{".concat(e,"}}")})).join(", ")]})]}),y&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)($.Z,{}),(0,M.jsx)(q.Z,{label:"Email To",children:(0,M.jsx)(A.Z,se(se({},S),{},{name:"emailTo"}))}),(0,M.jsxs)(q.Z,{label:"Template data",children:[(0,M.jsx)(N.Z,se(se({},S),{},{name:"emailTemplateData",rows:15})),(0,M.jsx)(Q.Z,{message:"Used in test send only"})]}),d&&(0,M.jsx)("p",{children:(0,M.jsx)(Q.Z,{message:d})})]}),(0,M.jsxs)(V.H,{context:y?"warning":"info",content:y?"Close Test":"Send Test",handleClick:function(){f(!y),m(!1)},size:"sm",children:[y&&(0,M.jsx)(E.Z,{context:"secondary",content:"Preview Template",onClick:h,size:"sm"}),y&&(0,M.jsx)(E.Z,{context:"success",content:"Send",onClick:k,size:"sm"})]})]}),(0,M.jsx)(A.Z,se(se({},S),{},{name:"email",type:"hidden"}))]})},ie=n(93633),le=n(27834),re=n(1323);function pe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pe(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=function(e){var t=e.defaultValues,n=void 0===t?{}:t,a=e.errors,s=(e.getValues,e.register),o=e.setValue,i=e.watch,r=(0,re.x)().user,p=(0,l.useState)(!1),c=p[0],u=p[1],d=i("notification",n.notification);d="false"!==d&&Boolean(d);var m=(0,ie.a)(le.ge,{variables:{accountId:r.accountId}}).data,b=(m=void 0===m?{users:[]}:m).users,y=[{disabled:!0,text:"Select user",value:""}];b.length&&b.forEach((function(e){y.push({text:e.fullName,value:e.devices[0].playerId})}));var f=function(){var e=(0,T.Z)(j().mark((function e(t){var a;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.stopPropagation(),a=i("playerId"),!d){e.next=6;break}return e.next=6,window.fetch("".concat("https://aws-staging.cleverly.works","/onesignal/send-push"),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({content:n.notificationContent,heading:n.notificationHeading,subtitle:n.notificationSubtitle,playerId:a})}).then((function(e){return e.json()})).then((function(e){console.info("Success:",e)})).catch((function(e){(0,R.Tb)({message:e,section:"fetch"})}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g={errors:a,register:s},h=ce(ce({},g),{},{context:"secondary",size:"sm"});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"Push Notification",children:(0,M.jsx)(L.Z,ce(ce({},h),{},{onToggle:function(e){o("notification",e)},toggled:d}))}),d&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsxs)(U.Z,{children:[(0,M.jsx)(Z.Z,{md:6,children:(0,M.jsx)(q.Z,{label:"Heading",children:(0,M.jsx)(A.Z,ce(ce({},g),{},{name:"notificationHeading"}))})}),(0,M.jsx)(Z.Z,{md:6,children:(0,M.jsx)(q.Z,{label:"Subtitle",children:(0,M.jsx)(A.Z,ce(ce({},g),{},{name:"notificationSubtitle"}))})})]}),(0,M.jsx)(q.Z,{label:"Content",children:(0,M.jsx)(N.Z,ce(ce({},g),{},{name:"notificationContent",rows:2}))}),(null===n||void 0===n?void 0:n.tags)&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(H.Z,{}),(0,M.jsxs)(w.Z,{children:["Available tags: ",n.tags.map((function(e){return"{{".concat(e,"}}")})).join(", ")]})]}),c&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)($.Z,{}),(0,M.jsx)(q.Z,{label:"To",children:(0,M.jsx)(_.Z,ce(ce({},g),{},{name:"playerId",options:y}))})]}),(0,M.jsx)(V.H,{context:c?"warning":"info",content:c?"Close Test":"Send Test",handleClick:function(){u(!c)},size:"sm",children:c&&(0,M.jsx)(E.Z,{context:"success",content:"Send",onClick:f,size:"sm"})})]}),(0,M.jsx)(A.Z,ce(ce({},g),{},{name:"notification",type:"hidden"}))]})},de=n(19501),me=(0,de.Ry)().shape({title:(0,de.Z_)().required(),category:(0,de.Z_)().required(),name:(0,de.Z_)().required(),description:(0,de.Z_)(),email:(0,de.Xg)(),emailTemplate:(0,de.Z_)(),emailSubjectTemplate:(0,de.Z_)(),emailBodyTemplate:(0,de.Z_)(),emailTemplateData:(0,de.Z_)(),notification:(0,de.Xg)(),notificationHeading:(0,de.Z_)(),notificationSubtitle:(0,de.Z_)(),notificationContent:(0,de.Z_)(),task:(0,de.Xg)(),taskPriority:(0,de.Rx)().transform((function(e){return isNaN(e)?null:e})).nullable(),taskTemplate:(0,de.Z_)(),sms:(0,de.Xg)(),smsTemplate:(0,de.Z_)(),slack:(0,de.Xg)(),slackTemplate:(0,de.Z_)(),whatsapp:(0,de.Xg)(),whatsappTemplate:(0,de.Z_)(),systemTemplate:(0,de.Z_)()});function be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?be(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe=function(e){var t=e.defaultValues,n=void 0===t?{}:t,a=e.errors,s=e.register,o=e.setValue,i=(0,e.watch)("slack",n.slack);i="false"!==i&&Boolean(i);var l={errors:a,register:s},r=ye(ye({},l),{},{context:"secondary",size:"sm"});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"Slack",children:(0,M.jsx)(L.Z,ye(ye({},r),{},{onToggle:function(e){o("slack",e)},toggled:i}))}),i&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"Content",children:(0,M.jsx)(N.Z,ye(ye({},l),{},{name:"slackTemplate",rows:2}))}),(null===n||void 0===n?void 0:n.tags)&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(H.Z,{}),(0,M.jsxs)(w.Z,{children:["Available tags: ",n.tags.map((function(e){return"{{".concat(e,"}}")})).join(", ")]})]})]}),(0,M.jsx)(A.Z,ye(ye({},l),{},{name:"slack",type:"hidden"}))]})};function ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ge(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var he=function(e){var t=e.defaultValues,n=void 0===t?{}:t,a=e.errors,s=e.getValues,o=e.register,i=e.setValue,r=e.watch,p=(0,l.useState)(!1),c=p[0],u=p[1],d=r("sms",n.sms);d="false"!==d&&Boolean(d);var m=function(){var e=(0,T.Z)(j().mark((function e(t){var a;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.stopPropagation(),a=s("smsTo"),!d){e.next=6;break}return e.next=6,window.fetch("".concat("https://aws-staging.cleverly.works","/sms/twilio/send"),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({body:n.smsTemplate,from:"MG4bfec93f8bcb5ba6caccf6b8bb0d9dc3",to:a})}).then((function(e){return e.json()})).then((function(e){console.info("Success:",e)})).catch((function(e){(0,R.Tb)({message:e,section:"fetch"})}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b={errors:a,register:o},y=Te(Te({},b),{},{context:"secondary",size:"sm"});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"SMS",children:(0,M.jsx)(L.Z,Te(Te({},y),{},{onToggle:function(e){i("sms",e)},toggled:d}))}),d&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"Content",children:(0,M.jsx)(N.Z,Te(Te({},b),{},{name:"smsTemplate",rows:2}))}),(null===n||void 0===n?void 0:n.tags)&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(H.Z,{}),(0,M.jsxs)(w.Z,{children:["Available tags: ",n.tags.map((function(e){return"{{".concat(e,"}}")})).join(", ")]})]}),c&&(0,M.jsx)(q.Z,{label:"To",children:(0,M.jsx)(A.Z,Te(Te({},b),{},{name:"smsTo"}))}),(0,M.jsx)(V.H,{context:c?"warning":"info",content:c?"Close Test":"Send Test",handleClick:function(){u(!c)},size:"sm",children:c&&(0,M.jsx)(E.Z,{context:"success",content:"Send",onClick:m,size:"sm"})})]}),(0,M.jsx)(A.Z,Te(Te({},b),{},{name:"sms",type:"hidden"}))]})};function je(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function ke(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?je(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):je(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ve=function(e){var t=e.defaultValues,n=void 0===t?{}:t,a=e.errors,s=e.register,o=(e.setValue,e.watch,{errors:a,register:s});return(0,M.jsxs)(q.Z,{label:"Content",children:[(0,M.jsx)(N.Z,ke(ke({},o),{},{name:"systemTemplate",rows:2})),(null===n||void 0===n?void 0:n.tags)&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(H.Z,{}),(0,M.jsxs)(w.Z,{children:["Available tags: ",n.tags.map((function(e){return"{{".concat(e,"}}")})).join(", ")]})]})]})},we=n(20154);function Se(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Ie(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Se(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Se(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pe=function(e){var t=e.defaultValues,n=void 0===t?{}:t,a=e.errors,s=e.register,o=e.setValue,i=(0,e.watch)("task",n.task);i="false"!==i&&Boolean(i);var l={errors:a,register:s},r=Ie(Ie({},l),{},{context:"secondary",size:"sm"});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"Task",children:(0,M.jsx)(L.Z,Ie(Ie({},r),{},{onToggle:function(e){o("task",e)},toggled:i}))}),i&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"Default priority",children:(0,M.jsx)(_.Z,Ie(Ie({},l),{},{name:"taskPriority",options:we.t}))}),(0,M.jsx)(q.Z,{label:"Content",children:(0,M.jsx)(N.Z,Ie(Ie({},l),{},{name:"taskTemplate",rows:2}))}),(null===n||void 0===n?void 0:n.tags)&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(H.Z,{}),(0,M.jsxs)(w.Z,{children:["Available tags: ",n.tags.map((function(e){return"{{".concat(e,"}}")})).join(", ")]})]})]}),(0,M.jsx)(A.Z,Ie(Ie({},l),{},{name:"task",type:"hidden"}))]})};function Ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ce(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Oe=function(e){var t=e.defaultValues,n=void 0===t?{}:t,a=e.errors,s=e.register,o=e.setValue,i=(0,e.watch)("toast",n.toast);i="false"!==i&&Boolean(i);var l={errors:a,register:s},r=xe(xe({},l),{},{context:"secondary",size:"sm"});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"Toast",children:(0,M.jsx)(L.Z,xe(xe({},r),{},{onToggle:function(e){o("toast",e)},toggled:i}))}),i&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"Content",children:(0,M.jsx)(N.Z,xe(xe({},l),{},{name:"toastTemplate",rows:2}))}),(null===n||void 0===n?void 0:n.tags)&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(H.Z,{}),(0,M.jsxs)(w.Z,{children:["Available tags: ",n.tags.map((function(e){return"{{".concat(e,"}}")})).join(", ")]})]})]}),(0,M.jsx)(A.Z,xe(xe({},l),{},{name:"toast",type:"hidden"}))]})};function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ue=function(e){var t=e.defaultValues,n=void 0===t?{}:t,a=e.errors,s=e.register,o=e.setValue,i=(0,e.watch)("whatsapp",n.whatsapp);i="false"!==i&&Boolean(i);var l={errors:a,register:s},r=Je(Je({},l),{},{context:"secondary",size:"sm"});return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"WhatsApp",children:(0,M.jsx)(L.Z,Je(Je({},r),{},{onToggle:function(e){o("whatsapp",e)},toggled:i}))}),i&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(q.Z,{label:"Content",children:(0,M.jsx)(N.Z,Je(Je({},l),{},{name:"whatsappTemplate",rows:2}))}),(null===n||void 0===n?void 0:n.tags)&&(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(H.Z,{}),(0,M.jsxs)(w.Z,{children:["Available tags: ",n.tags.map((function(e){return"{{".concat(e,"}}")})).join(", ")]})]})]}),(0,M.jsx)(A.Z,Je(Je({},l),{},{name:"whatsapp",type:"hidden"}))]})},Ze=[{text:"Jobs",value:"bookings"},{text:"Quotes",value:"quotes"},{text:"Planned Maintenance",value:"ppm"},{text:"Assets",value:"assets"},{text:"Supplier Onboarding",value:"supplierOnboarding"},{text:"Customer Onboarding",value:"customerOnboarding"},{text:"Tenant Onboarding",value:"tenantOnboarding"},{text:"Accounts",value:"accounts"},{text:"Broadcasts",value:"broadcasts"}],qe=[{id:"admin",label:"Admin",value:"admin"},{id:"supplier",label:"Supplier",value:"supplier"},{id:"customer",label:"Customer",value:"customer"},{id:"Tenant",label:"Tenant",value:"tenant"}],Ae=[{category:"bookings",type:"trigger",description:"Tenant or customer submitted a request",emailBodyTemplate:"Issue details:\n\n    Title: {{shortJobDesc}}\n    Description: {{description}}\n    Address: {{addressInline}}\n    Customer: {{customer}}",emailSubjectTemplate:"Issue reported at {{property}}",name:"issueReported",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:"Issue reported at {{property}}",systemTemplate:"Issue reported by {{user}} at {{property}}: {{shortJobDesc}}",taskPriority:3,taskTemplate:"Approve a new job request {{jobId}} at {{property}}: {{shortJobDesc}}",title:"Issue reported",toastTemplate:"Issue {{jobId}} reported at {{property}}: {{shortJobDesc}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","property","addressInline","addressPostCode","user"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Admin approved a job request",emailBodyTemplate:"Hi {{requester}}\n\n    Your request at {{property}} has been approved. Click below to follow the job progress.",emailSubjectTemplate:"Job approved",name:"jobApproved",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job approved by {{user}}: {{userNotes}}",taskPriority:3,taskTemplate:null,title:"Job approved",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","property","addressInline","addressPostCode","serviceLine","requester","user","userNotes"],meta:{sendTo:["customer","tenant"]}},{category:"bookings",type:"trigger",description:"Job raised and assigned to admin user",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobRaised",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job has been raised by {{user}}. {{description}}",taskPriority:3,taskTemplate:"Job {{jobId}} is created and assigned to you, please assign suppliers",title:"Job raised",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","user"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"onHold job triggered",emailBodyTemplate:null,emailSubjectTemplate:null,name:"onHoldRaise",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job is On Hold by {{user}}",taskPriority:3,taskTemplate:"Job {{jobId}} is on Hold , please waiting for resume",title:"On Hold Job",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","user"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Job was reposted",emailBodyTemplate:"Hi {{name}},\n\n    You don't have any responsibility for job with Id {{jobId}}, it's\n     assigned to Other supplier.\n\n    Best Regards,\n    ",emailSubjectTemplate:"Job is Assigned",name:"jobReposted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job was reposted by {{user}}",taskPriority:3,taskTemplate:"Job {{jobId}} is Reposted Job",title:"Job was reposted",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","user"],meta:{sendTo:["admin"]}},{category:"bookings",type:"cron",description:"Supplier not assigned to job <1 day before attendance",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobNotAssigned",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Supplier not assigned to job <1 day before attendance",taskPriority:1,taskTemplate:"Assign supplier for {{jobId}}",title:"Supplier not assigned",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine"],meta:{sendTo:["admin"]}},{category:"bookings",type:"cron",description:"Job is multiple days in length",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobNotFinished",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job is multiple days in length",taskPriority:1,taskTemplate:"Job is multiple days in length",title:"Job is not finished",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Job status changed to offered",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobOffered",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job has been offered to to {{supplier}} by {{user}}",taskPriority:3,taskTemplate:null,title:"Job offered",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","supplier","property","addressInline","addressPostCode","serviceLine","user"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Sent to a supplier when they are offered a booking",emailBodyTemplate:"Please see below details of an instruction that has been offered to you.\n\n    Job ID: {{jobId}}\n    Date: {{scheduleDate}}\n    Address: {{addressInline}}\n    Service line: {{serviceLine}}\n\n    Description: {{shortJobDesc}}\n    {{description}}\n\n    For further information on these works and any others, just login to your account below.",emailSubjectTemplate:"New job offer",name:"supplierBookingOffered",notificationContent:"Please accept or reject through the application ASAP.",notificationHeading:"Booking Offered",notificationSubtitle:"Cleverly has a new booking offer for you.",slackTemplate:null,smsTemplate:"You have been offered a job please check the app.",systemTemplate:"",taskPriority:3,taskTemplate:null,title:"Supplier received job offer",toastTemplate:"New job offer",whatsappTemplate:null,enabled:["email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier"],meta:{sendTo:["supplier"]}},{category:"bookings",type:"trigger",description:"A supplier rejects job offer",emailBodyTemplate:null,emailSubjectTemplate:null,name:"supplierBookingRejected",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job rejected by {{user}} on behalf of {{supplier}}: {{userNotes}}",taskPriority:3,taskTemplate:null,title:"Job offer rejected",toastTemplate:"Job {{jobId}} rejected by {{supplier}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","user","userNotes"],meta:{sendTo:["admin"]}},{category:"bookings",type:"cron",description:"None of the suppliers accepted the job 2 hours after receiving",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobNotAllocated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"None of the suppliers accepted the job 2 hours after receiving offer",taskPriority:2,taskTemplate:"Re-offer the job {{jobId}}",title:"Job offer not allocated",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"One of the suppliers accepts the job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"supplierBookingAccepted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job has been accepted by {{user}} on behalf of {{supplier}}",taskPriority:3,taskTemplate:null,title:"Job offer accepted",toastTemplate:"Job has been accepted by {{user}} on behalf of {{supplier}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Supplier acceptance confirmed",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobAccepted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"{{supplierUser}} will arrive at {{scheduleDate}}",taskPriority:3,taskTemplate:null,title:"Job gets accepted status",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user","userNotes"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"A supplier that accepted the job can no longer attend",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobRejected",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job rejected by {{user}} on behalf of {{supplier}}: {{userNotes}}",taskPriority:1,taskTemplate:"Job {{jobId}} rejected by {{supplier}}, repost required",title:"Job rejected",toastTemplate:"Job {{jobId}} rejected by {{supplier}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","user","userNotes"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Sent to a supplier when admins change job time",emailBodyTemplate:"Hi {{supplierUser}}\n\n    The scheduled time for job {{jobId}} has changed to {{scheduleDate}}.\n\n    Please login and confirm the attendance time.",emailSubjectTemplate:"Job timing changed",name:"jobTimingChange",notificationContent:"Please confirm the new attendance time",notificationHeading:"Booking Time Changed",notificationSubtitle:"Job {{jobId}}",slackTemplate:null,smsTemplate:null,systemTemplate:"Time has been changed by {{user}} from {{startDate}} - {{endDate}}\n    to {{newStartDate}} - {{newEndDate}}.",taskPriority:3,taskTemplate:null,title:"Job timing changed",toastTemplate:"Job {{jobId}} timing changed",whatsappTemplate:null,enabled:["system","email","sms","notification","toast","slack","whatsapp"],tags:["user","startDate","endDate","newStartDate","newEndDate"],meta:{sendTo:["admin","customer","supplier"]}},{category:"bookings",type:"trigger",description:"Sent to a supplier when admins change pricing or service",emailBodyTemplate:"Hi {{supplierUser}}\n\n    The pricing for job {{jobId}} has changed.\n\n    Please login and confirm attendance.",emailSubjectTemplate:"Job pricing changed",name:"jobPricingChange",notificationContent:"Please confirm the attendance",notificationHeading:"Booking Pricing Changed",notificationSubtitle:"Job {{jobId}}",slackTemplate:null,smsTemplate:null,systemTemplate:"Job pricing or service changed",taskPriority:3,taskTemplate:null,title:"Job pricing changed",toastTemplate:"Job {{jobId}} pricing changed",whatsappTemplate:null,enabled:["email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser"],meta:{sendTo:["supplier"]}},{category:"bookings",type:"cron",description:"Customer has not provided access information",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobNoAccess",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job has no access information",taskPriority:1,taskTemplate:"Confirm access details for {{jobId}}",title:"No access information",toastTemplate:"Job {{jobId}} has no access information",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser"],meta:{sendTo:["admin"]}},{category:"bookings",type:"cron",description:"Notification to supplier about upcoming job 2 hours before scheduled",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobUpcoming",notificationContent:"Upcoming job",notificationHeading:"{{jobId}}",notificationSubtitle:"Scheduled at {{scheduleDate}}",slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"Upcoming job",toastTemplate:"You have an upcoming job {{jobId}} at {{scheduleDate}}",whatsappTemplate:null,enabled:["system","email","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser"],meta:{sendTo:["supplier"]}},{category:"bookings",type:"cron",description:"Reminder to supplier about upcoming job 24 hours before scheduled",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobReminder",notificationContent:"Job reminder",notificationHeading:"{{jobId}}",notificationSubtitle:"Scheduled at {{scheduleDate}}",slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"Job reminder",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser"],meta:{sendTo:["supplier"]}},{category:"bookings",type:"cron",description:"Job has not started in scheduled time",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobNotStarted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job has not started as scheduled by {{supplierUser}} from {{supplier}}",taskPriority:1,taskTemplate:"Job {{jobId}} late arrival, please check with supplier",title:"Job not started / late arrival",toastTemplate:"Job {{jobId}} late arrival",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser"],meta:{sendTo:["admin"]}},{category:"bookings",type:"cron",description:"SLA breached, job has not started in the SLA time window",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobSlaBreached",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job has not started in the SLA time window",taskPriority:1,taskTemplate:"SLA breached for {{jobId}}, contact supplier & customer",title:"SLA breached",toastTemplate:"SLA breached for {{jobId}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Supplier started the job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobStarted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job started by {{supplier}}, {{user}} activated the timer",taskPriority:3,title:"Job started",toastTemplate:"Job {{jobId}} started by {{supplierUser}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user"],meta:{sendTo:["admin"]}},{category:"bookings",type:"cron",description:"Timer active 4 hours after job started",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobTooLong",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Timer active 4 hours after job started",taskPriority:1,taskTemplate:"Contact supplier {{supplier}} for job {{jobId}} to ensure they did not just\n    leave timer running",title:"Long job",toastTemplate:"Job {{jobId}} time active 4 hours after job started",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Supplier completed the job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobCompleted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job completed by {{supplier}}, {{user}} stopped the timer",taskPriority:3,taskTemplate:null,title:"Job completed",toastTemplate:"Job {{jobId}} completed by {{supplierUser}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user"],meta:{sendTo:["admin"]}},{category:"bookings",type:"cron",description:"Supplier has not submitted job report 4 hours after job complete",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobReportNotReceived",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"{{supplier}} has not submitted job report",taskPriority:1,taskTemplate:"Contact {{jobId}} supplier for job report",title:"Job report not received",toastTemplate:"{{jobId}} job report not received",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Supplier submitted the job report",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobReportSentSupplier",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"{{supplier}} job report submitted by {{user}}: {{jobReport}}",taskPriority:3,taskTemplate:null,title:"Job report sent",toastTemplate:"{{jobId}} job report submitted by {{supplier}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","jobReport","user"],meta:{sendTo:["admin"]}},{category:"bookings",type:"cron",description:"Job report has not been sent to customer 8 hours after job completed",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobReportNotSent",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"{{jobId}} job report has not been sent to {{customer}}",taskPriority:1,taskTemplate:"Send job report to customer",title:"Job report not received",toastTemplate:"{{jobId}} job report not sent to customer",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Admin sends job report to customer",emailBodyTemplate:"Hi {{customer}}\n\n    A report for job {{jobId}} at {{property}} can be downloaded by clicking the button below.",emailSubjectTemplate:"{{jobId}} job report",name:"jobReportSent",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job report sent to {{customer}} {{customerEmail}} by {{user}}",taskPriority:3,taskTemplate:null,title:"Job report sent",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","customerEmail","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user"],meta:{sendTo:["customer"]}},{category:"bookings",type:"trigger",description:"Admin validates job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobValidated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job validated by {{user}}. {{notes}}",taskPriority:3,taskTemplate:"Send invoices to customer and supplier",title:"Job validated",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user","notes"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Admin un-validates job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobUnvalidated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job un-validated by {{user}}. {{notes}}",taskPriority:3,taskTemplate:null,title:"Job un-validated",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user","notes"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Admin sends the invoice to customer",emailBodyTemplate:"Hi {{customer}},\n\n    Your invoice for job {{jobId}} at {{property}} is now available, click the button below to\n    download it.",emailSubjectTemplate:"Invoice for job {{jobId}}",name:"jobInvoiceSentCustomer",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Invoice for {{total}} sent to customer by {{user}}",taskPriority:3,taskTemplate:null,title:"Invoice sent to customer",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["total","jobId","jobStatus","shortJobDesc","description","customer","customerUser","customerEmail","property","addressInline","addressPostCode","serviceLine","user"],meta:{sendTo:["admin","customer"]}},{category:"bookings",type:"trigger",description:"Admin sends the invoice to supplier",emailBodyTemplate:"Hi {{supplierUser}},\n\n    Your invoice for job {{jobId}} at {{property}} is now available, click the button below to\n    download it.",emailSubjectTemplate:"Invoice for job {{jobId}}",name:"jobInvoiceSentSupplier",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Invoice for {{total}} sent to customer by {{user}}",taskPriority:3,taskTemplate:null,title:"Invoice sent to supplier",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["total","jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","supplierEmail","user"],meta:{sendTo:["admin","supplier"]}},{category:"bookings",type:"trigger",description:"Job dispute was submitted",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobDisputeAdded",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job dispute submitted by {{user}}: {{userNotes}}",taskPriority:1,taskTemplate:"Job {{jobId}} at {{property}} disputed, contact customer & supplier",title:"Job disputed",toastTemplate:"A dispute submitted for job {{jobId}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user","userNotes"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Admin marks job dispute as resolved",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobDisputeResolved",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job dispute marked as resolved by {{user}}: {{userNotes}}",taskPriority:3,taskTemplate:null,title:"Job dispute resolved",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user","userNotes"],meta:{sendTo:["customer"]}},{category:"bookings",type:"trigger",description:"Customer payment reconciled",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobCustomerPaid",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Customer has paid {{amount}}.",taskPriority:3,taskTemplate:null,title:"Customer paid",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["amount"],meta:{sendTo:["admin","customer"]}},{category:"bookings",type:"trigger",description:"Supplier payment reconciled",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobSupplierPaid",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Supplier has been paid.",taskPriority:3,taskTemplate:null,title:"Supplier paid",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user","userNotes"],meta:{sendTo:["admin","supplier"]}},{category:"bookings",type:"trigger",description:"Customer requests compliance documentation",emailBodyTemplate:null,emailSubjectTemplate:null,name:"requestComplianceDocument",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Customer requests compliance documentation",taskPriority:3,title:"Compliance documentation",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user","userNotes"],meta:{sendTo:["supplier"]}},{category:"bookings",type:"trigger",description:"Customer Should approve compliance document",emailBodyTemplate:null,emailSubjectTemplate:null,name:"requestApprovedComplianceDocument",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Customer  Should approve compliance document",taskPriority:3,title:"compliance approved",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user","userNotes"],meta:{sendTo:["customer"]}},{category:"bookings",type:"trigger",description:"Admins canceled the job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobCanceled",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job marked as canceled by {{user}}: {{userNotes}}",taskPriority:3,title:"Job canceled",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user","userNotes"],meta:{sendTo:["admin","supplier"]}},{category:"bookings",type:"trigger",description:"Admins closed the job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobClosed",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job was closed by {{user}}. {{userNotes}}",taskPriority:3,title:"Job closed",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user","userNotes"],meta:{sendTo:["admin","customer","supplier"]}},{category:"bookings",type:"trigger",description:"Job finance is updated",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobFinancesUpdated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Finances changed to {{total}} by {{user}}",taskPriority:3,title:"Job finance updated",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","sms","notification","toast","slack","whatsapp"],tags:["jobId","type","value","difference","shortJobDesc","description","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier","supplierUser","user"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Supplier uploaded invoice",emailBodyTemplate:"{{supplier}} uploaded an invoice for job {{jobId}} .\n    Please review the invoice.",emailSubjectTemplate:"Supplier uploaded invoice",name:"supplierUploadedInvoice",notificationContent:"{{supplier}} uploaded an invoice for job {{jobId}}",notificationHeading:"Invoice Upload",notificationSubtitle:"Supplier uploaded an invoice",slackTemplate:null,smsTemplate:"Invoice Uploaded by supplier",systemTemplate:"{{supplier}} uploaded invoice",taskPriority:3,taskTemplate:null,title:"Supplier uploaded invoice",toastTemplate:"Supplier uploaded invoice",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Media uploaded",emailBodyTemplate:"A media uploaded for job {{jobId}} .\n    Please review the job.",emailSubjectTemplate:"Media uploaded for job",name:"mediaUploadedForJob",notificationContent:"A media uploaded for job {{jobId}}",notificationHeading:"Media uploaded for job",notificationSubtitle:"Media uploaded for a job",slackTemplate:null,smsTemplate:"A media uploaded for job {{jobId}}",systemTemplate:"{{user}} uploaded a file {{filename}}.",taskPriority:3,taskTemplate:null,title:"Media uploaded for job",toastTemplate:"Media uploaded for job",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["user","filename","jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier"],meta:{sendTo:["admin","supplier","customer"]}},{category:"bookings",type:"trigger",description:"Waiting for approval",emailBodyTemplate:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",emailSubjectTemplate:"waiting for approval",name:"waitingThresholdApproval",notificationContent:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",notificationHeading:"Waiting for approval",notificationSubtitle:"Waiting for approval",slackTemplate:null,smsTemplate:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",systemTemplate:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",taskPriority:1,taskTemplate:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",title:"Job is waiting for threshold approval",toastTemplate:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","jobTotal","requestee","requester"],meta:{sendTo:["admin","supplier","customer"]}},{category:"bookings",type:"trigger",description:"Threshold is approved",emailBodyTemplate:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",emailSubjectTemplate:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",name:"thresholdApproved",notificationContent:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",notificationHeading:"Threshold is approved",notificationSubtitle:"Threshold is approved",slackTemplate:null,smsTemplate:"Threshold is approved",systemTemplate:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",taskPriority:3,taskTemplate:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",title:"Threshold is approved",toastTemplate:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","type","jobTotal","approver"],meta:{sendTo:["admin","supplier","customer"]}},{category:"bookings",type:"trigger",description:"Threshold is rejected",emailBodyTemplate:"{{type}} of {{jobTotal}} rejected by {{rejecter}} for job {{jobId}}",emailSubjectTemplate:"Threshold is rejected",name:"thresholdRejected",notificationContent:"Threshold is rejected",notificationHeading:"Threshold is rejected",notificationSubtitle:"Threshold is rejected",slackTemplate:null,smsTemplate:"Threshold is rejected",systemTemplate:"{{type}} of {{jobTotal}} rejected by {{rejecter}} for job {{jobId}}",taskPriority:3,taskTemplate:"{{type}} of {{jobTotal}} rejected by {{rejecter}} for job {{jobId}}",title:"Threshold is rejected",toastTemplate:"{{type}} of {{jobTotal}} rejected by {{rejecter}} for job {{jobId}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","type","jobTotal","rejecter"],meta:{sendTo:["admin","supplier","customer"]}},{category:"bookings",type:"trigger",description:"Uplift is requested by supplier",emailBodyTemplate:"Uplift is requested by supplier.",emailSubjectTemplate:"Uplift is requested",name:"jobSupplierUpliftRequested",notificationContent:"Uplift is requested by supplier.",notificationHeading:"Uplift is requested",notificationSubtitle:"Uplift is requested by supplier.",slackTemplate:null,smsTemplate:"Uplift is requested by supplier.",systemTemplate:"Uplift is requested of {{total}} by supplier.",taskPriority:3,taskTemplate:"Uplift is requested by supplier.",title:"Uplift is requested",toastTemplate:"Uplift is requested by supplier.",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["total","jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier"],meta:{sendTo:["admin","supplier"]}},{category:"bookings",type:"trigger",description:"Admin sends uplift to customer",emailBodyTemplate:"Admin sends uplift to customer.",emailSubjectTemplate:"Admin sends uplift to customer",name:"jobUpliftRequestSendCustomer",notificationContent:"Admin sends uplift to customer.",notificationHeading:"Admin sends uplift to customer",notificationSubtitle:"Admin sends uplift to customer",slackTemplate:null,smsTemplate:"Admin sends uplift to customer.",systemTemplate:"Admin sends uplift of {{total}} to customer.",taskPriority:3,taskTemplate:"Admin sends uplift to customer.",title:"Admin sends uplift to customer",toastTemplate:"Admin sends uplift to customer.",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["total","jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier"],meta:{sendTo:["admin","customer"]}},{category:"bookings",type:"trigger",description:"Uplift is approved by customer",emailBodyTemplate:"Uplift is approved by customer",emailSubjectTemplate:"Uplift is approved by customer",name:"jobCustomerUpliftApproved",notificationContent:"Uplift is approved by customer",notificationHeading:"Uplift is approved",notificationSubtitle:"Uplift is approved by customer",slackTemplate:null,smsTemplate:"Uplift is approved by customer",systemTemplate:"Uplift is approved by {{type}} {{user}}. {{notes}}",taskPriority:3,taskTemplate:"Uplift is approved by customer",title:"Uplift is approved",toastTemplate:"Uplift is approved by customer",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["type","user","notes","jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier"],meta:{sendTo:["admin","customer","supplier"]}},{category:"bookings",type:"trigger",description:"Uplift is rejected by customer",emailBodyTemplate:"Uplift is rejected by customer",emailSubjectTemplate:"Uplift is rejected",name:"jobCustomerUpliftRejected",notificationContent:"Uplift is rejected by customer",notificationHeading:"Uplift is rejected",notificationSubtitle:"Uplift is rejected by customer",slackTemplate:null,smsTemplate:"Uplift is rejected by customer",systemTemplate:"Uplift is approved by {{type}} {{user}}. {{notes}}",taskPriority:3,taskTemplate:"Uplift is rejected by customer",title:"Uplift is rejected",toastTemplate:"Uplift is rejected by customer",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["type","user","notes","jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier"],meta:{sendTo:["admin","customer","supplier"]}},{category:"bookings",type:"trigger",description:"Job is cancelled by supplier",emailBodyTemplate:"Job is cancelled by supplier",emailSubjectTemplate:"Job is cancelled by supplier",name:"jobSupplierCancel",notificationContent:"Job is cancelled by supplier",notificationHeading:"Job is cancelled by supplier",notificationSubtitle:"Job is cancelled by supplier",slackTemplate:null,smsTemplate:"Job is cancelled by supplier",systemTemplate:"Job is cancelled by supplier",taskPriority:3,taskTemplate:"Job is cancelled by supplier",title:"Job is cancelled by supplier",toastTemplate:"Job is cancelled by supplier",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier"],meta:{sendTo:["admin","customer"]}},{category:"bookings",type:"trigger",description:"Job offer input is updated by supplier",emailBodyTemplate:"Job offer input is updated by supplier",emailSubjectTemplate:"Job offer input is updated by supplier",name:"jobUpdateAcceptOfferInput",notificationContent:"Job offer input is updated by supplier",notificationHeading:"Job offer input is updated by supplier",notificationSubtitle:"Job offer input is updated by supplier",slackTemplate:null,smsTemplate:"Job offer input is updated by supplier",systemTemplate:"Job offer input is updated by supplier",taskPriority:3,taskTemplate:"Job offer input is updated by supplier",title:"Job offer input is updated by supplier",toastTemplate:"Job offer input is updated by supplier",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier"],meta:{sendTo:["admin","customer"]}},{category:"quotes",type:"trigger",description:"A quote is raised",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteRaised",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote raised",taskPriority:3,taskTemplate:null,title:"Quote raised",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["user","jobId","jobStatus","shortJobDesc","description","scheduleDate","property","addressInline","addressPostCode","serviceLine"],meta:{sendTo:["admin"]}},{category:"quotes",type:"trigger",description:"Quote status changed to requested",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteRequested",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote requested from suppliers",taskPriority:3,taskTemplate:null,title:"Quote requested",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","property","addressInline","addressPostCode","serviceLine"],meta:{sendTo:["admin"]}},{category:"quotes",type:"trigger",description:"Sent to a supplier when a job quote is requested",emailBodyTemplate:"Please see below details of an instruction that has been offered to you.\n\n    Job ID: {{jobId}}\n    Date: {{scheduleDate}}\n    Address: {{addressInline}}\n    Service line: {{serviceLine}}\n\n    Description: {{shortJobDesc}}\n    {{description}}",emailSubjectTemplate:"Job offered to supplier",name:"supplierQuoteRequested",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:"A new quote request",systemTemplate:"",taskPriority:3,taskTemplate:null,title:"Supplier receives a quotation request",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","property","addressInline","addressPostCode","serviceLine"],meta:{sendTo:["supplier"]}},{category:"quotes",type:"trigger",description:"A supplier rejects quote",emailBodyTemplate:null,emailSubjectTemplate:null,name:"supplierQuoteRejected",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote declined by {{supplier}}",taskPriority:3,taskTemplate:null,title:"Quote declined",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","property","addressInline","addressPostCode","serviceLine"],meta:{sendTo:["admin"]}},{category:"quotes",type:"trigger",description:"A supplier submits quotation",emailBodyTemplate:null,emailSubjectTemplate:null,name:"supplierQuoteComplete",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote totalling {{total}} has been submitted by {{supplier}} {{user}}",taskPriority:3,taskTemplate:null,title:"Quotation submitted",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["total","supplier","user","jobId","jobStatus","shortJobDesc","description","property","addressInline","addressPostCode","serviceLine"],meta:{sendTo:["admin"]}},{category:"quotes",type:"trigger",description:"Admin sends quotation to customer",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteSent",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote number {{quoteNumber}} has been sent to customer.",taskPriority:3,taskTemplate:null,title:"Quotation sent to customer",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["quoteNumber","jobId","jobStatus","shortJobDesc","description","property","addressInline","addressPostCode","serviceLine","customer"],meta:{sendTo:["admin","customer"]}},{category:"quotes",type:"trigger",description:"Customer accepts a quotation",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteAccepted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote number {{quoteNumber}} has been accepted by {{customer}} User: {{user}}",taskPriority:3,taskTemplate:null,title:"Quote accepted",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["quoteNumber","customer","user","jobId","jobStatus","shortJobDesc","description","property","addressInline","addressPostCode","serviceLine","customer"],meta:{sendTo:["admin","customer"]}},{category:"quotes",type:"trigger",description:"Customer rejects a quotation",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteRejected",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote number {{quoteNumber}} has been rejected by {{customer}} User: {{user}}",taskPriority:3,taskTemplate:null,title:"Quote rejected",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["quoteNumber","customer","user","jobId","jobStatus","shortJobDesc","description","property","addressInline","addressPostCode","serviceLine","customer"],meta:{sendTo:["admin","customer"]}},{category:"quotes",type:"trigger",description:"Supplier selects site visit",emailBodyTemplate:null,emailSubjectTemplate:null,name:"supplierSelectSiteVisit",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Supplier selects site visit {{siteVisitAt}}",taskPriority:3,taskTemplate:null,title:"SiteVisit is selected",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","property","addressInline","addressPostCode","serviceLine","customer","siteVisitAt"],meta:{sendTo:["admin","customer"]}},{category:"quotes",type:"trigger",description:"Quote is not sent",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteNotSent",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote is not sent",taskPriority:3,taskTemplate:null,title:"Quote is not sent",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","property","addressInline","addressPostCode","serviceLine","customer","siteVisitAt"],meta:{sendTo:["admin"]}},{category:"quotes",type:"trigger",description:"Quote is not completed",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteNotComplete",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote is not completed",taskPriority:3,taskTemplate:null,title:"Quote is not completed",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:["jobId","jobStatus","shortJobDesc","description","property","addressInline","addressPostCode","serviceLine","customer","siteVisitAt"],meta:{sendTo:["supplier"]}},{category:"quotes",type:"trigger",description:"Waiting for approval",emailBodyTemplate:"Quote is waiting for threshold approval.",emailSubjectTemplate:"waiting for approval",name:"quoteWaitingForThresholdApproval",notificationContent:"Quote is waiting for threshold approval.",notificationHeading:"Quote is waiting for threshold approval",notificationSubtitle:"Quote is waiting for threshold approval",slackTemplate:null,smsTemplate:"Quote is waiting for threshold approval.",systemTemplate:"Quote is waiting for threshold approval.",taskPriority:3,taskTemplate:"Quote is waiting for threshold approval.",title:"Quote is waiting for threshold approval",toastTemplate:"Quote is waiting for threshold approval.",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","property","addressInline","addressPostCode","serviceLine","customer","siteVisitAt","customerThreshold"],meta:{sendTo:["admin"]}},{category:"quotes",type:"trigger",description:"Quote threshold is approved",emailBodyTemplate:"Quote threshold is approved",emailSubjectTemplate:"Threshold is approved",name:"quoteThresholdApproved",notificationContent:"Quote threshold is approved",notificationHeading:"Quote threshold is approved",notificationSubtitle:"Quote threshold is approved",slackTemplate:null,smsTemplate:"Quote threshold is approved",systemTemplate:"Quote threshold is approved",taskPriority:3,taskTemplate:"Quote threshold is approved",title:"Quote threshold is approved",toastTemplate:"Quote threshold is approved",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","property","addressInline","addressPostCode","serviceLine","customer","siteVisitAt"],meta:{sendTo:["admin"]}},{category:"quotes",type:"trigger",description:"Quote threshold is rejected",emailBodyTemplate:"Quote threshold is rejected",emailSubjectTemplate:"Quote threshold is rejected",name:"quoteThresholdRejected",notificationContent:"Quote threshold is rejected",notificationHeading:"Quote threshold is rejected",notificationSubtitle:"Quote threshold is rejected",slackTemplate:null,smsTemplate:"Quote threshold is rejected",systemTemplate:"Quote threshold is rejected",taskPriority:3,taskTemplate:"Quote threshold is rejected",title:"Quote threshold is rejected",toastTemplate:"Quote threshold is rejected}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","property","addressInline","addressPostCode","serviceLine","customer","siteVisitAt"],meta:{sendTo:["admin"]}},{category:"quotes",type:"trigger",description:"Quotation item inserted",emailBodyTemplate:"Quotation item inserted",emailSubjectTemplate:"Quotation item inserted",name:"quotationItemInserted",notificationContent:"Quotation item inserted",notificationHeading:"Quotation item inserted",notificationSubtitle:"Quotation item inserted",slackTemplate:null,smsTemplate:"Quotation item inserted",systemTemplate:"Quotation({{quoteNumber}}) was inserted by {{user}}.\n{{description}} was inserted {{quontity}} {{quontityUnit}} {{supplierRate}} {{customerRate}}",taskPriority:3,taskTemplate:"Quotation item inserted",title:"Quotation item inserted",toastTemplate:"Quotation item inserted",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["user","quoteNumber","description","quontity","quontityUnit","supplierRate","customerRate"],meta:{sendTo:["admin","supplier","customer"]}},{category:"quotes",type:"trigger",description:"Quotation item amended",emailBodyTemplate:"Quotation item amended",emailSubjectTemplate:"Quotation item amended",name:"quotationItemAmended",notificationContent:"Quotation item amended",notificationHeading:"Quotation item amended",notificationSubtitle:"Quotation item amended",slackTemplate:null,smsTemplate:"Quotation item amended",systemTemplate:"Quotation({{quoteNumber}}) was amended by {{user}}. {{changes}}",taskPriority:3,taskTemplate:"Quotation item amended",title:"Quotation item amended",toastTemplate:"Quotation item amended",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["user","quoteNumber","changes"],meta:{sendTo:["admin","supplier","customer"]}},{category:"quotes",type:"trigger",description:"Quotation item deleted",emailBodyTemplate:"Quotation item deleted",emailSubjectTemplate:"Quotation item deleted",name:"quotationItemDeleted",notificationContent:"Quotation item deleted",notificationHeading:"Quotation item deleted",notificationSubtitle:"Quotation item deleted",slackTemplate:null,smsTemplate:"Quotation item deleted",systemTemplate:"Quotation({{quoteNumber}}) was deleted by {{user}}.\n{{description}} was deleted.",taskPriority:3,taskTemplate:"Quotation item deleted",title:"Quotation item deleted",toastTemplate:"Quotation item deleted",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["user","quoteNumber","description","quontity","quontityUnit","supplierRate","customerRate"],meta:{sendTo:["admin","supplier","customer"]}},{category:"ppm",type:"trigger",description:"A new supplier contract has been created at property",emailBodyTemplate:"Hi {{name}},\n\nA new supplier contract has been created at {{property}}: {{shortJobDesc}}.\nClick the button below to review and confirm.\n",emailSubjectTemplate:"Booking added to Cleverly",name:"ppmSupplierContractAdded",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Supplier contract added",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:["property","addressInline","addressPostCode","shortJobDesc"],meta:{sendTo:["admin","customer"]}},{category:"ppm",type:"cron",description:"Reminder for an upcoming scheduled job",emailBodyTemplate:"Hi {{name}},\n\nYou have an upcoming job at {{property}} scheduled at {{date}}.\nClick the button below to confirm attendance.\n",emailSubjectTemplate:"Upcoming scheduled job",name:"ppmJobReminder",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Upcoming scheduled job",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:["date","property","addressInline","addressPostCode","shortJobDesc"],meta:{sendTo:["customer"]}},{category:"assets",type:"trigger",description:"Notify invitees when a booking is created",emailBodyTemplate:"Hi,\n\nYou've been invited to {{bookingTitle}} at {{property}} on {{bookingStart}}.",emailSubjectTemplate:"Invitation",name:"assetBookingAdded",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Asset booking invitation",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:["addressInline","bookingEnd","bookingStart","bookingTitle","property"],meta:{sendTo:["tenant"]}},{category:"assets",type:"trigger",description:"Notify invitees when a booking is updated",emailBodyTemplate:"Hi,\n\nInvitation to {{bookingTitle}} at {{property}} on {{bookingStart}} has been updated.",emailSubjectTemplate:"Booking updated",name:"assetBookingUpdated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Asset booking invitation update",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:["addressInline","bookingEnd","bookingStart","bookingTitle","property"],meta:{sendTo:["tenant"]}},{category:"assets",type:"trigger",description:"Notify invitees when a booking is cancelled",emailBodyTemplate:"Hi {{name}},\n\nInvitation to {{bookingTitle}} at {{property}} on {{bookingStart}} has been cancelled.",emailSubjectTemplate:"Booking cancelled",name:"assetBookingCancelled",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Asset booking invitation cancelled",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:["addressInline","bookingEnd","bookingStart","bookingTitle","property"],meta:{sendTo:["tenant"]}},{category:"assets",type:"trigger",description:"Temperature sensor out of bounds",emailBodyTemplate:"Hi {{name}},\n\nA sensor at {{property}} is out of bounds.",emailSubjectTemplate:"Sensor out of bounds",name:"sensorOutOfBounds",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Sensor out of bounds",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:["property","addressInline"],meta:{sendTo:["customer"]}},{category:"assets",type:"cron",description:"Asset vacated based on occupancy sensor",emailBodyTemplate:"Hi {{name}},\n\nAsset {{asset}} at {{property}} has been vacated.",emailSubjectTemplate:"Asset vacated",name:"assetVacated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Asset vacated",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:["property","addressInline","asset"],meta:{sendTo:["customer"]}},{category:"supplierOnboarding",type:"trigger",description:"Admin adds a new supplier account",emailBodyTemplate:"Thank you for your interest in becoming a supplier to Cleverly\n\n    By completing your profile you will be able to start receiving work orders from the system and\n    getting paid for works undertaken.\n\n    By clicking the button below, you will be prompted to create a password. After this, you will\n    eed to provide information to register yourself as a supplier.\n\n    We hope that you will find the platform easy to use and self-explanatory, but please let us know\n    if you encounter any issues. You can do so by emailing us at suppliers@cleverly.works\n\n    We look forward to welcoming you as a Cleverly supplier soon.",emailSubjectTemplate:"Becoming a Cleverly Supplier",name:"supplierCreated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"",taskPriority:3,taskTemplate:null,title:"Supplier created",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms"],tags:["name","accountName"],meta:{sendTo:["supplier"]}},{category:"customerOnboarding",type:"trigger",description:"Admin adds a new customer account",emailBodyTemplate:"Hi {{accountName}}\n\n    Let\u2019s get started!\n\n    Cleverly has been built to be as intuitive and powerful as possible.\n\n    The first step is to complete your profile and add your team members and colleagues. By letting\n    us know who to contact about jobs, invoices etc. you can ensure that the right people get the\n    right information.\n\n    By clicking the button below, you will be prompted to create a password and complete your\n    profile. Once this is done, you can start to add other information such as properties.\n\n    And if you have any issues, just get in touch with us. We are happy to help.",emailSubjectTemplate:"Welcome to Cleverly",name:"customerCreated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"",taskPriority:3,taskTemplate:null,title:"Customer created",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms"],tags:["name","accountName"],meta:{sendTo:["customer"]}},{category:"tenantOnboarding",type:"trigger",description:"Tenant added to a property",emailBodyTemplate:"Hi {{name}},\n\n    Your booking at {{property}} has been added to Cleverly.\n    Click the button below to report any issues during your stay:",emailSubjectTemplate:"Booking added to Cleverly",name:"tenantBookingAdded",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Tenant booking added",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:["property","addressInline","addressPostCode"],meta:{sendTo:["tenant"]}},{category:"accounts",type:"trigger",description:"User added to an existing account",emailBodyTemplate:"Hi {{name}},\n\n    You have been invited to Cleverly by {{accountName}}. Click the button below to set your\n    password and complete your profile.",emailSubjectTemplate:"Welcome to Cleverly",name:"userAddedToAccount",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"User created",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms"],tags:["name","accountName"],meta:null},{category:"accounts",type:"trigger",description:"User forgot password",emailBodyTemplate:"Hi {{name}},\n\n    You can reset your Cleverly password by clicking the button below or copying and pasting it\n    into your browser. For increased security, this password reset link will expire 24 hours after\n    it was sent.",emailSubjectTemplate:"Reset your Cleverly password",name:"userPasswordReset",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"User password reset",toastTemplate:null,whatsappTemplate:null,enabled:["email"],tags:["name"],meta:null},{category:"accounts",type:"trigger",description:"User receives a message",emailBodyTemplate:"Hi {{name}},\n\nYou've been tagged in a message:\n{{message}}",emailSubjectTemplate:"{{sender}} has sent a new message",name:"userReceivesMessage",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"New message",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:["name","message","sender"],meta:null},{category:"accounts",type:"trigger",description:"User gets assigned a new task",emailBodyTemplate:"Hi {{name}},\n\nA new task has been assigned to you. Click the button bellow to see it.",emailSubjectTemplate:"New task assigned",name:"userReceivesTask",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"New task assigned",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:["name","task"],meta:null},{category:"accounts",type:"trigger",description:"Cleverly document expiry",emailBodyTemplate:'Hi {{name}},\n\n    We wanted to let you know that one (or more) of your accreditations or insurances listed below\n    is due to expire shortly. In order to keep your account active, please send us an updated copy\n    of your document so that we can place this on your account.\n\n    [[TABLE {"Type": "scheme", "Issuing body": "provider", "Expiry Date": "date"}]]\n\n    To see all your current documents and account details, along with further details of works,\n    your earnings history and of course your performance data just login to your Cleverly account.',emailSubjectTemplate:"Cleverly Admin Document Expiry",name:"documentExpiry",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:"Document is expiring, please check the desktop platform.",systemTemplate:null,taskPriority:3,taskTemplate:"Check customer documents with them",title:"Document expiry",toastTemplate:null,whatsappTemplate:null,enabled:["email"],tags:["name","accountName","date"],meta:null},{category:"broadcasts",type:"trigger",description:"Broadcast message is published",emailBodyTemplate:"Hi {{name}},\n\n    {{message}}",emailSubjectTemplate:"You have a message",name:"broadcast",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:"A broadcast message is published",systemTemplate:null,taskPriority:3,taskTemplate:"A broadcast message is published",title:"A broadcast message is published",toastTemplate:null,whatsappTemplate:null,enabled:["email"],tags:["name","message"],meta:null},{category:"bookings",type:"trigger",description:"CreditNote Created",emailBodyTemplate:"{{supplier}} created an creditNote for job {{jobId}} .\n    Please review the creditNote.",emailSubjectTemplate:"Created creditNote",name:"creditNoteCreated",notificationContent:"{{user}} created an creditNote for job {{jobId}}. {{reason}}",notificationHeading:"CreditNote Created",notificationSubtitle:"added an CreditNote",slackTemplate:null,smsTemplate:"CreditNote Uploaded",systemTemplate:"CreditNote created, {{reason}}",taskPriority:3,taskTemplate:null,title:"Created CreditNote",toastTemplate:"Created creditNote",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","scheduleDate","customer","customerUser","property","addressInline","addressPostCode","serviceLine","supplier"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Proforma Invoice Created",emailBodyTemplate:"{{customer}} created a Proforma Invoice for job {{jobId}} .\n    Please review it.",emailSubjectTemplate:"Created proforma invoice",name:"proformaInvoiceCreated",notificationContent:"{{user}} created a proformaInvoice for job {{jobId}}.",notificationHeading:"ProformaInvoice Created",notificationSubtitle:"added a proformaInvoice",slackTemplate:null,smsTemplate:"proformaInvoice Uploaded",systemTemplate:"proformaInvoice created",taskPriority:3,taskTemplate:null,title:"Created proformaInvoice",toastTemplate:"Created proformaInvoice",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:["jobId","jobStatus","shortJobDesc","description","user"],meta:{sendTo:["admin"]}},{category:"bookings",type:"trigger",description:"Sent to a supplier when admins change job start and end time",emailBodyTemplate:"Hi {{supplierUser}}\n\n    The scheduled time for job {{jobId}} has changed.\n    Job start: {{correctStart}} Job end: {{correctEnd}}\n\n    Please login and confirm the attendance time.",emailSubjectTemplate:"Job start, end date were changed",name:"jobCorrectTiming",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"{{user}} changed job timings. Job start: {{correctStart}} Job end: {{correctEnd}}",taskPriority:3,taskTemplate:null,title:"Job correct start and end time",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","sms","notification","toast"],tags:["supplierUser","correctStart","correctEnd","jobId","user"],meta:{sendTo:["admin","supplier"]}}];function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=function(e){var t,n,a,s,o,i,l,r,p=e.app,c=e.defaultValues,u=void 0===c?{}:c,d=e.onSubmit,m=u.tags.reduce((function(e,t){return Be(Be({},e),{},(0,x.Z)({},t,t))}),{});u.emailTemplateData=JSON.stringify(m);var b=(0,O.cI)({defaultValues:u,resolver:(0,D.S)(me)}),y=b.errors,f=b.getValues,g=b.handleSubmit,T=b.register,h=b.setValue,j=b.watch,k={errors:y,getValues:f,register:T};return(0,M.jsxs)(J.Z,{id:"offCanvasForm",handleSubmit:g(d),children:[(0,M.jsxs)(U.Z,{children:[(0,M.jsxs)(Z.Z,{md:6,children:[(0,M.jsx)(q.Z,{label:"Title",children:(0,M.jsx)(A.Z,Be(Be({},k),{},{name:"title"}))}),(0,M.jsx)(q.Z,{label:"Category",children:(0,M.jsx)(_.Z,Be(Be({},k),{},{name:"category",options:Ze}))})]}),(0,M.jsxs)(Z.Z,{md:6,children:[(0,M.jsx)(q.Z,{label:"Name",children:(0,M.jsx)(A.Z,Be(Be({},k),{},{name:"name",readOnly:!0}))}),(0,M.jsx)(q.Z,{label:"Description",children:(0,M.jsx)(A.Z,Be(Be({},k),{},{name:"description"}))})]})]}),"accounts"!==u.category&&(0,M.jsx)(B.Z,Be(Be({},k),{},{data:qe,legend:"Send notifications to",name:"sendTo"})),(0,M.jsx)(H.Z,{}),(null===u||void 0===u||null===(t=u.enabled)||void 0===t?void 0:t.includes("system"))&&(0,M.jsx)(I.Z,{title:"System Message",children:(0,M.jsx)(ve,Be(Be({},k),{},{defaultValues:u,setValue:h,watch:j}))}),(null===u||void 0===u||null===(n=u.enabled)||void 0===n?void 0:n.includes("email"))&&(0,M.jsx)(I.Z,{title:"Email",children:(0,M.jsx)(oe,Be(Be({},k),{},{app:p,defaultValues:u,setValue:h,watch:j}))}),(null===u||void 0===u||null===(a=u.enabled)||void 0===a?void 0:a.includes("task"))&&(0,M.jsx)(I.Z,{title:"Task",children:(0,M.jsx)(Pe,Be(Be({},k),{},{defaultValues:u,setValue:h,watch:j}))}),(null===u||void 0===u||null===(s=u.enabled)||void 0===s?void 0:s.includes("sms"))&&(0,M.jsx)(I.Z,{title:"SMS",children:(0,M.jsx)(he,Be(Be({},k),{},{defaultValues:u,setValue:h,watch:j}))}),(null===u||void 0===u||null===(o=u.enabled)||void 0===o?void 0:o.includes("notification"))&&(0,M.jsx)(I.Z,{title:"Push",children:(0,M.jsx)(ue,Be(Be({},k),{},{defaultValues:u,setValue:h,watch:j}))}),(null===u||void 0===u||null===(i=u.enabled)||void 0===i?void 0:i.includes("toast"))&&(0,M.jsx)(I.Z,{title:"Toast",children:(0,M.jsx)(Oe,Be(Be({},k),{},{defaultValues:u,setValue:h,watch:j}))}),(null===u||void 0===u||null===(l=u.enabled)||void 0===l?void 0:l.includes("slack"))&&(0,M.jsx)(I.Z,{title:"Slack",children:(0,M.jsx)(fe,Be(Be({},k),{},{defaultValues:u,setValue:h,watch:j}))}),(null===u||void 0===u||null===(r=u.enabled)||void 0===r?void 0:r.includes("whatsapp"))&&(0,M.jsx)(I.Z,{title:"WhatsApp",children:(0,M.jsx)(Ue,Be(Be({},k),{},{defaultValues:u,setValue:h,watch:j}))}),u.id&&(0,M.jsx)(A.Z,Be(Be({},k),{},{name:"id",type:"hidden"})),u.adminId&&(0,M.jsx)(A.Z,Be(Be({},k),{},{name:"adminId",type:"hidden"}))]})},Le=function(e){var t=e.adminId,n=e.events,a=e.filters,s=e.refetch,o=e.title,i=(0,C.q)(),r=(0,re.x)().user,p=(0,l.useContext)(v.Z),u=(0,k.D)(y),d=(0,c.Z)(u,1)[0],m=(0,k.D)(f),b=(0,c.Z)(m,1)[0],g=function(){var e=(0,T.Z)(j().mark((function e(t){var n;return j().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=X(t)).id){e.next=6;break}return e.next=4,b({variables:{id:n.id,changes:n}});case 4:e.next=9;break;case 6:return n.adminId=r.accountId,e.next=9,d({variables:{object:n}});case 9:if(p.close(),s&&s(),!n.email||!n.emailSubjectTemplate){e.next=14;break}return e.next=14,K(n);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(e){var n=function(e,t){var n,a=Y({adminId:t},e);return a.tags.push("button_title"),a.tags.push("button_url"),["email","notification","sms","slack","task","toast","whatsapp"].forEach((function(e){a[e]||(a[e]=!1)})),a.taskPriority||(a.taskPriority=3),null!==a&&void 0!==a&&null!==(n=a.meta)&&void 0!==n&&n.sendTo&&(a.sendTo=a.meta.sendTo),a}(e.item,t);p.show({content:(0,M.jsx)(He,{app:i,defaultValues:n,onSubmit:g}),title:"Edit Event Settings"})},x=[{formatter:function(e){var t=e.row;return(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)("strong",{children:t.name}),(0,M.jsx)(w.Z,{size:"sm",children:t.item.description})]})},text:"Event"},{formatter:function(e){var t=e.row;return(0,M.jsx)("strong",{children:t.sendTo})},text:"Send to"},{text:"Email"},{text:"Task"},{text:"SMS"},{text:"Push"},{text:"Toast"},{text:"Slack"},{text:"Whatsapp"},{formatter:S.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:function(e,t){return h(t)},tooltip:"Edit"}],text:"Actions"},{hidden:!0}];return(0,M.jsx)(I.Z,{open:!0,title:o,children:(0,M.jsx)(P.Z,{columns:x,rows:n.filter((function(e){return!a.q||e.name.includes(a.q)||e.title.includes(a.q)||e.description.includes(a.q)})).filter((function(e){return!a.type||e.type===a.type})).map((function(e){var t;return{name:e.title,sendTo:null!==(t=e.meta)&&void 0!==t&&t.sendTo?e.meta.sendTo.join(", "):"account",email:G(e,"email"),task:G(e,"task"),sms:G(e,"sms"),notification:G(e,"notification"),toast:G(e,"toast"),slack:G(e,"slack"),whatsapp:G(e,"whatsapp"),actions:"",item:e}}))})})},Ne=n(10973);function $e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$e(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ee=function(e){var t=e.filters,n=e.setFilters,a=(0,O.cI)({defaultValues:t}),s=a.errors,o=a.handleSubmit,i=a.register,l={errors:s,register:i};return(0,M.jsx)(I.Z,{title:"Filters",open:!0,children:(0,M.jsx)(J.Z,{handleSubmit:o((function(e){n((function(t){return Qe(Qe({},t),{},{q:e.query||""})}))})),children:(0,M.jsxs)(U.Z,{children:[(0,M.jsx)(Z.Z,{md:3,children:(0,M.jsx)(Ne.Z,{errors:s,label:"Search",placeholder:"Search...",prependSearchIcon:!0,register:i,type:"search"})}),(0,M.jsx)(Z.Z,{md:3,children:(0,M.jsx)(_.Z,Qe(Qe({},l),{},{name:"type",onChange:function(e){return n((function(t){return Qe(Qe({},t),{},{type:e.target.value||""})}))},options:[{value:"",text:"Type"},{value:"trigger",text:"Triggered Events"},{value:"cron",text:"Cron Events"}]}))})]})})})},Ve=function(e){var t=e.category,n=(0,l.useContext)(g.Z).user,a=(0,l.useState)({q:"",type:""}),s=a[0],o=a[1],i=(0,l.useState)([]),r=i[0],p=i[1],d="admin"===(null===n||void 0===n?void 0:n.accountType)?n.accountId:null,m=(0,u.t)(b,{skip:!d,variables:{adminId:d,category:t},onCompleted:function(e){var n=function(e,t,n){var a=[];return t.filter((function(t){return t.category===e})).forEach((function(e){var t=Y({},e),s=n.find((function(t){return t.name===e.name}));s&&(t=Object.assign(e,s)),a.push(t)})),a}(t,Ae,null===e||void 0===e?void 0:e.items);p(n)}}),y=(0,c.Z)(m,2),f=y[0],T=y[1].refetch;return(0,l.useEffect)((function(){f()}),[]),d?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(Ee,{filters:s,setFilters:o}),(0,M.jsx)(Le,{adminId:d,events:r,filters:s,refetch:T,title:"Events"},t)]}):null},Fe=function(){var e=(0,r.useRouter)().query,t=(0,l.useMemo)((function(){return e.tab||"jobs"}),[e.tab]);return(0,M.jsxs)(p.Z,{children:[(0,M.jsx)("div",{active:"jobs"===t,label:"Jobs",children:(0,M.jsx)(Ve,{category:"bookings"})}),(0,M.jsx)("div",{active:"quotes"===t,label:"Quotes",children:(0,M.jsx)(Ve,{category:"quotes"})}),(0,M.jsx)("div",{active:"planned-maintenance"===t,label:"Planned Maintenance",children:(0,M.jsx)(Ve,{category:"ppm"})}),(0,M.jsx)("div",{active:"assets"===t,label:"Assets",children:(0,M.jsx)(Ve,{category:"assets"})}),(0,M.jsx)("div",{active:"suppliers"===t,label:"Suppliers",children:(0,M.jsx)(Ve,{category:"supplierOnboarding"})}),(0,M.jsx)("div",{active:"customers"===t,label:"Customers",children:(0,M.jsx)(Ve,{category:"customerOnboarding"})}),(0,M.jsx)("div",{active:"tenants"===t,label:"Tenants",children:(0,M.jsx)(Ve,{category:"tenantOnboarding"})}),(0,M.jsx)("div",{active:"accounts"===t,label:"Accounts",children:(0,M.jsx)(Ve,{category:"accounts"})}),(0,M.jsx)("div",{active:"broadcasts"===t,label:"Broadcasts",children:(0,M.jsx)(Ve,{category:"broadcasts"})})]},t)},Re=function(){return(0,M.jsx)(i.Z,{pageHeading:{heading:"Communications"},View:(0,M.jsx)(Fe,{})})}},47685:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/communications",function(){return n(91998)}])}},function(e){e.O(0,[284,4195,5312,2002,3086,7134,3486,4712,8244,9774,2888,179],(function(){return t=47685,e(e.s=t);var t}));var t=e.O();_N_E=t}]);