(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5230,5146,2880,6433],{87160:function(e,n,t){"use strict";t.d(n,{F:function(){return T}});var r,i=t(92809),o=t(83789),a=t(10219),s=t(30266),c=t(64687),u=t.n(c),d=t(67294),l=t(11163),m=t(26075),p=t(52209),f=(0,t(54397).Ps)(r||(r=(0,p.Z)(['\n  query GetEvents($where: Job_bool_exp) {\n    events: Job(where: $where) {\n      id\n      number\n      description\n      end: timingStart\n      scheduledAt\n      siteVisitStart\n      start: timingStart\n      status\n      title\n      shortJobDesc: Taxonomy(where: { Taxonomy: { type: { _eq: "jobTags" } } }) {\n        id\n        taxonomyId\n        comments\n        taxonomy: Taxonomy {\n          name\n        }\n      }\n      supplierQuotes: SupplierQuotes(\n        where: {\n          siteVisitAt: { _is_null: false }\n          status: { _neq: "cancelled" }\n          type: { _eq: "quote" }\n        }\n      ) {\n        siteVisitAt\n        quoteNumber\n      }\n    }\n  }\n']))),v=t(80880),y=t(80284),b=t(78215),h=t(2356),g=t(92700),x=t(90358),j=t(1323),I=t(78586),O=t(12517),_=t(55148),Z=t(39129),A=t(34610),w=t(22796),P=t(18944),S=t(84550),C=t(24237),$=t(85893),q=function(e){var n=e.setTypes,t=e.setSiteVisit,r=e.types,i=function(e,t){n(t?[].concat((0,o.Z)(r),[e]):r.filter((function(n){return n!==e})))};return(0,$.jsxs)(b.Z,{children:[(0,$.jsxs)(D,{md:3,children:[(0,$.jsx)(A.Z,{onToggle:function(e){return i("reactive",e)},size:"sm",toggled:r.includes("reactive")}),(0,$.jsx)(w.Z,{marginLeft:"sm"}),(0,$.jsx)(P.Z,{size:"sm",children:"Reactive"})]}),(0,$.jsxs)(D,{md:3,children:[(0,$.jsx)(A.Z,{onToggle:function(e){return i("ppm",e)},size:"sm",toggled:r.includes("ppm")}),(0,$.jsx)(w.Z,{marginLeft:"sm"}),(0,$.jsx)(P.Z,{size:"sm",children:"PPM"})]}),(0,$.jsxs)(D,{md:3,children:[(0,$.jsx)(A.Z,{onToggle:function(e){return i("quote",e)},size:"sm",toggled:r.includes("quote")}),(0,$.jsx)(w.Z,{marginLeft:"sm"}),(0,$.jsx)(P.Z,{size:"sm",children:"Quote"})]}),(0,$.jsxs)(D,{md:3,children:[(0,$.jsx)(A.Z,{onToggle:function(e){return i("cppm",e)},size:"sm",toggled:r.includes("cppm")}),(0,$.jsx)(w.Z,{marginLeft:"sm"}),(0,$.jsx)(P.Z,{size:"sm",children:"Compliance"})]}),(0,$.jsxs)(w.Z,{marginLeft:"sm",children:[(0,$.jsx)(S.Z,{data:[{label:"Only show site visits",id:"siteVisit",value:"yes"}],name:"siteVisit",onClick:function(e){t(e.target.checked)}}),(0,$.jsx)(w.Z,{})]})]})},D=(0,C.ZP)(h.Z).withConfig({displayName:"filters__StyledColumn",componentId:"sc-3gjja8-0"})(["align-items:center;display:flex;"]),k=["supplierQuotes"];function R(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function E(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?R(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var T=function(e){var n,t,r=e.defaultFilters,i=e.defaultView,c=e.locationId,p=e.showCompliance,A=e.showFilters,w=e.showSiteVisits,P=e.supplierId,S=(0,l.useRouter)().query,C=(0,d.useContext)(v.Z),D=(0,I.q)(),R=null===(n=D.admin.jobSetting)||void 0===n?void 0:n.jobNumberPrefix,T=null===(t=D.admin.jobSetting)||void 0===t?void 0:t.jobNumberSuffix,N=(0,j.x)().user,F=(0,m.x)(),L=!1,U=!1;switch(N.accountType){case"supplier":U=!0;break;case"customer":L=!0}var H=(0,d.useState)(S.type?["".concat(S.type)]:r),M=H[0],G=H[1],V=(0,d.useState)(w),z=V[0],J=V[1],B="scheduled"===S.type?"PPM":"Bookings";(0,d.useEffect)((function(){return S.type?["".concat(S.type)]:G(U?["ppm"]:r)}),[r]);var Q=function(){var e=(0,s.Z)(u().mark((function e(n,t){var r,i,s,d,l;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={type:{_in:M},_or:[{_and:[{timingStart:{_gte:n.start}},{timingStart:{_lte:n.end}}]},{_and:[{scheduledAt:{_gte:n.start}},{scheduledAt:{_lte:n.end}}]},{_and:[{siteVisitStart:{_gte:n.start}},{siteVisitStart:{_lte:n.end}}]}]},U&&(r.supplierId={_eq:N.accountId}),P&&(r.supplierId={_eq:P}),L&&(r.customerId={_eq:N.accountId}),c&&(r.locationId={_eq:c}),(p||c)&&(r.Compliances={complianceId:{_is_null:!1}}),z&&(r.siteVisitStart={_is_null:!1}),e.next=9,F.query({query:f,variables:{where:r}});case 9:i=e.sent,s=i.data,d=(s=void 0===s?{events:[]}:s).events,l=[],d.map((function(e){var n,t=e.supplierQuotes,r=(0,a.Z)(e,k),i=(null===r||void 0===r||null===(n=r.shortJobDesc[0])||void 0===n?void 0:n.taxonomy.name)||r.title;return l=[].concat((0,o.Z)(l),[E(E({},e),{},{title:i})]),t.length>0&&t.map((function(e){return l=[].concat((0,o.Z)(l),[E(E({},r),{},{start:e.siteVisitAt,end:e.siteVisitAt,title:"".concat(i," ").concat(e.quoteNumber),siteVisit:!0})])})),l})),t(l.map((function(e){var n=E({},e);return n.start=n.scheduledAt||n.start,n.end=n.scheduledAt||n.end||n.start,n.color=n.siteVisit?"rgb(182, 79, 200)":(0,x.t)(n.status),n})));case 16:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}();return(0,$.jsxs)(y.Z,{fitParentHeight:!0,open:!0,title:B,children:[A&&(0,$.jsx)(q,{setTypes:G,setSiteVisit:J,types:M}),(0,$.jsx)(g.A,{eventClick:function(e){C.show({content:(0,$.jsx)(O.g,{jobId:parseInt(e.event.id),toggleShow:C.close,numberPrefix:R,numberSuffix:T}),title:"Job details",submit:!1,width:"50%"})},events:Q,initialView:"day"===S.show?"timeGridDay":i}),(0,$.jsx)(b.Z,{children:(0,$.jsx)(h.Z,{md:12,children:(0,$.jsx)(Z.D,{status:_.yW})})})]})};T.defaultProps={dateClick:!1,defaultFilters:["reactive","ppm","quote","cppm"],showFilters:!0,showSiteVisits:!1}},92700:function(e,n,t){"use strict";t.d(n,{A:function(){return o}});var r=t(68794),i=t(85893),o=function(e){var n=e.dateClick,t=e.events,o=e.eventClick,a=e.eventContent,s=(e.hasLoading,e.height),c=e.initialView;return(0,i.jsx)(r.Z,{dateClick:n,eventClick:o,eventContent:a,events:t,hasLoading:!0,height:s,headerToolbar:{start:"prev,next today",center:"title",end:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},initialView:c})};o.defaultProps={initialView:"listWeek",hasLoading:!0,height:550}},39129:function(e,n,t){"use strict";t.d(n,{D:function(){return o}});var r=t(24237),i=t(85893),o=function(e){var n=e.status;return(0,i.jsx)(a,{children:(0,i.jsx)("ul",{children:n.map((function(e,n){return(0,i.jsxs)("li",{children:[(0,i.jsx)("span",{style:{backgroundColor:e.colour}}),e.text]},"legend".concat(n))}))})})},a=r.ZP.div.withConfig({displayName:"legend__StyledContainer",componentId:"sc-1gaw8i-0"})(["ul{list-style:none;float:left;padding-top:15px;}ul li{display:flex;flex-direction:row;align-items:center;float:left;width:120px;font-size:90%;list-style:none;}li span{display:block;float:left;height:12px;width:12px;margin-right:5px;}"])},1032:function(e,n,t){"use strict";t.d(n,{m:function(){return y}});var r,i=t(67294),o=t(93633),a=t(52209),s=(0,t(54397).Ps)(r||(r=(0,a.Z)(["\n  query GetJobsByMonth(\n    $adminId: Int\n    $customerId: Int\n    $endTime: timestamptz\n    $isFixed: Int\n    $isPlanned: Int\n    $locationId: Int\n    $managerId: Int\n    $postCodeAreaId: Int\n    $serviceId: Int\n    $slaId: Int\n    $startTime: timestamptz\n    $supplierId: Int\n  ) {\n    meta: getDashboard_Count_By_Month_aggregate(\n      args: {\n        adminId: $adminId\n        customerId: $customerId\n        endTime: $endTime\n        isFixed: $isFixed\n        isPlanned: $isPlanned\n        locationId: $locationId\n        managerId: $managerId\n        postCodeAreaId: $postCodeAreaId\n        serviceId: $serviceId\n        slaId: $slaId\n        startTime: $startTime\n        supplierId: $supplierId\n      }\n    ) {\n      aggregate {\n        sum {\n          count: count\n        }\n      }\n    }\n    jobsByMonth: getDashboard_Count_By_Month(\n      args: {\n        adminId: $adminId\n        customerId: $customerId\n        endTime: $endTime\n        isFixed: $isFixed\n        isPlanned: $isPlanned\n        locationId: $locationId\n        managerId: $managerId\n        postCodeAreaId: $postCodeAreaId\n        serviceId: $serviceId\n        slaId: $slaId\n        startTime: $startTime\n        supplierId: $supplierId\n      }\n      order_by: { strval_extra: asc }\n    ) {\n      count: count\n      month: strval_extra\n    }\n  }\n"]))),c=t(78840),u=t.n(c),d=t(75708),l=t.n(d),m=t(85726),p=t(5597);function f(e){var n=[];return e.forEach((function(e){try{n.push({name:(0,p.Z)(new Date(e.month),"LLL yyyy"),y:e.count})}catch(t){console.error("seriesData",e,t)}})),n}var v=t(85893),y=(0,i.forwardRef)((function(e,n){var r,i,a=e.filters,c=e.removeChart,d=(0,o.a)(s,{variables:{adminId:a.adminId,customerId:a.customerId,endTime:a.endDate,isFixed:a.isFixed,isPlanned:a.isPlanned,locationId:a.locationId,managerId:a.managerId,postCodeAreaId:a.postCodeAreaId,serviceId:a.serviceId,slaId:a.slaId,startTime:a.startDate,supplierId:a.supplierId}}).data,p=(d=void 0===d?{meta:{},jobsByMonth:[]}:d).meta,y=d.jobsByMonth;return t(18393)(u()),(0,v.jsx)(m.J,{name:"JobsByMonth",removeChart:c,title:"Total bookings by Month (".concat(null===(r=p.aggregate)||void 0===r?void 0:r.sum.count,")"),children:(0,v.jsx)(l(),{callback:function(e){e.reflow()},constructorType:"chart",Highcharts:u(),options:(i=y,{chart:{type:"column"},title:{text:null},xAxis:{type:"category",title:null},yAxis:{min:0,title:{text:"Counts"}},tooltip:{headerFormat:'<span style="font-size:11px">{series.name}</span><br>',pointFormat:"{point.name}</span>: <b>{point.y}</b> "},series:[{name:"Month",data:f(i),showInLegend:!1}]}),ref:n})})}))},66238:function(e,n,t){"use strict";t.d(n,{e:function(){return f}});var r,i=t(67294),o=t(93633),a=t(52209),s=(0,t(54397).Ps)(r||(r=(0,a.Z)(["\n  query GetJobsByStatus(\n    $adminId: Int\n    $customerId: Int\n    $endTime: timestamptz\n    $isFixed: Int\n    $isPlanned: Int\n    $locationId: Int\n    $managerId: Int\n    $postCodeAreaId: Int\n    $serviceId: Int\n    $slaId: Int\n    $startTime: timestamptz\n    $supplierId: Int\n  ) {\n    jobsByStatus: getDashboard_Count_By_Status(\n      args: {\n        adminId: $adminId\n        customerId: $customerId\n        endTime: $endTime\n        isFixed: $isFixed\n        isPlanned: $isPlanned\n        locationId: $locationId\n        managerId: $managerId\n        postCodeAreaId: $postCodeAreaId\n        serviceId: $serviceId\n        slaId: $slaId\n        startTime: $startTime\n        supplierId: $supplierId\n      }\n      order_by: {}\n    ) {\n      statusname: name\n      count: count\n    }\n    meta: getDashboard_Count_By_Status_aggregate(\n      args: {\n        adminId: $adminId\n        customerId: $customerId\n        endTime: $endTime\n        isFixed: $isFixed\n        isPlanned: $isPlanned\n        locationId: $locationId\n        managerId: $managerId\n        postCodeAreaId: $postCodeAreaId\n        serviceId: $serviceId\n        slaId: $slaId\n        startTime: $startTime\n        supplierId: $supplierId\n      }\n      order_by: { count: desc }\n    ) {\n      aggregate {\n        sum {\n          count: count\n        }\n      }\n    }\n  }\n"]))),c=t(78840),u=t.n(c),d=t(75708),l=t.n(d),m=t(85726),p=t(85893),f=(0,i.forwardRef)((function(e,n){var r,i,a=e.filters,c=e.removeChart,d=(0,o.a)(s,{variables:{adminId:a.adminId,customerId:a.customerId,endTime:a.endDate,isFixed:a.isFixed,isPlanned:a.isPlanned,locationId:a.locationId,managerId:a.managerId,postCodeAreaId:a.postCodeAreaId,serviceId:a.serviceId,slaId:a.slaId,startTime:a.startDate,supplierId:a.supplierId}}).data,f=(d=void 0===d?{meta:{},jobsByStatus:[]}:d).meta,v=d.jobsByStatus;return t(18393)(u()),v&&(0,p.jsx)(m.J,{name:"JobsByStatusPieChart",removeChart:c,title:"Total bookings by Status (".concat(null===(r=f.aggregate)||void 0===r?void 0:r.sum.count,")"),children:(0,p.jsx)(l(),{callback:function(e){e.reflow()},constructorType:"chart",Highcharts:u(),options:(i=v,{chart:{type:"pie"},title:{text:null},tooltip:{formatter:function(){return"<b>"+this.x+"</b><br/>"+this.series.name+": "+this.y}},series:[{data:i.map((function(e){return{name:e.statusname,y:e.count}})),showInLegend:!1}],xAxis:{type:"category",title:null},yAxis:{title:null}}),ref:n})})}))},85726:function(e,n,t){"use strict";t.d(n,{J:function(){return c}});var r=t(55657),i=t(77417),o=t(80284),a=t(24237),s=t(85893),c=function(e){var n=e.title,t=e.children,a=e.isTable,c=e.name,d=e.removeChart,l=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.Z,{context:"danger",icon:"trash",prefix:"fa",size:"sm",title:"Delete",onClick:function(e){e.stopPropagation(),d(e,c)}}),(0,s.jsx)(i.Z,{context:"darkGrey",vertical:!0}),(0,s.jsx)(r.Z,{className:"dragHandle",icon:"arrows-alt",prefix:"fa",size:"md",title:"Move",onClick:function(e){return e.stopPropagation()}})]});return(0,s.jsx)(o.Z,{context:"secondary",fitParentHeight:!0,open:!0,title:n,toolbar:l,loading:!0,children:(0,s.jsx)(u,{overflow:a,children:t})})},u=a.ZP.div.withConfig({displayName:"wrapper__StyledChildren",componentId:"sc-cfe7my-0"})(["height:100%;overflow-x:",";"],(function(e){return e.overflow?"hidden":"unset"}))},3213:function(e,n,t){"use strict";t.d(n,{M:function(){return F}});var r=t(80318),i=t(67294),o=t(11163),a=t(93633),s=t(75709),c=t(36732),u=t(11640),d=t(80880),l=t(91126),m=t(14347),p=t(80284),f=t(52002),v=t(48213),y=t(50899),b=t(92809),h=t(42283),g=t(79665),x=t(7739),j=t.n(x),I=t(97202),O=t(65375),_=t(93515),Z=t(71247),A=t(34868),w=t(19501),P=(0,w.Ry)().shape({complianceId:(0,w.Ry)().required(),expiryAt:(0,w.hT)().required(),insuranceAmount:(0,w.Rx)().transform((function(e){return isNaN(e)?null:e})).nullable(),regNum:(0,w.Z_)().required()}),S=t(76800),C=t(23461),$=t(1323),q=t(85893);function D(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function k(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?D(Object(t),!0).forEach((function(n){(0,b.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):D(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var R=function(e){e.complianceType;var n=e.defaultValues,t=e.onSubmit,r=(0,$.x)().user,o=(0,h.cI)({defaultValues:k(k({},n),(null===n||void 0===n?void 0:n.meta)||{}),resolver:(0,g.S)(P)}),s=o.control,u=o.errors,d=o.handleSubmit,l=o.register,m=(0,o.watch)("complianceId",{hasInsuranceAmount:null===n||void 0===n?void 0:n.hasInsuranceAmount,regNumExample:null===n||void 0===n?void 0:n.regNumExample,questions:null===n||void 0===n?void 0:n.questions}),p=m&&m.questions,f=(0,a.a)(c.kU,{variables:{adminId:r.adminId}}),v=f.loading,y=f.data,b=(y=void 0===y?{compliance:[]}:y).compliances,x={control:s,errors:u,register:l};return!v&&(0,q.jsxs)(I.Z,{id:"offCanvasForm",handleSubmit:d(t),children:[(0,q.jsx)(O.Z,{label:"Compliance",children:(0,q.jsx)(_.Z,k(k({},x),{},{name:"complianceId",options:function(){var e=j()(b,(function(e){return e.category.name})),n=[];return Object.keys(e).forEach((function(t){n.push({label:t,options:e[t]})})),n}()}))}),(0,q.jsx)(O.Z,{label:"Registration Number",children:(0,q.jsx)(Z.Z,k(k({},x),{},{name:"regNum",placeholder:m.regNumExample&&"eg ".concat(m.regNumExample)}))}),(0,q.jsx)(O.Z,{label:"Expiry"}),(0,q.jsx)(S.M,k(k({},x),{},{name:"expiryAt",placeholderText:"Click to select date"})),m.hasInsuranceAmount&&(0,q.jsx)(O.Z,{label:"Insurance Amount",children:(0,q.jsx)(A.Z,k(k({},x),{},{name:"insuranceAmount"}))}),null===p||void 0===p?void 0:p.map((function(e){var n,t,r,o;return(0,i.createElement)(C.f,k(k({},x),{},{input:null===(n=e.meta)||void 0===n?void 0:n.input,inputType:null===(t=e.meta)||void 0===t?void 0:t.inputType,key:e.id,label:null===(r=e.meta)||void 0===r?void 0:r.label,name:e.name,options:null===(o=e.meta)||void 0===o?void 0:o.options}))})),(null===n||void 0===n?void 0:n.id)&&(0,q.jsx)(Z.Z,k(k({},x),{},{name:"id",type:"hidden"}))]})},E=t(7304),T=new Date,N=(0,u.Z)(T,1),F=function(e){var n,t=e.entity,u=e.entityId,b=(0,o.useRouter)().query,h=(0,i.useContext)(d.Z),g=(0,a.a)(c.Au,{variables:{entity:t,entityId:u}}),x=g.loading,j=g.data,I=(j=void 0===j?{job:null}:j).compliances,O=g.refetch,_=(0,s.D)(c.FD,{onCompleted:function(e){h.close(),O()}}),Z=(0,r.Z)(_,1)[0],A=(0,s.D)(c.YW,{onCompleted:function(e){h.close(),O()}}),w=(0,r.Z)(A,1)[0],P=(0,s.D)(c.tC,{onCompleted:function(e){O()}}),S=(0,r.Z)(P,1)[0],C=function(e){var n=function(e){var n=e.entity,t=e.entityId,r=e.form,i={complianceId:r.complianceId.value,entityId:t,entity:n,expiryAt:r.expiryAt,insuranceAmount:r.insuranceAmount,regNum:r.regNum};return delete r.complianceId,delete r.expiryAt,delete r.insuranceAmount,delete r.regNum,i.meta=r,i}({entity:t,entityId:u,form:e});e.id?w({variables:{id:e.id,changes:n}}):Z({variables:{objects:n}})},$=function(e){var n=e.e,r=e.row;n.stopPropagation();var i="Account"===t?null:"regulatory";h.show({content:(0,q.jsx)(R,{complianceType:i,defaultValues:r,onSubmit:C}),title:"Compliance"})},D=[{hidden:!0},{hidden:!0},{text:"Name"},{text:"Registration number"},{formatter:v.FT,text:"Expiry date"},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{formatter:l.Z,formatterData:(n={editClick:function(e,n){return $({e:e,row:n})},mediaClick:function(e,n){return function(e){var n=e.row;h.show({content:(0,q.jsx)(y.G,{entity:"Compliance_Entity",entityId:null===n||void 0===n?void 0:n.id}),submit:!1,title:"Media"})}({row:n})},deleteClick:function(e,n){return function(e){var n=e.row;S({variables:{id:n.id}})}({row:n})}},[{context:"secondary",icon:["fas","edit"],onClick:n.editClick,tooltip:"Edit"},{context:"info",icon:["fas","file-upload"],onClick:n.mediaClick,tooltip:"Media"},{context:"danger",icon:["fas","trash"],onClick:n.deleteClick,tooltip:"Delete"}]),text:"Actions"}],k=(0,q.jsx)(m.Z,{content:"Add Compliance",context:"secondary",onClick:function(e){return $({e:e})},size:"sm"});return!x&&(0,q.jsxs)(p.Z,{open:!0,title:"Compliances",toolbar:k,children:["Location"===t&&(0,q.jsx)(E.p,{locationId:u}),(0,q.jsx)(f.Z,{columns:D,rows:function(){var e=I;return b.overdue&&(e=I.filter((function(e){return new Date(e.expiryAt)<T}))),b.upcoming&&(e=I.filter((function(e){return new Date(e.expiryAt)>T&&new Date(e.expiryAt)<N}))),e.map((function(e){return{id:e.id,complianceId:{label:e.compliance.name,value:e.compliance.id,hasInsuranceAmount:e.compliance.hasInsuranceAmount,insuranceAmount:e.insuranceAmount,questions:e.compliance.questions,regNumExample:e.compliance.regNumExample},name:e.compliance.name,regNum:e.regNum,expiry:e.expiryAt,expiryAt:e.expiryAt?new Date(e.expiryAt):"",insuranceAmount:e.insuranceAmount,hasInsuranceAmount:e.compliance.hasInsuranceAmount,regNumExample:e.compliance.regNumExample,meta:e.meta,actions:""}}))}()})]})}},46958:function(e,n,t){"use strict";t.d(n,{sM:function(){return d},NK:function(){return l},NG:function(){return m},OW:function(){return p}});var r,i,o,a,s,c=t(52209),u=t(54397),d=(0,u.Ps)(r||(r=(0,c.Z)(["\n  query GetPostcodeAreas(\n    $countryId: Int\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: PostcodeArea_order_by!\n  ) {\n    postcodeAreas: PostcodeArea(\n      limit: $limit\n      offset: $offset\n      where: { countryId: { _eq: $countryId }, name: { _ilike: $q } }\n      order_by: [$orderBy]\n    ) {\n      id\n      area\n      name\n      status\n      country: Country {\n        id\n        name\n        code\n      }\n    }\n    meta: PostcodeArea_aggregate(where: { countryId: { _eq: $countryId }, name: { _ilike: $q } }) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]))),l=(0,u.Ps)(i||(i=(0,c.Z)(["\n  query GetPostcodeArea($id: Int!) {\n    postcodeArea: PostcodeArea_by_pk(id: $id) {\n      id\n      area\n      name\n      status\n      country: Country {\n        id\n        name\n        code\n      }\n    }\n  }\n"]))),m=((0,u.Ps)(o||(o=(0,c.Z)(["\n  mutation AddPostcodeArea($areas: [PostcodeArea_insert_input!]!) {\n    insert_PostcodeArea(objects: $areas) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),(0,u.Ps)(a||(a=(0,c.Z)(["\n  mutation InsertPostCodeArea($objects: [PostcodeArea_Entity_insert_input!]!) {\n    insert_PostcodeArea_Entity(\n      objects: $objects\n      on_conflict: {\n        constraint: PostcodeArea_Entity_postcodeAreaId_entityId_key\n        update_columns: status\n      }\n    ) {\n      returning {\n        id\n        status\n      }\n    }\n  }\n"])))),p=(0,u.Ps)(s||(s=(0,c.Z)(["\n  mutation UpdateEntityAssign($id: Int!, $changes: PostcodeArea_Entity_set_input) {\n    update_PostcodeArea_Entity_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n      status\n    }\n  }\n"])))},14399:function(e,n,t){"use strict";t.d(n,{cz:function(){return O},qd:function(){return _},nD:function(){return Z},UH:function(){return A},SW:function(){return w},Qn:function(){return P},he:function(){return S},j$:function(){return C},_d:function(){return $},kx:function(){return q},t1:function(){return D},by:function(){return k},yR:function(){return R},RJ:function(){return E},Cj:function(){return T},Ve:function(){return N},kU:function(){return F},kB:function(){return L}});var r,i,o,a,s,c,u,d,l,m,p,f,v,y,b,h,g,x,j=t(52209),I=t(54397),O=(0,I.Ps)(r||(r=(0,j.Z)(["\n  query GetAddressForSelect($q: String, $entity: String!, $entityId: Int!) {\n    items: Address(\n      where: {\n        Address_Entities: { entity: { _eq: $entity }, entityId: { _eq: $entityId } }\n        _or: [\n          { addressLine1: { _eq: $q } }\n          { addressLine2: { _eq: $q } }\n          { addressLine3: { _eq: $q } }\n          { county: { _eq: $q } }\n          { postCode: { _eq: $q } }\n          { city: { _eq: $q } }\n        ]\n      }\n    ) {\n      label: addressLine1\n      value: id\n      id\n      name\n      addressLine1\n      addressLine2\n      addressLine3\n      postCode\n      county\n      country: Country {\n        name\n      }\n      city\n      Address_Entities {\n        invoice\n      }\n    }\n  }\n"]))),_=(0,I.Ps)(i||(i=(0,j.Z)(["\n  query GetAccountsForSelect($q: String) {\n    items: Account(where: { name: { _ilike: $q } }, order_by: { name: asc }) {\n      label: name\n      value: id\n    }\n  }\n"]))),Z=(0,I.Ps)(o||(o=(0,j.Z)(['\n  query GetTaxonomy($q: String, $id: Int) {\n    items: Taxonomy(\n      where: { type: { _eq: "assetCategory" }, status: { _eq: "active" } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      options: Taxonomies(\n        where: {\n          type: { _eq: "assetCategory" }\n          name: { _ilike: $q }\n          id: { _eq: $id }\n          status: { _eq: "active" }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']))),A=(0,I.Ps)(a||(a=(0,j.Z)(["\n  query GetAssetsForSelect($locationId: Int, $q: String, $categoryId: Int, $bookable: String) {\n    items: Asset(\n      where: {\n        categoryId: { _eq: $categoryId }\n        locationId: { _eq: $locationId }\n        name: { _ilike: $q }\n        bookable: { _eq: $bookable }\n      }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n      parent: ParentAsset {\n        id\n        name\n      }\n      media: Media {\n        id\n        item: Medium {\n          id\n          name\n          filename\n          meta\n          category\n          type\n        }\n      }\n    }\n  }\n"]))),w=(0,I.Ps)(s||(s=(0,j.Z)(['\n  query GetCustomersForSelect($q: String) {\n    items: Account(\n      where: { name: { _ilike: $q }, type: { _eq: "customer" } }\n      order_by: { name: asc }\n    ) {\n      admin: Admins {\n        id: adminId\n      }\n      label: name\n      spendThreshold: meta(path: "$.finance.spendThreshold")\n      serviceRateLabour: meta(path: "$.finance.serviceRateLabour")\n      serviceRateExpenses: meta(path: "$.finance.serviceRateExpenses")\n      value: id\n    }\n  }\n']))),P=(0,I.Ps)(c||(c=(0,j.Z)(["\n  query GetJobsForSelect($_q: Int, $locationId: Int) {\n    items: Job(\n      where: {\n        Location: { id: { _eq: $locationId } }\n        _or: [{ id: { _eq: $_q } }, { Invoices: { id: { _eq: $_q } } }]\n      }\n      order_by: { title: asc }\n    ) {\n      label: label\n      value: id\n      number\n      createdAt\n      description\n      status\n      timingStart\n      title\n      type\n      Location {\n        name\n      }\n      Taxonomy {\n        Taxonomy {\n          shortJobDescription: name\n        }\n      }\n    }\n  }\n"]))),S=(0,I.Ps)(u||(u=(0,j.Z)(['\n  query GetManagersForSelect($accountId: Int!, $q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          role: { _in: ["owner", "manager"] }\n          status: { _eq: "active" }\n          Account: { id: { _eq: $accountId } }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']))),C=(0,I.Ps)(d||(d=(0,j.Z)(["\n  query GetPostCodeAreaForSelect($countryId: Int, $q: String) {\n    items: PostcodeArea(\n      where: { name: { _ilike: $q }, countryId: { _eq: $countryId } }\n      order_by: { name: asc }\n    ) {\n      area\n      label: name\n      value: id\n    }\n  }\n"]))),$=(0,I.Ps)(l||(l=(0,j.Z)(["\n  query GetPropertiesForSelect($where: Location_bool_exp) {\n    items: Location(where: $where, order_by: { name: asc }) {\n      label: name\n      value: id\n      access\n      registeredAddress: Addresses(where: { registered: { _eq: true } }) {\n        address: Address {\n          id\n          addressLine1\n          addressLine2\n          addressLine3\n          county\n          country: Country {\n            name\n          }\n          postCode\n          city\n        }\n      }\n    }\n  }\n"]))),q=(0,I.Ps)(m||(m=(0,j.Z)(['\n  query GetServicesForSelect($q: String) {\n    items: Service(\n      where: { name: { _ilike: $q }, status: { _eq: "active" } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n']))),D=(0,I.Ps)(p||(p=(0,j.Z)(["\n  query GetSlasForSelect($q: String, $adminId: Int, $type: String) {\n    items: SLA(\n      where: { name: { _ilike: $q }, type: { _eq: $type }, adminId: { _eq: $adminId } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]))),k=(0,I.Ps)(f||(f=(0,j.Z)(["\n  query GetSuppliersForSelect($where: Account_bool_exp) {\n    items: Account(where: $where, order_by: { name: asc }) {\n      label: name\n      value: id\n    }\n  }\n"]))),R=(0,I.Ps)(v||(v=(0,j.Z)(['\n  query GetUsersForSelect($accountId: Int, $q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          accountId: { _eq: $accountId }\n          isContact: { _eq: true }\n          status: { _eq: "active" }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']))),E=(0,I.Ps)(y||(y=(0,j.Z)(['\n  query GetUsersForSelect($q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']))),T=(0,I.Ps)(b||(b=(0,j.Z)(["\n  query GetTaxonomyGroupForSelect($q: String, $type: String!) {\n    items: Taxonomy(\n      where: { isGroup: { _eq: true }, name: { _ilike: $q }, type: { _eq: $type } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]))),N=(0,I.Ps)(h||(h=(0,j.Z)(['\n  query GetTaxonomy($q: String) {\n    items: Taxonomy(where: { type: { _eq: "expenseCategoryGroup" } }, order_by: { name: asc }) {\n      label: name\n      options: Taxonomies(\n        where: { type: { _eq: "expenseCategory" }, name: { _ilike: $q } }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']))),F=(0,I.Ps)(g||(g=(0,j.Z)(['\n  query GetCompliancesForSelect($q: String, $locationId: Int) {\n    items: Taxonomy(where: { type: { _eq: "complianceCategory" } }, order_by: { name: asc }) {\n      label: name\n      options: Compliances(\n        where: {\n          name: { _ilike: $q }\n          Compliance_Entities: { Location: { id: { _eq: $locationId } } }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']))),L=(0,I.Ps)(x||(x=(0,j.Z)(["\n  query GetUserRole($userId: Int!, $accountId: Int!) {\n    accountUsers: Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n    ) {\n      role\n    }\n  }\n"])))},95146:function(e,n,t){"use strict";t.d(n,{P:function(){return Z}});var r=t(92809),i=t(30266),o=t(10219),a=t(64687),s=t.n(a),c=t(67294),u=t(24237),d=t(26075),l=t(14399),m=t(80880),p=t(42593),f=t(65375),v=t(78215),y=t(2356),b=t(93515),h=t(14347),g=t(85893),x=["AddForm","accountId","area","assetCategoryId","control","entity","entityId","errors","id","isClearable","isDisabled","label","locationId","name","serviceId","taxonomyGroupType","customerId","customerRole","type","userId"];function j(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function I(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?j(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):j(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var O=function(e,n){var t,r,i=!0;return(null===(t=e.errors[e.name])||void 0===t?void 0:t.message)!==(null===(r=n.errors[n.name])||void 0===r?void 0:r.message)&&(i=!1),["accountId","assetCategoryId","entity","entityId","locationId","serviceId","type","value","customerId","customerRole"].forEach((function(t){e[t]!==n[t]&&(i=!1)})),i},_=function(e){var n=e.accountId,t=e.area,r=e.assetCategoryId,i=e.entity,o=e.entityId,a=(e.hasRole,e.id),s=e.locationId,c=e.serviceId,u=e.taxonomyGroupType,d=e.customerId,m=e.customerRole,p=e.type,f=e.userId,v=p;switch(m&&(v="".concat(p,"_").concat(m)),v){case"address":return{query:l.cz,variables:{entity:i,entityId:o}};case"asset":return{query:l.UH,variables:{categoryId:r,locationId:s}};case"assetBookable":return{query:l.UH,variables:{categoryId:r,locationId:s,bookable:"yes"}};case"assetCategory":return{query:l.nD,variables:{id:a}};case"compliance":return{query:l.kU,variables:{locationId:s}};case"coverage":return{query:l.j$};case"customer":return{query:l.SW};case"job":return{query:l.Qn,variables:{locationId:s}};case"manager":return{query:l.he,variables:{accountId:n}};case"product":return{query:l.UH,variables:{category:"product",locationId:s}};case"property":return{query:l._d,variables:{where:{status:{_eq:"active"},Account_Locations:{accountId:{_eq:n}}}}};case"property_user":return{query:l._d,variables:{where:{status:{_eq:"active"},Account_Locations:{accountId:{_eq:n},Account:{type:{_eq:"customer"},Account_Users:{role:{_eq:"user"},userId:{_eq:d}}},User_Account_Locations:{Account_User:{userId:{_eq:d},accountId:{_eq:n}}}}}}};case"sensor":return{query:l.UH,variables:{category:"sensor",locationId:s}};case"service":return{query:l.kx};case"sla":return{query:l.t1,variables:{type:"priority",adminId:n}};case"sublocation":return{query:l.UH,variables:{category:"sublocation",adminId:n,locationId:s}};case"supplier":var y={type:{_eq:"supplier"}};return t&&(y.PostcodeAreas={PostcodeArea:{area:{_eq:t}},status:{_eq:"active"}}),c&&(y.Services={serviceId:{_eq:c},status:{_eq:"active"}}),{query:l.by,variables:{where:y}};case"user":return{query:l.yR,variables:{accountId:n}};case"usersForBookings":return{query:l.yR,variables:{accountId:f}};case"tenant":return{query:l.RJ};case"taxonomyGroup":return{query:l.Cj,variables:{type:u}};case"expenseCategory":return{query:l.Ve};default:return{query:l.qd}}},Z=(0,c.memo)((function(e){var n=e.AddForm,t=e.accountId,r=e.area,a=e.assetCategoryId,u=e.control,l=e.entity,j=e.entityId,O=e.errors,Z=e.id,w=e.isClearable,P=e.isDisabled,S=e.label,C=e.locationId,$=e.name,q=e.serviceId,D=e.taxonomyGroupType,k=e.customerId,R=e.customerRole,E=e.type,T=e.userId,N=(0,o.Z)(e,x),F=(0,d.x)(),L=(0,c.useState)(!1),U=L[0],H=L[1],M=(0,c.useState)(),G=M[0],V=M[1],z=(0,c.useState)(!1),J=z[0],B=z[1],Q=(0,c.useContext)(m.Z),W=(0,c.useContext)(p.Z).hasRole,Y=(0,c.useState)(!1),X=Y[0],K=Y[1];(0,c.useEffect)((function(){return K(!1),B(!1),function(){}}),[t,a,l,j,C,q,E,k,R,T]);var ee=function(){var e=(0,i.Z)(s().mark((function e(){var n,i,o,c,u,d,m;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!J){e.next=3;break}return K(!0),e.abrupt("return",null);case 3:return H(!0),n=_({accountId:t,area:r,assetCategoryId:a,entity:l,entityId:j,hasRole:W,id:Z,locationId:C,serviceId:q,taxonomyGroupType:D,customerId:k,customerRole:R,type:E,userId:T}),i=n.query,o=n.variables,c=void 0===o?{}:o,e.next=7,F.query({query:i,variables:I({},c)});case 7:u=e.sent,d=u.data,m=(d=void 0===d?{items:[]}:d).items,V(m),H(!1),B(!0),K(!0);case 15:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,g.jsx)(f.Z,{id:$,label:S,children:(0,g.jsxs)(v.Z,{children:[(0,g.jsx)(y.Z,{md:n?11:12,children:(0,g.jsx)(b.Z,I({autoload:!1,blurInputOnSelect:!0,cacheOptions:!0,control:u,errors:O,isDisabled:P,isClearable:w,isLoading:U,menuIsOpen:X,options:G,onFocus:ee,onBlur:function(){K(!1)},name:$,searchable:!0},N),N.defaultValue)}),n&&(0,g.jsx)(y.Z,{md:1,children:(0,g.jsx)(A,{children:(0,g.jsx)(h.Z,{content:null,startIcon:"plus",size:"sm",onClick:function(){Q.show({content:(0,g.jsx)("div",{children:(0,g.jsx)(n,{})}),title:"Add form"})}})})})]})})}),O),A=u.ZP.div.withConfig({displayName:"select__ButtonWrapper",componentId:"sc-v7qj9m-0"})(["position:relative;right:25px;top:2px;"]);Z.defaultProps={isClearable:!0,label:"Account",name:"account",type:"account"}},2880:function(e,n,t){"use strict";t.d(n,{ys:function(){return f},l1:function(){return v},R7:function(){return y},KQ:function(){return b},D7:function(){return h},lk:function(){return g},G5:function(){return x}});var r,i,o,a,s,c,u,d,l,m=t(52209),p=t(54397),f=(0,p.Ps)(r||(r=(0,m.Z)(['\n  query GetSuppliers(\n    $limit: Int\n    $offset: Int\n    $orderBy: Account_order_by!\n    $where: Account_bool_exp\n  ) {\n    suppliers: Account(limit: $limit, offset: $offset, where: $where, order_by: [$orderBy]) {\n      id\n      createdAt\n      name\n      status\n      companyNumber\n      vatId\n      website\n      jobs: SupplierJobs_aggregate {\n        aggregate {\n          count\n          max {\n            scheduledAt\n          }\n          sum {\n            amount\n          }\n        }\n      }\n      jobList: SupplierJobs(order_by: { createdAt: desc }) {\n        id\n      }\n      services: Services(where: { entity: { _eq: "Account" } }) {\n        id\n        service: Service {\n          id\n          name\n        }\n      }\n      addresses: Addresses(where: { entity: { _eq: "Account" } }) {\n        id\n        registered\n        operating\n        trading\n        invoice\n        status\n        createdAt\n        address: Address {\n          id\n          name\n          addressLine1\n          addressLine2\n          addressLine3\n          city\n          county\n          geo\n          postCode\n          country: Country {\n            id\n            name\n          }\n        }\n      }\n      locations: Account_Locations {\n        id\n      }\n      manager: Manager {\n        id\n        nameFirst\n        nameLast\n      }\n      contactUsers: Account_Users(where: { isContact: { _eq: true } }) {\n        id\n        role\n        position\n        isContact\n        lastSignInAt\n        userId\n        user: User {\n          id\n          name: nameFirst\n          nameFirst\n          nameLast\n          phone\n          status\n          email\n          createdAt\n          fullName\n          accounts: Account_Users {\n            id\n            role\n            position\n            isContact\n            status\n            account: Account {\n              id\n              name\n              type\n            }\n          }\n        }\n      }\n    }\n    meta: Account_aggregate(where: $where) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),v=(0,p.Ps)(i||(i=(0,m.Z)(['\n  query GetSupplier($id: Int!) {\n    supplier: Account_by_pk(id: $id) {\n      id\n      companyNumber\n      createdAt\n      name\n      status\n      type\n      updatedAt\n      website\n      clientType\n      managerId\n      vatId\n      meta\n      statusLogs: StatusLog(where: { entity: { _eq: "Account" } }) {\n        id\n        status\n        createdAt\n      }\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      manager: Manager {\n        id\n        fullName\n      }\n      accountEntries: AccountEntries {\n        amount\n        balance\n        createdAt\n        entryId\n        outstandingAmount\n        type\n        currency: Currency {\n          id\n          iso\n          name\n          symbol\n        }\n      }\n      addresses: Addresses(where: { entity: { _eq: "Account" } }) {\n        id\n        registered\n        operating\n        trading\n        invoice\n        status\n        createdAt\n        address: Address {\n          id\n          name\n          addressLine1\n          addressLine2\n          addressLine3\n          city\n          county\n          geo\n          postCode\n          country: Country {\n            id\n            name\n          }\n        }\n      }\n      bookings: SupplierJobs {\n        id\n        title\n        createdAt\n        customerId\n        amount\n        locationId\n        managerId\n        quoteNumber\n        reference\n        status\n        serviceId\n        meta\n        admin: Admin {\n          id\n          name\n        }\n        customer: Customer {\n          id\n          name\n        }\n        location: Location {\n          id\n          name\n          addresses: Addresses(where: { entity: { _eq: "Location" } }) {\n            id\n            registered\n            operating\n            trading\n            invoice\n            status\n            createdAt\n            address: Address {\n              id\n              name\n              addressLine1\n              addressLine2\n              addressLine3\n              city\n              county\n              geo\n              postCode\n              country: Country {\n                id\n                name\n              }\n            }\n          }\n        }\n        manager: Manager {\n          id\n          nameFirst\n          nameLast\n        }\n        sla: SLA {\n          id\n          name\n          notes\n        }\n        supplier: Supplier {\n          id\n          companyNumber\n          createdAt\n          name\n          status\n          type\n          updatedAt\n          website\n          clientType\n          managerId\n          vatId\n          meta\n          media: Media {\n            id\n            medium: Medium {\n              id\n              category\n              filename\n              meta\n              type\n            }\n          }\n          manager: Manager {\n            id\n            fullName\n          }\n        }\n        supplierOffers: SupplierOffers {\n          status\n          rate\n          supplier: Supplier {\n            id\n            companyNumber\n            createdAt\n            name\n            status\n            type\n            updatedAt\n            website\n            clientType\n            managerId\n            vatId\n            meta\n            media: Media {\n              id\n              medium: Medium {\n                id\n                category\n                filename\n                meta\n                type\n              }\n            }\n            manager: Manager {\n              id\n              fullName\n            }\n          }\n        }\n        timings: JobTimings {\n          id\n          status\n          createdAt\n        }\n      }\n      details: SupplierDetail {\n        cisRegistered\n        quotingEmail\n        typeOfOrganisation\n        utrNumber\n        accountId\n      }\n      finance: Financial {\n        id\n        amountOutstanding\n        approvalThreshold\n        arrangementFee\n        createdAt\n        creditLimit\n        creditRating\n        defaultPaymentMethod\n        invoicing\n        serviceRate\n        spendThreshold\n        stripeId\n        totalRevenue\n        unpaidInvoices\n      }\n      locations: Account_Locations {\n        location: Location {\n          id\n          access\n          createdAt\n          name\n          contactUserId\n        }\n      }\n      manager: Manager {\n        id\n        name: nameFirst\n        nameFirst\n        nameLast\n        phone\n        status\n        email\n        createdAt\n        fullName\n        accounts: Account_Users {\n          id\n          role\n          position\n          isContact\n          status\n          account: Account {\n            id\n            name\n            type\n          }\n        }\n      }\n      contactUsers: Account_Users(where: { isContact: { _eq: true } }) {\n        role\n        position\n        isContact\n        lastSignInAt\n        userId\n        user: User {\n          id\n          name: nameFirst\n          nameFirst\n          nameLast\n          phone\n          status\n          email\n          createdAt\n          fullName\n          accounts: Account_Users {\n            id\n            role\n            position\n            isContact\n            status\n            account: Account {\n              id\n              name\n              type\n            }\n          }\n        }\n      }\n      usersMeta: Account_Users_aggregate {\n        aggregate {\n          count\n        }\n      }\n      quotes: SupplierQuotes {\n        id\n        createdAt\n        jobId\n        methodStatement\n        notes\n        quoteNumber\n        startDate\n        rebate\n        status\n        totalDuration\n        totalDurationUnit\n        meta\n        updatedAt\n        lineItems: SupplierQuoteLineItems {\n          id\n          description\n          item\n          qty\n          qtyUnit\n          quoteId\n          supplierTotal\n          total\n          type\n          unitRate\n        }\n      }\n      compliances: Compliances(where: { entity: { _eq: "Account" } }, order_by: { expiryAt: asc }) {\n        id\n        createdAt\n        entity\n        entityId\n        expiryAt\n        regNum\n        insuranceAmount\n        meta\n        compliance: Compliance {\n          id\n          type\n          name\n          status\n          hasInsuranceAmount\n          regNumExample\n          questions: Taxonomies(where: { entity: { _eq: "Compliance" } }) {\n            id\n            name\n            meta\n          }\n        }\n      }\n      coverage: PostcodeAreas(where: { status: { _eq: "active" } }) {\n        id\n        status\n        createdAt\n        area: PostcodeArea {\n          id\n          name\n          area\n        }\n      }\n      services: Services {\n        serviceId\n        createdAt\n      }\n      references: References {\n        id\n        createdAt\n      }\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n    }\n  }\n']))),y=(0,p.Ps)(o||(o=(0,m.Z)(["\n  query GetSupplierManage($id: Int!) {\n    supplier: Account_by_pk(id: $id) {\n      id\n      name\n      website\n      companyNumber\n      vatId\n      status\n      managerSelected: Manager {\n        id\n        label: fullName\n        value: id\n      }\n      supplierDetails: SupplierDetail {\n        id\n        cisRegistered\n        quotingEmail\n        typeOfOrganisation\n        utrNumber\n      }\n    }\n  }\n"]))),b=(0,p.Ps)(a||(a=(0,m.Z)(["\n  mutation AddSupplier($objects: [Account_insert_input!]!) {\n    insert_Account(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),h=((0,p.Ps)(s||(s=(0,m.Z)(["\n  mutation AddSupplierDetail($objects: [SupplierDetail_insert_input!]!) {\n    insert_SupplierDetail(objects: $objects) {\n      returning {\n        id\n        accountId\n      }\n    }\n  }\n"]))),(0,p.Ps)(c||(c=(0,m.Z)(["\n  mutation AddSupplierOffer($objects: [SupplierOffer_insert_input!]!) {\n    insert_SupplierOffer(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),(0,p.Ps)(u||(u=(0,m.Z)(["\n  mutation UpdateSupplier(\n    $supplierId: Int!\n    $supplier: Account_set_input\n    $supplierDetails: SupplierDetail_set_input\n  ) {\n    update_SupplierDetail(where: { accountId: { _eq: $supplierId } }, _set: $supplierDetails) {\n      returning {\n        id\n      }\n    }\n\n    update_Account_by_pk(pk_columns: { id: $supplierId }, _set: $supplier) {\n      id\n    }\n  }\n"])))),g=(0,p.Ps)(d||(d=(0,m.Z)(['\n  query GetPostCodeAreas(\n    $limit: Int\n    $offset: Int\n    $q: String\n    $supplierId: Int\n    $status: String = "active"\n  ) {\n    coverage: PostcodeArea_Entity(\n      where: {\n        entity: { _eq: "Account" }\n        entityId: { _eq: $supplierId }\n        status: { _eq: $status }\n        PostcodeArea: { name: { _ilike: $q } }\n      }\n      order_by: { PostcodeArea: { name: asc } }\n      limit: $limit\n      offset: $offset\n    ) {\n      id\n      status\n      createdAt\n      area: PostcodeArea {\n        id\n        name\n        area\n      }\n    }\n    meta: PostcodeArea_Entity_aggregate(\n      where: {\n        entity: { _eq: "Account" }\n        entityId: { _eq: $supplierId }\n        status: { _eq: $status }\n        PostcodeArea: { name: { _ilike: $q } }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),x=(0,p.Ps)(l||(l=(0,m.Z)(["\n  query GetFinancialJob(\n    $adminId: Int\n    $customerId: Int\n    $startDate: timestamptz\n    $endDate: timestamptz\n    $limit: Int\n    $managerId: Int\n    $locationId: Int\n    $offset: Int\n    $supplierId: Int\n    $status: [String!]\n    $q: String\n    $type: [String!]\n    $jobNumber: String\n    $invoiceNumber: jsonb\n    $orderBy: job_financial_order_by!\n    $userId: Int\n  ) {\n    jobs: getDashboard_Job_Financial(\n      limit: $limit\n      offset: $offset\n      args: {\n        adminId: $adminId\n        managerId: $managerId\n        customerId: $customerId\n        locationId: $locationId\n        supplierId: $supplierId\n        startTime: $startDate\n        endTime: $endDate\n      }\n      where: {\n        _and: [\n          {\n            _or: [\n              { _and: [{ timingStart: { _gte: $startDate } }, { timingStart: { _lte: $endDate } }] }\n              { _and: [{ scheduledat: { _gte: $startDate } }, { scheduledat: { _lte: $endDate } }] }\n            ]\n          }\n          {\n            _or: [\n              { job_number: { _eq: $jobNumber } }\n              { job_invoicenumber: { _contains: $invoiceNumber } }\n            ]\n          }\n        ]\n        Job: { supplierUserId: { _eq: $userId } }\n        status: { _in: $status }\n        job_type: { _in: $type }\n      }\n      order_by: [$orderBy]\n    ) {\n      customerName: customer_name\n      customerId: customer_id\n      expensesAmountCustomer: job_expenses_customer\n      expensesAmountSupplier: job_expenses_supplier\n      invoiceDate: job_date\n      invoiceNumber: job_invoicenumber\n      jobId: job_id\n      jobNumber: job_number\n      jobStatus: job_status\n      jobTotal: customer_amount\n      jobType: job_type\n      payDate: pay_date\n      priorityId: sla_id\n      revenue: job_revenue\n      service: service_name\n      serviceLine: service_name\n      serviceName: service_name\n      supplierAmount: supplier_amount\n      supplierId: supplier_id\n      supplierName: supplier_name\n      job: Job {\n        description\n        supplierUserId\n        location: Location {\n          name\n        }\n        sla: SLA {\n          name\n        }\n        manager: Manager {\n          fullName\n          nameLast\n          nameFirst\n          id\n        }\n        supplierUser: SupplierUser {\n          id\n          fullName\n          accounts: Account_Users {\n            id\n            role\n            position\n            isContact\n            status\n            account: Account {\n              id\n              name\n              type\n              __typename\n            }\n            __typename\n          }\n          __typename\n        }\n        supplier: Supplier {\n          id\n          contactUsers: Account_Users {\n            role\n            userId\n            user: User {\n              id\n              fullName\n              accounts: Account_Users {\n                id\n                role\n                position\n                isContact\n                status\n                account: Account {\n                  id\n                  name\n                  type\n                  __typename\n                }\n                __typename\n              }\n              __typename\n            }\n            __typename\n          }\n\n          __typename\n        }\n      }\n      scheduledat\n      timingStart\n      status\n      createdAt\n    }\n    meta: getDashboard_Job_Financial_aggregate(\n      args: {\n        adminId: $adminId\n        managerId: $managerId\n        customerId: $customerId\n        locationId: $locationId\n        supplierId: $supplierId\n        startTime: $startDate\n        endTime: $endDate\n      }\n      where: {\n        _and: [\n          {\n            _or: [\n              { _and: [{ timingStart: { _gte: $startDate } }, { timingStart: { _lte: $endDate } }] }\n              { _and: [{ scheduledat: { _gte: $startDate } }, { scheduledat: { _lte: $endDate } }] }\n            ]\n          }\n          {\n            _or: [\n              { job_number: { _eq: $jobNumber } }\n              { job_invoicenumber: { _contains: $invoiceNumber } }\n            ]\n          }\n        ]\n        Job: { supplierUserId: { _eq: $userId } }\n        status: { _in: $status }\n        job_type: { _in: $type }\n      }\n      order_by: [$orderBy]\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"])))},74369:function(e,n,t){"use strict";t.d(n,{T:function(){return s}});var r=t(80284),i=t(93443),o=t(18254),a=t(85893),s=function(e){var n,t,s=e.open,c=e.supplier,u="";return o.E.forEach((function(e){var n;e.value===(null===(n=c.details)||void 0===n?void 0:n.typeOfOrganisation)&&(u=e.text)})),(0,a.jsxs)(r.Z,{open:s,title:"Company",children:[(0,a.jsx)(i.Z,{content:"Organization Type",text:u}),(0,a.jsx)(i.Z,{content:"Company Number",text:c.companyNumber}),(0,a.jsx)(i.Z,{content:"VAT Number",text:c.vatId}),(0,a.jsx)(i.Z,{content:"UTR Number",text:null===(n=c.details)||void 0===n?void 0:n.utrNumber}),(0,a.jsx)(i.Z,{content:"CIS Registered",text:"yes"===(null===(t=c.details)||void 0===t?void 0:t.cisRegistered)?"Yes":"No"}),(0,a.jsx)(i.Z,{content:"Website",text:c.website})]})};s.defaultProps={open:!0}},98307:function(e,n,t){"use strict";t.d(n,{D:function(){return s}});var r=t(80284),i=t(93443),o=t(77417),a=t(85893),s=function(e){var n=e.supplier;return(0,a.jsx)(r.Z,{open:!0,title:"Contact",children:n.contactUsers.map((function(e){var t;return(0,a.jsxs)("div",{children:[(0,a.jsx)(i.Z,{content:"Name",text:"".concat(e.user.fullName)}),(0,a.jsx)(i.Z,{content:"Phone",text:e.user.phone}),(0,a.jsx)(i.Z,{content:"Email",text:e.user.email}),(0,a.jsx)(i.Z,{content:"Quoting Email",text:(null===(t=n.details)||void 0===t?void 0:t.quotingEmail)||"-"}),(0,a.jsx)(o.Z,{})]},e.user.id)}))})}},17517:function(e,n,t){"use strict";t.d(n,{u:function(){return r}});var r=function(e){var n=e.addresses;return null!==n&&void 0!==n&&n.address?{__html:"".concat(n.address.addressLine1,"<br />").concat(n.address.postCode)}:"Please add"}},23154:function(e,n,t){"use strict";t.d(n,{E:function(){return s}});var r=t(30266),i=t(64687),o=t.n(i),a=t(27834),s=function(){var e=(0,r.Z)(o().mark((function e(n,t){var r,i,s,c=arguments;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=c.length>2&&void 0!==c[2]&&c[2],e.prev=1,e.next=4,n.query({query:a.WF,variables:{email:t}});case 4:if(i=e.sent,!((s=i.data.users)&&s.length>0)){e.next=8;break}return e.abrupt("return",!!r&&s[0]);case 8:return e.abrupt("return",!r||null);case 11:return e.prev=11,e.t0=e.catch(1),e.abrupt("return",!0);case 14:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(n,t){return e.apply(this,arguments)}}()},10076:function(e,n,t){"use strict";t.d(n,{H:function(){return S}});var r=t(92809),i=t(83789),o=t(93633),a=t(42283),s=t(79665),c=t(84550),u=t(97202),d=t(65375),l=t(46482),m=t(71247),p=t(69128),f=t(34003),v=t(98315),y=t(19501),b=(0,y.Ry)().shape({nameFirst:(0,y.Z_)().required(),nameLast:(0,y.Z_)().required(),email:(0,y.Z_)().required().email(),phone:(0,y.Z_)().required(),status:(0,y.Z_)().when("$hasRole",(function(e){return e?(0,y.Z_)().oneOf(["active","inactive"]).required():void 0})),invoiceThreshold:(0,y.Rx)().nullable(!0).transform((function(e){return isNaN(e)?null:e})),quoteThreshold:(0,y.Rx)().nullable(!0).transform((function(e){return isNaN(e)?null:e})),role:(0,y.Z_)().when(["$hasRole","accountId"],(function(e,n){return e?n&&n.length>0&&(0,y.Z_)().required():void 0})),position:(0,y.Z_)().when("accountId",{is:function(e){return e&&e.length>0},then:(0,y.Z_)()}),isContact:(0,y.Z_)().when("accountId",{is:function(e){return e&&e.length>0},then:(0,y.Z_)().oneOf(["yes","no"]).required()}),location:(0,y.IX)().when("$hasLocation",(function(e){return e?(0,y.IX)().of((0,y.Rx)().integer().required()).required():void 0}))}),h=t(1323),g=t(56257),x=t(27834),j=t(17517),I=t(81185),O=t(49705),_=t(85893);function Z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function A(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Z(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var w=function(e,n){return"customer"!==e&&"supplier"!==e||n([].concat((0,i.Z)(g.td),(0,i.Z)(g.Sf),(0,i.Z)(g.n),(0,i.Z)(g.nx)))},P=["customer_user"],S=function(e){var n=e.accountType,t=e.defaultValues,r=e.meta,y=e.submit,Z=(0,h.x)(),S=Z.hasRole,C=Z.user,$=(0,O.x)({filters:{}}),q=$.initialData,D=$.ref,k=(0,a.cI)({defaultValues:t&&A({},t),resolver:(0,s.S)(b),context:{hasRole:w(n,S),hasLocation:!P.includes(C.role)&&P.includes("".concat(n,"_").concat(null===t||void 0===t?void 0:t.role))}}),R=k.control,E=k.errors,T=k.handleSubmit,N=k.register,F=(0,k.watch)("role"),L=(0,o.a)(x.ZA,{variables:A(A({},q),{},{accountId:t.accountId})}),U=L.data,H=(U=void 0===U?{location:[],meta:{aggregate:{totalCount:0}}}:U).location,M=U.meta,G=L.loading,V=L.refetch,z=(0,i.Z)(v.I);switch(n){case"supplier":z.push({text:"Operative",value:"contractor"});break;case"admin":z.push({text:"Helpdesk",value:"helpdesk"})}var J={control:R,errors:E,register:N},B=[{hidden:!S([].concat((0,i.Z)(g.td),(0,i.Z)(g.Sf),(0,i.Z)(g.n))),formatter:function(e){var n=e.row;return(0,_.jsx)(c.Z,A(A({},J),{},{name:"location",data:[{value:n.id}]}))}},{text:"Name"},{text:"Address"}];return(0,_.jsxs)(u.Z,{id:"offCanvasForm",handleSubmit:T((function(e){y(e,r)})),children:[(0,_.jsx)(f.q,A({},J)),t.accountId&&(0,_.jsxs)(_.Fragment,{children:[w(n,S)&&(0,_.jsx)(d.Z,{label:"Role",children:(0,_.jsx)(l.Z,A(A({},J),{},{name:"role",options:z}))}),(0,_.jsx)(d.Z,{label:"Position / Job title",children:(0,_.jsx)(m.Z,A(A({},J),{},{name:"position"}))}),S(["admin_owner","admin_manager","customer_owner","customer_manger","supplier_owner","supplier_manager"])&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(d.Z,{label:"Threshold limit / Invoice",children:(0,_.jsx)(m.Z,A(A({},J),{},{name:"invoiceThreshold"}))}),(0,_.jsx)(d.Z,{label:"Threshold limit / Quote",children:(0,_.jsx)(m.Z,A(A({},J),{},{name:"quoteThreshold"}))})]}),(0,_.jsx)(p.Z,A(A({},J),{},{data:[{id:"yes",label:"Yes",value:"yes"},{id:"no",label:"No",value:"no"}],legend:"Contact User",name:"isContact",stacked:!0})),P.includes("".concat(n,"_").concat(F))&&(0,_.jsx)(d.Z,{label:"Locations",children:(0,_.jsx)(I.t,{columns:B,loading:G,meta:M,ref:D,refetch:V,rows:function(){var e=H.map((function(e){return{id:e.accountLocations[0].id,name:e.name,address:(0,j.u)({addresses:e.addresses[0]})}}));return P.includes(C.role)?e.filter((function(e){var n;return null===t||void 0===t||null===(n=t.location)||void 0===n?void 0:n.includes("".concat(e.id))})):e}()})})]}),(null===t||void 0===t?void 0:t.id)&&(0,_.jsx)(m.Z,A(A({},J),{},{name:"id",type:"hidden"})),(null===t||void 0===t?void 0:t.accountId)&&(0,_.jsx)(m.Z,A(A({},J),{},{name:"accountId",type:"hidden"})),(null===t||void 0===t?void 0:t.accountUserId)&&(0,_.jsx)(m.Z,A(A({},J),{},{name:"accountUserId",type:"hidden"}))]})}},81167:function(e,n,t){"use strict";t.d(n,{P:function(){return F}});var r=t(83789),i=t(92809),o=t(30266),a=t(80318),s=t(64687),c=t.n(s),u=t(67294),d=t(11163),l=t(26075),m=t(93633),p=t(75709),f=t(27834),v=t(80880),y=t(43566),b=t(29444),h=t(91126),g=t(18862),x=t(58448),j=t(14347),I=t(80284),O=t(22796),_=t(11570),Z=t(81185),A=t(50899),w=t(49705),P=t(10076);function S(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?S(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var $=function(e,n,t){var r={};return e.id?(r.id=parseInt(e.id),r.changes={nameFirst:e.nameFirst,nameLast:e.nameLast,email:e.email,phone:e.phone,meta:C(C({},n),{},{threshold:{invoice:e.invoiceThreshold,quote:e.quoteThreshold}})},e.accountUserId?(r.updateAccountUser=!0,r.accountUserId=parseInt(e.accountUserId),r.accountUserChanges={role:e.role,position:e.position,isContact:"yes"===e.isContact,status:e.status}):(r.accountUserId=0,r.updateAccountUser=!1)):(r.role=e.role,r.position=e.position,r.isContact="yes"===e.isContact,r.status=e.status,r.accountId=e.accountId,t?r.userId=t.id:r.User={data:{nameFirst:e.nameFirst,nameLast:e.nameLast,email:e.email,phone:e.phone,status:e.status,meta:{sendDefaultWelcomeEmail:!0}}}),r},q=function(e){return{accountUserId:e.accountUserId,objects:e.location.map((function(n){return{accountUserId:e.accountUserId,accountLocationId:n}}))}},D=t(14651),k=t(23154),R=t(56257),E=t(85893);function T(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?T(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):T(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var F=function(e){var n=e.accountType,t=e.filters,i=(0,l.x)(),s=(0,w.x)({filters:t}),S=s.initialData,C=s.ref,T=(0,u.useContext)(v.Z),F=(0,u.useContext)(y.Z).user,L=null,U=(0,m.a)(f.fo,{variables:S}),H=U.data,M=(H=void 0===H?{users:[],meta:{aggregate:{totalCount:0}}}:H).users,G=H.meta,V=U.loading,z=U.refetch,J=(0,p.D)(f.I4,{onCompleted:function(e){T.close(),z()}}),B=(0,a.Z)(J,2),Q=B[0],W=B[1].error,Y=(0,p.D)(f.AX,{onCompleted:function(e){T.close(),z()}}),X=(0,a.Z)(Y,2),K=X[0],ee=X[1].error,ne=(0,p.D)(f.tW,{onCompleted:function(e){z()}}),te=(0,a.Z)(ne,2),re=te[0],ie=te[1].error;W&&W.graphQLErrors.forEach((function(e){var n;L="constraint-violation"===(null===(n=e.extensions)||void 0===n?void 0:n.code)?"Error: a user with this e-mail address already exists":"Error creating user"})),ee&&ee.graphQLErrors.forEach((function(e){var n;L="constraint-violation"===(null===(n=e.extensions)||void 0===n?void 0:n.code)?"Error, a user with this e-mail address already exists":"Error updating user"})),ie&&(L="Error getting user`s locations");var oe=function(){var e=(0,o.Z)(c().mark((function e(n,t){var r,o,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,k.E)(i,n.email,!0);case 2:if(r=e.sent,o=$(n,t,r),!n.id){e.next=9;break}K({variables:N({},o)}),n.location&&re({variables:N({},q(n))}),e.next=14;break;case 9:return e.next=11,Q({variables:{objects:o}});case 11:a=e.sent,s=a.data.insert_Account_User.returning,n.location&&re({variables:N({},q({location:n.location,accountUserId:s[0].id}))});case 14:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),ae=function(e,r){e.stopPropagation();var i=function(e){var n,t,r,i,o={id:(null===e||void 0===e?void 0:e.id)||null,accountId:null===e||void 0===e?void 0:e.accountId,nameFirst:(null===e||void 0===e?void 0:e.nameFirst)||"",nameLast:(null===e||void 0===e?void 0:e.nameLast)||"",email:(null===e||void 0===e?void 0:e.email)||"",phone:(null===e||void 0===e?void 0:e.phone)||"",invoiceThreshold:null===(n=e.meta)||void 0===n||null===(t=n.threshold)||void 0===t?void 0:t.invoice,quoteThreshold:null===(r=e.meta)||void 0===r||null===(i=r.threshold)||void 0===i?void 0:i.quote,role:"",position:"",isContact:"",status:"active",meta:null===e||void 0===e?void 0:e.meta};return null!==e&&void 0!==e&&e.accountUser&&(o.accountUserId=e.accountUser.id,o.accountId=e.accountUser.account.id,o.role=e.accountUser.role,o.position=e.accountUser.position,o.isContact=!0===e.accountUser.isContact?"yes":"no",o.status=e.accountUser.status,o.location=e.accountUser.userLocations.map((function(e){return"".concat(e.accountLocationId)}))),o}(N(N({},r),{},{accountId:t.accountId}));T.show({content:(0,E.jsx)(P.H,{accountType:n,defaultValues:i,meta:null===r||void 0===r?void 0:r.meta,submit:oe,submitError:L}),title:r?"Edit user":"Add user"})},se=[{hidden:!0},{text:"Name"},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:t.accountId,formatter:(0,b.Z)("","accountId","account","url"),text:"Account"},{text:"Email Address"},{text:"Contact User",formatter:function(e){var n=e.row;e.data;if(n.accountUser.isContact)return(0,E.jsx)(D.Z,{color:"error"})}},{text:"Phone"},{text:"Position"},{hidden:!0},{hidden:!t.accountId,text:"Role"},{text:"Status"},{text:"Date Added",sortable:!0,sortName:"createdAt"},{hidden:!0},{hidden:!0},{formatter:function(e){var t=e.row,i=e.data;return"supplier"!==n&&"customer"!==n||F.email!==t.email&&![].concat((0,r.Z)(R.td),(0,r.Z)(R.Sf),(0,r.Z)(R.n),(0,r.Z)(R.nx)).includes(F.role)?[].concat((0,r.Z)(R.td),(0,r.Z)(R.Sf),(0,r.Z)(R.n),(0,r.Z)(R.nx)).includes(F.role)?(0,E.jsx)(h.Z,{row:t,data:i}):void 0:(0,E.jsx)(h.Z,{row:t,data:i})},formatterData:[{context:"secondary",icon:["fas","edit"],onClick:ae,tooltip:"Edit"},{context:"info",icon:["fas","file-upload"],onClick:function(e,n){e.stopPropagation(),T.show({content:(0,E.jsx)(A.G,{category:"avatar",entity:"User",entityId:n.id,limit:1,type:"image"}),submit:!1,title:"Upload avatar"})},tooltip:"Avatar"}],text:"Actions"}],ce=function(){return(0,E.jsx)(x.Z,{children:(0,E.jsx)(j.Z,{context:"secondary",content:"Edit",onClick:ae,size:"sm",children:"Create User"})})};return(0,E.jsxs)(I.Z,{toolbar:t.accountId&&[].concat((0,r.Z)(R.td),(0,r.Z)(R.Sf),(0,r.Z)(R.n),(0,r.Z)(R.nx)).includes(F.role)&&(0,E.jsx)(ce,{}),open:!0,title:"Users",children:[(0,E.jsx)(Z.t,{columns:se,loading:V,meta:G,ref:C,refetch:z,rowClick:function(e){d.default.push("".concat("/dashboard/users/","view?id=").concat(e.id))},rows:function(){var e=[];return M.forEach((function(n){var r,i,o,a=null;a=t.accountId?n.accounts.find((function(e){var n;return(null===(n=e.account)||void 0===n?void 0:n.id)===parseInt(t.accountId)})):n.accounts.find((function(e){return null!==e.account}));var s={id:n.id,name:"".concat(n.nameFirst," ").concat(n.nameLast),nameFirst:n.nameFirst,nameLast:n.nameLast,accountId:a&&a.account.id,type:a&&a.account.type,email:n.email,account:a?"".concat(a.account.name," (").concat(a.account.type,")"):"-",phone:n.phone,position:null!==(r=a)&&void 0!==r&&r.position?a.position:"N/A",accountUser:a,role:null===(i=a)||void 0===i?void 0:i.role,status:a?a.status:n.status,createdAt:(0,g.Z)(n.createdAt),url:a&&!["admin","tenant"].includes(a.account.type.toLowerCase())?"/dashboard/".concat(null===(o=a)||void 0===o?void 0:o.account.type.toLowerCase(),"s/view"):"",meta:n.meta,actions:""};e.push(s)})),e}()}),L&&(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(O.Z,{}),(0,E.jsx)(_.Z,{content:L,context:"warning"})]})]})}},34003:function(e,n,t){"use strict";t.d(n,{q:function(){return b}});var r=t(83789),i=t(92809),o=t(78215),a=t(2356),s=t(65375),c=t(71247),u=t(50710),d=t(46482),l=t(75838),m=t(1323),p=t(56257),f=t(85893);function v(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?v(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var b=function(e){var n=e.errors,t=e.prefix,i=e.register,v=(0,m.x)().hasRole,b={errors:n,register:i};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(o.Z,{children:[(0,f.jsx)(a.Z,{md:6,children:(0,f.jsx)(s.Z,{label:"First name",children:(0,f.jsx)(c.Z,y(y({},b),{},{name:"".concat(t,"nameFirst")}))})}),(0,f.jsx)(a.Z,{md:6,children:(0,f.jsx)(s.Z,{label:"Last name",children:(0,f.jsx)(c.Z,y(y({},b),{},{name:"".concat(t,"nameLast")}))})}),(0,f.jsx)(a.Z,{md:6,children:(0,f.jsxs)(s.Z,{label:"Email",children:[(0,f.jsx)(c.Z,y(y({},b),{},{name:"".concat(t,"email"),type:"email"})),n["".concat(t,"email")]&&"duplicate"===n["".concat(t,"email")].type&&(0,f.jsx)(u.Z,{message:n["".concat(t,"email")].message})]})}),(0,f.jsx)(a.Z,{md:6,children:(0,f.jsx)(s.Z,{label:"Mobile",children:(0,f.jsx)(c.Z,y(y({},b),{},{name:"".concat(t,"phone")}))})})]}),v([].concat((0,r.Z)(p.td),(0,r.Z)(p.Sf),(0,r.Z)(p.n),(0,r.Z)(p.nx)))&&(0,f.jsx)(s.Z,{label:"Status",children:(0,f.jsx)(d.Z,y(y({},b),{},{name:"".concat(t,"status"),options:l.bg}))}),(0,f.jsx)(c.Z,y(y({},b),{},{name:"".concat(t,"userId"),type:"hidden"}))]})};b.defaultProps={prefix:""}},42772:function(e,n,t){"use strict";t.d(n,{S:function(){return r}});var r=function(e,n){var t=document.createElement("a");"string"===typeof t.download?(document.body.appendChild(t),t.download=n,t.href=e,t.click(),document.body.removeChild(t)):location.replace(e)}},89331:function(e,n,t){"use strict";t.d(n,{l:function(){return r},Y:function(){return i}});var r=[{text:"Account Type",value:""},{text:"Admin",value:"admin"},{text:"Customer",value:"customer"},{text:"Supplier",value:"supplier"},{text:"Tenant",value:"tenant"}],i=function(e){return[{icon:"edit",tooltip:"Edit",to:"/dashboard/".concat(e.type,"s/").concat("supplier"===e.type?"edit":"manage","?id=").concat(e.id)}]}},18254:function(e,n,t){"use strict";t.d(n,{E:function(){return r}});var r=[{text:"Select Type Of Organisation",value:""},{text:"Sole trader",value:"soleTrader"},{text:"Limited company",value:"limitedCompany"},{text:"Partnership",value:"partnership"},{text:"LLP",value:"llp"},{text:"PLC",value:"plc"}]},75838:function(e,n,t){"use strict";t.d(n,{bg:function(){return r},WG:function(){return i}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],i=[{text:"Status",value:""},{text:"Open",value:"open"},{text:"Resolved",value:"resolved"},{text:"Closed",value:"closed"}]},98315:function(e,n,t){"use strict";t.d(n,{I:function(){return r}});var r=[{text:"Select Role",value:""},{text:"Owner",value:"owner"},{text:"Manager",value:"manager"},{text:"User",value:"user"}]},71248:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return ft}});var r=t(66918),i=t(11163),o=t(78215),a=t(2356),s=t(67294),c=t(93633),u=t(2880),d=t(42593),l=t(92743),m=t(87160),p=t(92809),f=t(80318),v=t(38460),y=t(57460),b=t.n(y),h=t(14347),g=t(55657),x=t(18944),j=t(80285),I=t(29444),O=t(91126),_=t(18862),Z=t(80284),A=t(42772),w=t(81185),P=t(68343),S=t(65570),C=t(1323),$=t(78586),q=t(49705),D=t(85893);function k(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function R(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?k(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):k(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var E=function(e){var n,t,r=e.filters,o=(0,C.x)(),a=o.hasRole,s=o.user,d=(0,$.q)(),l=null===(n=d.admin.jobSetting)||void 0===n?void 0:n.jobNumberPrefix,m=null===(t=d.admin.jobSetting)||void 0===t?void 0:t.jobNumberSuffix,p=(0,q.x)({filters:r}),y=p.initialData,k=p.ref,E=(0,c.a)(u.G5,{variables:R(R({},y),{},{adminId:s.adminId})}),T=E.data,N=(T=void 0===T?{jobs:[],meta:{aggregate:{totalCount:0}}}:T).jobs,F=T.meta,L=E.loading,U=E.refetch,H=[{hidden:!0},{hidden:!0},{hidden:!0},{text:"ID",formatter:function(e){var n=e.row;return(0,D.jsx)(S.D,{id:n.id,invoiceNumber:n.invoiceNumber,number:n.number,numberPrefix:l,numberSuffix:m,openCanvas:!0,type:n.type})}},{text:"Reference"},{text:"Description"},{sortable:!0,sortName:'{"Job": { "Service": {"name": "ORDER"} }}',text:"Service"},{sortable:!0,sortName:'{"Job": { "SLA": {"name": "ORDER"} }}',text:"Priority"},{formatter:(0,I.Z)("/dashboard/properties/view","propertyId","location"),sortable:!0,sortName:'{"Job":{"Location": {"name": "ORDER"}}}',text:"Location"},{hidden:!a("admin"),text:"Total \xa3",formatter:function(e){var n,t,r=e.row;return n=r.jobTotal,t=r.expensesAmountCustomer,(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(x.Z,{size:"xs",children:["Job total ",(0,j.Z)(n)]}),(0,D.jsxs)(x.Z,{size:"xs",children:["Expense customer ",(0,j.Z)(t)]})]})}},{hidden:!0},{text:"Supplier \xa3",formatter:function(e){var n,t,r=e.row;return n=r.supplierAmount,t=r.expensesAmountSupplier,(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(x.Z,{size:"xs",children:["Amount ",(0,j.Z)(n)]}),(0,D.jsxs)(x.Z,{size:"xs",children:["Expense amount ",(0,j.Z)(t)]})]})}},{hidden:!0},{hidden:!a("admin"),text:"Revenue",formatter:function(e){var n=e.row;return(0,j.Z)(n.revenue)}},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{text:"Scheduled"},{sortable:!0,sortName:"createdAt",text:"Created"},{sortable:!0,sortName:"status",formatter:function(e){var n=e.row;return(0,P.B)({value:n.status})},text:"Status"},{hidden:!a("admin"),formatter:O.Z,formatterData:function(e){return[{context:"secondary",icon:["fas","edit"],onClick:function(n,t){return e(t)},tooltip:"Edit"}]}((function(e){i.default.push("".concat("/dashboard/issues/","manage?id=").concat(e.number))})),text:"Actions"}];return(0,D.jsx)(Z.Z,{fitParentHeight:!0,open:!0,title:"Work Orders",toolbar:(0,D.jsx)(D.Fragment,{children:function(){var e=(0,C.x)().user,n=y.customerId,t=y.endDate,r=y.locationId,i=y.orderBy,o=y.startDate,a=y.status,s=y.supplierId,c=(0,v.t)(u.G5,{variables:{adminId:e.adminId,customerId:n,endDate:t,locationId:r,orderBy:i,startDate:o,status:a,supplierId:s},onCompleted:function(n){var t,r=function(e,n,t){var r=t.numberPrefix,i=void 0===r?"":r,o=t.numberSuffix,a=void 0===o?"":o,s="supplier"===n;return e.map((function(e){var n,t,r,o,c,u,d,l,m=e.manager?"".concat(e.manager.nameFirst," ").concat(e.manager.nameLast):"Unassigned",p=e.scheduledAt?(0,_.Z)(e.scheduledAt,!0):(0,_.Z)(e.timingStart,!0);return s?{id:"".concat(i," ").concat(e.jobNumber," ").concat(a),type:e.jobType,invoiceNumber:e.invoiceNumber,ref:e.reference,supplierAmount:(0,j.Z)(e.supplierAmount)||0,expensesAmountSupplier:(0,j.Z)(e.expensesAmountSupplier)||0,priority:(null===(n=e.job.sla)||void 0===n?void 0:n.name)||"-",service:e.serviceName||"-",description:(null===(t=e.job)||void 0===t?void 0:t.description)||"-",manager:m,location:(null===(r=e.job)||void 0===r||null===(o=r.location)||void 0===o?void 0:o.name)||"-",customer:e.customerName||"-",scheduleDate:p,created:(0,_.Z)(e.createdAt),status:e.status}:{id:e.jobNumber,type:e.jobType,invoiceNumber:e.invoiceNumber,ref:e.reference,jobTotal:(0,j.Z)(e.jobTotal)||0,expensesAmountCustomer:(0,j.Z)(e.expensesAmountCustomer)||0,supplierAmount:(0,j.Z)(e.supplierAmount)||0,expensesAmountSupplier:(0,j.Z)(e.expensesAmountSupplier)||0,revenue:(0,j.Z)(e.revenue)||0,priority:(null===(c=e.job.sla)||void 0===c?void 0:c.name)||"-",service:e.serviceName||"-",description:(null===(u=e.job)||void 0===u?void 0:u.description)||"-",manager:m,location:(null===(d=e.job)||void 0===d||null===(l=d.location)||void 0===l?void 0:l.name)||"-",customer:e.customerName||"-",scheduleDate:p,created:(0,_.Z)(e.createdAt),status:e.status}}))}(n.jobs,e.accountType,{numberPrefix:l,numberSuffix:m}),i=b().unparse(r),o=(null===(t=n.jobs[0])||void 0===t?void 0:t.supplierName)||"Supplier",a="data:application/octet-stream,"+encodeURIComponent(i);(0,A.S)(a,"".concat(o,"-BookingData.csv"))}}),d=(0,f.Z)(c,1)[0];return(0,D.jsx)(D.Fragment,{children:(0,D.jsx)(h.Z,{context:"light",onClick:function(e){e.stopPropagation(),d()},title:"Export to CSV",size:"md",children:(0,D.jsx)(g.Z,{context:"secondary",icon:"file-csv",size:"lg"})})})}()}),children:(0,D.jsx)(w.t,{columns:H,loading:L,meta:F,ref:k,refetch:U,rows:null===N||void 0===N?void 0:N.map((function(e){var n,t,r,i,o,a=e.scheduledAt?(0,_.Z)(e.scheduledAt,!0):(0,_.Z)(e.timingStart,!0);return{id:e.jobId,type:e.jobType,number:e.jobNumber,invoiceNumber:e.invoiceNumber,ref:e.reference||"-",description:(null===(n=e.job)||void 0===n?void 0:n.description)||"-",service:e.serviceName||"-",priority:(null===(t=e.job.sla)||void 0===t?void 0:t.name)||"-",location:(null===(r=e.job)||void 0===r||null===(i=r.location)||void 0===i?void 0:i.name)||"-",jobTotal:e.jobTotal||0,expensesAmountCustomer:e.expensesAmountCustomer||0,supplierAmount:e.supplierAmount||0,expensesAmountSupplier:e.expensesAmountSupplier||0,revenue:e.revenue||0,propertyId:e.priorityId,managerId:null===(o=e.job.manager)||void 0===o?void 0:o.id,customerId:e.customerId,supplierId:e.supplierId||"",scheduleDate:a,date:(0,_.Z)(e.createdAt),status:e.status,actions:""}}))})})};E.defaultProps={filters:{assetId:null,managerId:null}};var T=t(30266),N=t(64687),F=t.n(N),L=t(75709),U=t(33462),H=t(80880),M=t(7720),G=t(5e3),V=t(92549),z=[{text:"Draft",value:"supplierQuestionsDraft",context:"info"},{text:"Submitted",value:"supplierQuestionsSubmitted",context:"help"},{text:"Approved",value:"supplierQuestionsApproved",context:"success"}];function J(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}var B=function(e){var n=e.accountId,t=e.statusLogs,r=e.refetch,i=(0,s.useContext)(H.Z),o=(0,c.a)(U.RQ,{variables:{entity:"Account",entityId:n,type:"supplierQuestion"}}),a=o.loading,u=o.refetch,d=o.data,l=(d=void 0===d?{questions:{}}:d).questions,m=(0,L.D)(U.fC),v=(0,f.Z)(m,1)[0],y=function(){var e=(0,T.Z)(F().mark((function e(t,o){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v({variables:{entity:"Account",entityId:n,questions:b(t),objectStatusLog:[{status:o,entity:"Account",entityId:n}],hasStatusLog:!!o}});case 2:r(),u(),i.close();case 5:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),b=function(e){return e.map((function(e){return{comments:e.comments,taxonomyId:e.taxonomyId,entity:e.entity,entityId:e.entityId}}))},h=function(e){return e.map((function(e){var n;return function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?J(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):J(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}({comments:null===(n=e.taxonomy_entity[0])||void 0===n?void 0:n.comments,taxonomyId:e.id,name:e.name},e)}))},g=function(){var e=t.slice().filter((function(e){return z.find((function(n){return n.value===e.status}))})).sort((function(e,n){return Number(n.id)-Number(e.id)})),n=z.find((function(n){var t;return n.value===(null===(t=e[0])||void 0===t?void 0:t.status)}))||{text:"-",context:"info"};return(0,D.jsx)(M.Z,{content:n.text,size:"md",context:n.context})};return!a&&(0,D.jsx)(Z.Z,{open:!0,title:"Operational Processes And Procedures",toolbar:(0,D.jsx)(g,{}),children:(0,D.jsx)(G.y,{answers:l,onEdit:function(){i.show({content:(0,D.jsx)(V.D,{onSuccess:y,entity:"Account",entityId:n,questions:h(l),hasChangeStatus:!0}),title:"Complete Questions",width:"50%",submit:!1})},entity:"Account",entityId:n})})},Q=t(83789),W=t(23845),Y=t(22796),X=t(91110),K=t(17517),ee=t(55148),ne=t(93443),te=function(e){var n,t=e.job,r=null!==t&&void 0!==t&&t.shortJobDesc&&t.shortJobDesc.length?t.shortJobDesc[0].taxonomy.name:null;return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(ne.Z,{content:"Short Job Description",text:r||(null===t||void 0===t?void 0:t.title)}),(0,D.jsx)(ne.Z,{content:"Work description",text:null!==(n=null===t||void 0===t?void 0:t.description)&&void 0!==n?n:"-"})]})};function re(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ie(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?re(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):re(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var oe=function(e){var n,t,r,i=e.initialFilters,o=e.filters,a=(0,q.x)({filters:o}),u=a.initialData,d=a.ref,l=i.supplierId,m=void 0===l?null:l,p=(0,s.useContext)(H.Z),y=(0,s.useState)(!1),I=y[0],P=y[1],C=(0,$.q)(),k=null===(n=C.admin.jobSetting)||void 0===n?void 0:n.jobNumberPrefix,R=null===(t=C.admin.jobSetting)||void 0===t?void 0:t.jobNumberSuffix,E=(0,c.a)(W.JE,{variables:ie(ie(ie({q:null},i),u),{},{accountId:m})}),T=E.data,N=(T=void 0===T?{quotations:[],meta:{aggregate:{totalCount:0}}}:T).meta,F=T.quotations,L=E.loading,U=E.refetch,M=(0,v.t)(W.JE,{variables:{accountId:m,limit:(null===N||void 0===N||null===(r=N.aggregate)||void 0===r?void 0:r.totalCount)||150},onCompleted:function(e){var n=e.quotations;if(I){var t=b().unparse(re(n)),r="data:application/octet-stream,"+encodeURIComponent(t);(0,A.S)(r,"quotations.csv"),P(!1)}},skip:!0}),G=(0,f.Z)(M,2),V=G[0],z=G[1].loading,J=void 0===z||z,B=function(){U(),p.close()},ne=[{hidden:!0},{hidden:!0},{formatter:function(e){var n,t=e.row;return null!==(n=t.job)&&void 0!==n&&n.type?(0,D.jsx)(S.D,{id:t.jobId,number:t.number,numberPrefix:k,numberSuffix:R,openCanvas:!0,shortJobDesc:t.shortJobDesc,type:t.job.type}):(0,D.jsxs)(x.Z,{size:"xs",children:["Q ",t.jobId]})},text:"Job"},{text:"Creator"},{hidden:!0},{text:"Customer"},{text:"Address"},{text:"Labour Total"},{text:"Materials Total"},{text:"Quote Total"},{formatter:function(e){return function(e){return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsxs)(x.Z,{size:"xs",children:[e.totalDuration," ",e.totalDurationUnit]}),(0,D.jsx)(x.Z,{size:"xs",children:e.startDate?(0,_.Z)(e.startDate):"-"})]})}(e.row)},text:"Total Duration"},{hidden:!0},{hidden:!0},{text:"Status"},{hidden:!0},{formatter:O.Z,formatterData:[{context:"info",icon:["fas","receipt"],onClick:function(e,n){return function(e,n){e.stopPropagation(),n.id||(n={}),p.show({content:(0,D.jsx)(te,{job:n.job}),submit:!1,title:"Quotaition Description"})}(e,n)},tooltip:"Info"}],text:"Actions"}],re=function(e){return e.map((function(e){var n,t,r,i,o,a,s,c,u,d,l,m,p=((0,Q.Z)(ee.E6).find((function(n){return n.value===e.status}))||{text:""}).text,f=([].concat((0,Q.Z)(ee.l8),(0,Q.Z)(ee.iz)).find((function(n){var t;return n.value===(null===e||void 0===e||null===(t=e.job)||void 0===t?void 0:t.status)}))||{text:""}).text;return{id:e.id,number:null===(n=e.job)||void 0===n?void 0:n.number,jobId:e.jobId,creator:(null===e||void 0===e||null===(t=e.job)||void 0===t||null===(r=t.timings[0])||void 0===r||null===(i=r.user)||void 0===i?void 0:i.fullName)||"-",shortJobDesc:null===(o=e.job)||void 0===o||null===(a=o.shortJobDesc[0])||void 0===a||null===(s=a.taxonomy)||void 0===s?void 0:s.name,customer:(null===(c=e.job)||void 0===c||null===(u=c.customer)||void 0===u?void 0:u.name)||"-",address:null!==(d=e.job)&&void 0!==d&&null!==(l=d.location)&&void 0!==l&&l.addresses[0]?(0,K.u)({addresses:e.job.location.addresses[0]}):"-",labourTotal:(0,j.Z)(e.labourTotal.aggregate.sum.supplierTotal),materialsTotal:(0,j.Z)(e.materialsTotal.aggregate.sum.supplierTotal),quoteTotal:(0,j.Z)(e.total.aggregate.sum.supplierTotal),totalDuration:e.totalDuration,totalDurationUnit:e.totalDurationUnit,startDate:e.startDate,status:"reactive"===(null===e||void 0===e||null===(m=e.job)||void 0===m?void 0:m.type)?f:p,job:e.job,actions:""}}))};return(0,D.jsx)(Z.Z,{open:!0,title:"Quotes",toolbar:(0,D.jsx)(D.Fragment,{children:(0,D.jsx)(Y.Z,{marginRight:"xs",children:(0,D.jsx)(h.Z,{content:"Export to excel",context:"secondary",size:"sm",disabled:J,onClick:function(e){e.stopPropagation(),V(),P(!0)},children:(0,D.jsx)(g.Z,{context:"white",icon:"file-csv",size:"lg"})})})}),children:(0,D.jsx)(w.t,{columns:ne,loading:L,meta:N,ref:d,refetch:U,rowClick:function(e){p.show({content:(0,D.jsx)(X.m,{quotationId:e.id,onSuccess:B}),title:"Quotation",width:"50%"})},rows:re(F)})})},ae=t(3213),se=t(90480),ce=t(58448),ue=t(35614),de=t(42283),le=t(97202),me=t(65375),pe=t(84550);function fe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ve(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?fe(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):fe(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var ye=function(e){var n=e.onSubmit,t=e.defaultValues,r=(0,de.cI)({defaultValues:t}),i=r.control,o=r.errors,a=r.handleSubmit,c=r.register,u=r.setValue,d=(0,v.t)(se.kx),l=(0,f.Z)(d,2),m=l[0],p=l[1].data,y=(p=void 0===p?{services:[]}:p).services,b={control:i,errors:o,register:c};(0,s.useEffect)((function(){m()}),[]);var h=function(e){return!e.supplierDayRate&&!Object.keys(t).includes("".concat(e.id))};return(0,D.jsxs)(le.Z,{id:"offCanvasForm",handleSubmit:a((function(e){var t=Object.keys(e).filter((function(n){return e[n]})),r=y.filter((function(e){return t.includes("".concat(e.id))}));n(t,r)})),children:[(0,D.jsx)(me.Z,{label:"",children:(0,D.jsx)(pe.Z,ve(ve({size:"xs"},b),{},{name:"selectAll",onClick:function(e){return e.target.checked?(y.filter((function(e){return e.supplierDayRate})).map((function(e){return t[e.id]="".concat(e.id)})),void Object.keys(t).forEach((function(e){return u(e,t[e])}))):(y.map((function(e){return t[e.id]=!1})),void Object.keys(t).forEach((function(e){return u(e,t[e])})))},data:[{label:(0,D.jsx)("strong",{children:"Select All"}),key:0,value:!0}]}))}),y.map((function(e){return(0,D.jsx)(me.Z,{label:"",style:{display:"flex"},children:(0,D.jsx)(pe.Z,ve(ve({size:"xs"},b),{},{name:"".concat(e.id),disabled:h(e),data:[{label:"".concat(e.name," ").concat(h(e)?" (Undefined rate)":""),key:"".concat(e.id),value:"".concat(e.id)}]}))})}))]})};ye.defaultProps={};var be=t(32763);function he(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function ge(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?he(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):he(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var xe=["supplierHourRate","supplierHourRateOOH","supplierHourRatePremium","supplierDayRate","supplierDayRateOOH","supplierDayRatePremium"],je={item:"Service",inneritem:"name",order:"asc"},Ie=function(e){var n=e.hasCustomRates,t=e.edit,r=e.entity,i=e.entityId,o=e.filters,a=e.type,u=(0,s.useContext)(H.Z),d=(0,q.x)({filters:o,initialSort:je}),l=d.initialData,m=d.ref,v=(0,c.a)(se.pP,{variables:ge({entity:r,entityId:i,entityIds:[i],hasCustomerId:!1},l)}),y=v.data,b=(y=void 0===y?{services:[],servicesSystem:[],servicesCustomer:[],metaServices:{aggregate:{totalCount:0}},metaServicesSystem:{aggregate:{totalCount:0}},metaServicesCustomer:{aggregate:{totalCount:0}}}:y).metaServices,g=y.metaServicesCustomer,x=y.metaServicesSystem,j=y.services,I=v.loading,_=v.refetch,A=(0,L.D)(se.Q5,{onCompleted:function(e){u.close(),_()}}),P=(0,f.Z)(A,1)[0],S=(0,L.D)(se.Dr,{onCompleted:function(e){u.close(),_()}}),C=(0,f.Z)(S,1)[0],$=(0,L.D)(se.oh,{onCompleted:function(e){u.close(),_()}}),k=(0,f.Z)($,1)[0],R=function(){var e=(0,T.Z)(F().mark((function e(t){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.serviceId=parseInt(t.service.value),t.entity=r,t.entityId=i,t.notes=null,delete t.service,t.hasCallOutRate||(t.callOutHourRate=null,t.callOutHourRateOOH=null,t.callOutHourRatePremium=null),delete t.hasCallOutRate,n&&(t.meta=t.id&&ge({},j.find((function(e){return e.id===Number(t.id)})).meta)||{},xe.forEach((function(e){t.meta[e]=t[e],delete t[e]}))),!t.id){e.next=13;break}return e.next=11,k({variables:{id:t.id,changes:t}});case 11:e.next=15;break;case 13:return e.next=15,P({variables:{objects:[t]}});case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),E=function(){var e=(0,T.Z)(F().mark((function e(n,t){var o,a,s,c,u,d;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=Object.keys(U(j)),a=t.map((function(e){return"".concat(e.id)})),s=t.filter((function(e){return!o.includes("".concat(e.id))})).map((function(e){return{callOutHourRate:null,callOutHourRateOOH:null,callOutHourRatePremium:null,dayRate:e.supplierDayRate,dayRateOOH:e.supplierDayRateOOH,dayRatePremium:e.supplierDayRatePremium,entity:r,entityId:i,hourRate:e.supplierHourRate,hourRateOOH:e.supplierHourRateOOH,hourRatePremium:e.supplierHourRatePremium,minimumInterval:e.minimumInterval,minimumLength:e.minimumLength,notes:null,serviceId:parseInt(e.id),status:"active"}})),c=o.filter((function(e){return!a.includes(e)})),u=j.filter((function(e){return c.includes("".concat(e.serviceId))})).map((function(e){return e.id})),d=j.filter((function(e){return u.includes(e.id)})).map((function(e){return e.id})),e.t0=s.length>0,!e.t0){e.next=10;break}return e.next=10,P({variables:{objects:s}});case 10:if(e.t1=d.length>0,!e.t1){e.next=14;break}return e.next=14,C({variables:{ids:d}});case 14:case"end":return e.stop()}}),e)})));return function(n,t){return e.apply(this,arguments)}}(),N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.stopPropagation(),t.id||(t={}),u.show({content:(0,D.jsx)(ue.n,{defaultValues:t,entity:r,hasCustomRates:n,onSubmit:R,type:"supplier"}),title:"Services",width:"60%"})},U=function(e){var n={};return e.filter((function(e){return"active"===e.status})).map((function(e){return n=ge(ge({},n),{},(0,p.Z)({},e.service.id,!0))})),n},M=[{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{text:"Service Line"},{hidden:!1,text:"Type"},{hidden:!1,text:"Adjusted"},{text:"\xa3/H"},{text:"\xa3/H OOH"},{text:"\xa3/H Premium"},{text:"\xa3/D"},{text:"\xa3/D OOH"},{text:"\xa3/D Premium"},{text:"Min Interval"},{text:"Min Length"},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{text:"Status"},{hidden:!t,formatter:O.Z,formatterData:function(e){return[{context:"secondary",disabled:!(null===j||void 0===j?void 0:j.find((function(n){return n.service.id===e.service.value}))),icon:["fas","edit"],onClick:function(e,n){return N(e,n)},tooltip:"Edit"}]},text:"Actions"}],G=function(){return(0,D.jsxs)(ce.Z,{children:[(0,D.jsx)(h.Z,{context:"secondary",content:"Batch Add",onClick:function(e){return function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.stopPropagation(),n.id||(n={}),u.show({content:(0,D.jsx)(ye,{onSubmit:E,defaultValues:U(j)}),title:"Services Add Batch",width:"60%"})}(e)},size:"sm"}),(0,D.jsx)(h.Z,{context:"secondary",content:"Add Service",onClick:function(e){return N(e)},size:"sm"})]})};return(0,D.jsx)(Z.Z,{fitParentHeight:!0,open:!0,title:"Services",toolbar:t&&(0,D.jsx)(G,{}),children:(0,D.jsx)(w.t,{columns:M,initialSort:je,loading:I,meta:(0,be.dP)({metaServices:b,metaServicesCustomer:g,metaServicesSystem:x,type:a}),ref:m,refetch:_,rows:(0,be.jW)({services:j,type:"Supplier"}).filter((function(e){return"active"===e.status})).map((function(e){var n,t,r,i,o,a;return{id:e.id,accountId:e.accountId,notes:e.notes,service:{label:e.service.name,value:e.service.id},location:e.location,delivery:e.delivery,name:e.service.name,type:e.type,adjusted:"System"===e.type?"":(0,be.BY)(e),hourRateForTable:function(){return(0,D.jsxs)(D.Fragment,{children:[e.hourRate||"-",(0,D.jsx)("br",{}),(0,D.jsx)("b",{children:"".concat(e.callOutHourRate?"First hour: "+e.callOutHourRate:"")})]})},hourRateOOHForTable:function(){return(0,D.jsxs)(D.Fragment,{children:[e.hourRateOOH||"-",(0,D.jsx)("br",{}),(0,D.jsx)("b",{children:"".concat(e.callOutHourRateOOH?"First hour: "+e.callOutHourRateOOH:"")})]})},hourRatePremiumForTable:function(){return(0,D.jsxs)(D.Fragment,{children:[e.hourRatePremium||"-",(0,D.jsx)("br",{}),(0,D.jsx)("b",{children:"".concat(e.callOutHourRatePremium?"First hour: "+e.callOutHourRatePremium:"")})]})},dayRate:e.dayRate||"-",dayRateOOH:e.dayRateOOH||"-",dayRatePremium:e.dayRatePremium||"-",minimumInterval:e.minimumInterval||"-",minimumLength:e.minimumLength||"-",supplierHourRate:null===(n=e.meta)||void 0===n?void 0:n.supplierHourRate,supplierHourRateOOH:null===(t=e.meta)||void 0===t?void 0:t.supplierHourRateOOH,supplierHourRatePremium:null===(r=e.meta)||void 0===r?void 0:r.supplierHourRatePremium,supplierDayRate:null===(i=e.meta)||void 0===i?void 0:i.supplierDayRate,supplierDayRateOOH:null===(o=e.meta)||void 0===o?void 0:o.supplierDayRateOOH,supplierDayRatePremium:null===(a=e.meta)||void 0===a?void 0:a.supplierDayRatePremium,hourRate:e.hourRate,hourRateOOH:e.hourRateOOH,hourRatePremium:e.hourRatePremium,callOutHourRate:e.callOutHourRate,callOutHourRateOOH:e.callOutHourRateOOH,callOutHourRatePremium:e.callOutHourRatePremium,status:e.status,actions:""}}))})})};Ie.defaultProps={edit:!0,hasCustomRates:!1,filters:{}};var Oe,_e,Ze,Ae,we=t(66639),Pe=t(70448),Se=t(64111),Ce=t(28323),$e=t(50899),qe=t(77567),De=t(52209),ke=t(54397),Re=(0,ke.Ps)(Oe||(Oe=(0,De.Z)(["\n  mutation InsertReference($objects: [Reference_insert_input!]!) {\n    insert_Reference(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),Ee=(0,ke.Ps)(_e||(_e=(0,De.Z)(["\n  mutation UpdateReference($id: Int!, $changes: Reference_set_input) {\n    update_Reference_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),Te=(0,ke.Ps)(Ze||(Ze=(0,De.Z)(["\n  query GetReferences($accountId: Int) {\n    references: Reference(where: { accountId: { _eq: $accountId } }) {\n      id\n      name\n      email\n      phone\n      media: Media {\n        id\n      }\n    }\n  }\n"]))),Ne=(0,ke.Ps)(Ae||(Ae=(0,De.Z)(["\n  mutation DeleteReference($id: Int!) {\n    delete_Reference_by_pk(id: $id) {\n      id\n    }\n  }\n"]))),Fe=t(52002),Le=t(79665),Ue=t(71247),He=t(19501),Me=(0,He.Ry)().shape({email:(0,He.Z_)().required().email(),name:(0,He.Z_)().required(),phone:(0,He.Z_)().required()}),Ge=function(e){var n=e.defaultValues,t=e.accountId,r=e.success,i=(0,de.cI)({defaultValues:n&&n,resolver:(0,Le.S)(Me)}),o=i.errors,a=i.handleSubmit,s=i.register,c=(0,L.D)(Re,{onCompleted:function(){r&&r()}}),u=(0,f.Z)(c,1)[0],d=(0,L.D)(Ee,{onCompleted:function(){r&&r()}}),l=(0,f.Z)(d,1)[0];return(0,D.jsxs)(le.Z,{id:"offCanvasForm",handleSubmit:a((function(e){e.id?l({variables:{id:e.id,changes:e}}):(e.accountId=t,u({variables:{objects:e}}))})),children:[(0,D.jsx)(me.Z,{label:"Name",children:(0,D.jsx)(Ue.Z,{errors:o,name:"name",register:s})}),(0,D.jsx)(me.Z,{label:"Phone",children:(0,D.jsx)(Ue.Z,{errors:o,name:"phone",register:s})}),(0,D.jsx)(me.Z,{label:"Email",children:(0,D.jsx)(Ue.Z,{errors:o,name:"email",register:s})}),(null===n||void 0===n?void 0:n.id)&&(0,D.jsx)(Ue.Z,{errors:o,name:"id",register:s,type:"hidden"})]})},Ve=function(e){var n,t=e.accountId,r=e.edit,i=(0,s.useContext)(H.Z),o=(0,c.a)(Te,{variables:{accountId:t}}),a=o.data,u=(a=void 0===a?{references:[]}:a).references,d=o.loading,l=o.refetch,m=(0,L.D)(Ne,{onCompleted:function(e){l()}}),p=(0,f.Z)(m,1)[0],v=function(e,n){e.stopPropagation(),i.show({title:"Reference",content:(0,D.jsx)(Ge,{defaultValues:n,accountId:t,success:function(){i.close(),l()}})})},y=[{hidden:!0},{text:"Name"},{text:"Phone"},{text:"Email"},{hideen:!0},{hidden:!r,formatter:O.Z,formatterData:(n={editClick:function(e,n){return v(e,n)},mediaClick:function(e,n){return function(e){i.show({title:"Media",content:(0,D.jsx)($e.G,{entity:"Reference",entityId:null===e||void 0===e?void 0:e.id})})}(n)},deleteClick:function(e,n){return function(e){p({variables:{id:e.id}})}(n)}},[{context:"secondary",icon:["fas","edit"],onClick:n.editClick,tooltip:"Edit"},{context:"info",icon:["fas","file-upload"],onClick:n.mediaClick,tooltip:"Media",numberOverlay:"mediaCount"},{context:"danger",icon:["fas","trash"],onClick:n.deleteClick,tooltip:"Delete"}]),text:"Actions"}],b=function(){return(0,D.jsx)(ce.Z,{children:(0,D.jsx)(h.Z,{context:"secondary",content:"Add Quote",onClick:v,size:"sm"})})};return(0,D.jsx)(Z.Z,{toolbar:r&&(0,D.jsx)(b,{}),title:"References",children:(0,D.jsx)(Fe.Z,{columns:y,loading:d,rows:u.map((function(e){return{id:e.id,name:e.name,phone:e.phone,email:e.email,mediaCount:e.media.length,actions:""}}))})})};Ve.defaultProps={edit:!0};var ze=t(73165),Je=t(46958),Be=t(4513),Qe=t(11417),We=t(46482),Ye=t(24237),Xe=t(75838),Ke=(0,He.Ry)().shape({coverageArea:(0,He.Ry)(),coverAll:(0,He.Xg)(),status:(0,He.Z_)().oneOf(["active","inactive"])}),en=t(14399),nn=t(34610);function tn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function rn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?tn(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):tn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var on=function(e){var n=e.toggleFormatter,t=e.assignAll;return[{text:"postcodeAreaId",hidden:!0},{text:"id",hidden:!0},{text:"lock",hidden:!0},{text:"Area"},{text:"Name"},{formatter:n,text:(0,D.jsx)(nn.Z,{context:"secondary",size:"sm",onToggle:t})},{hidden:!0}]},an=function(e){var n=e.onToggle,t=e.areas,r=e.ref,i=(0,s.useState)(t),o=i[0],a=i[1];return(0,D.jsx)(Fe.Z,{columns:on({toggleFormatter:function(e){var t=e.row;return(0,D.jsx)(nn.Z,{context:"secondary",size:"sm",onToggle:function(e){return n({postcodeAreaId:t.postcodeAreaId,id:t.id,toggled:e})},toggled:t.assigned})},assignAll:function(e){a(function(e){var n=e.areas,t=e.toggled;return n.map((function(e){return rn(rn({},e),{},{assigned:t})}))}({areas:o,toggled:e})),t.map((function(t){return n({id:t.id,postcodeAreaId:t.postcodeAreaId,toggled:e})}))}}),rows:o,ref:r})};function sn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function cn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?sn(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):sn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var un=function(e){var n=e.accountId,t=e.item,r=e.offCanvas,i=e.refetch,o=e.type,a=e.coveredAreas,c=e.filters,u=(0,s.useState)(""),d=u[0],l=u[1],m=(0,de.cI)({defaultValues:{status:t?t.status:"active"},resolver:(0,Le.S)(Ke)}),p=m.control,y=m.errors,b=m.handleSubmit,h=m.register,g=(0,q.x)({filters:c}),j=g.initialData,I=g.ref,O=function(e,n){var t=(0,v.t)(en.j$,{variables:n}),r=(0,f.Z)(t,2),i=r[0],o=r[1],a=o.loading,c=o.data,u=(c=void 0===c?{items:[]}:c).items;return(0,s.useEffect)((function(){i()}),[]),{loading:a,rows:function(e){var n=e.coveredAreas,t=e.allAreas,r=[];return t.forEach((function(e){var t=e.area,i=e.label,o=e.value,a=n.findIndex((function(e){return e.area.id===o})),s=a>-1&&"active"===n[a].status,c=a>-1&&n[a].id||-1;r.push({postcodeAreaId:o,id:c,Area:t,Name:i,actions:"",assigned:s})})),r}({allAreas:u,coveredAreas:e})}}(a,j),_=O.rows,Z=O.loading,A=function(e){r.close(),i()},w=function(e){return l(e)},P=(0,L.D)(Je.OW,{onCompleted:A,onError:w}),S=(0,f.Z)(P,1)[0],C=(0,L.D)(Je.NG,{onCompleted:A,onError:w}),$=(0,f.Z)(C,1)[0],k=[],R=function(){var e=(0,T.Z)(F().mark((function e(n){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:"edit"===o?S({variables:{id:t.id,changes:n}}):"add"===o&&$({variables:{objects:k}});case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),E={control:p,errors:y,register:h};return Z?(0,D.jsx)(dn,{children:(0,D.jsx)(Be.Z,{})}):(0,D.jsxs)(le.Z,{id:"offCanvasForm",handleSubmit:b(R),children:[(0,D.jsx)(x.Z,{context:"danger",children:d}),(0,D.jsx)(Y.Z,{}),"add"!==o||Z?"edit"===o&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(Qe.Z,{content:"".concat(t.postcode," - ").concat(t.area),tag:"h4"}),(0,D.jsx)(me.Z,{label:"Status",children:(0,D.jsx)(We.Z,cn(cn({},E),{},{name:"status",options:Xe.bg}))})]}):(0,D.jsx)(an,{onToggle:function(e){var t=e.id,r=e.postcodeAreaId,i=e.toggled,o={entity:"Account",postcodeAreaId:r,entityId:n,status:i?"active":"inactive"};-1!==t&&(o.id=t),k.push(o)},areas:_,ref:I})]})},dn=Ye.ZP.div.withConfig({displayName:"form__StyledLoadingContainer",componentId:"sc-jq7uba-0"})(["height:100%;width:30%;padding:0;margin:0;position:fixed;display:flex;align-items:center;justify-content:center;text-align:center;"]);un.defaultProps={coveredAreas:[]};var ln=t(10973),mn=t(66805);function pn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function fn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?pn(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):pn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var vn=(0,s.memo)((function(e){var n=e.initialValues,t=(e.renderFilters,e.setFilters),r=e.lastQuery,i=(0,de.cI)({defaultValues:n}),s=i.errors,c=i.handleSubmit,u=i.register,d=i.reset,l=function(e){var i=e.query;if(i!==r){var o={q:"%".concat(i,"%")||0},a=/^\d+$/.test(i);"id"in n&&(o.id=a?Number(i):null),"meta"in n&&(o.meta=a?{invoiceNumber:Number(i)}:null),(o.id||o.meta)&&(o.q=null),t((function(e){return fn(fn({},e),o)}))}};return(0,D.jsxs)(le.Z,{handleSubmit:c(l),children:[(0,D.jsx)(o.Z,{children:(0,D.jsx)(a.Z,{sm:12,lg:12,children:(0,D.jsx)(me.Z,{label:"",children:(0,D.jsx)(ln.Z,{errors:s,label:"Search",name:"email",placeholder:"Search...",prependSearchIcon:!0,register:u,type:"search"})})})}),(0,D.jsx)(mn.H,{content:"Search",context:"secondary",handleClick:l,type:"submit",children:(0,D.jsx)(h.Z,{content:"Reset filters",context:"danger",onClick:function(e){t(n),d(n),l("")},size:"sm"})})]})}),(function(e,n){return!0})),yn={q:null},bn=function(e){var n=e.q,t=e.accountId,r=e.item,i=e.offCanvas,o=e.refetch,a=e.type,c=e.coveredAreas;yn.q=n?"%".concat(n,"%"):null;var u=(0,s.useState)(yn),d=u[0],l=u[1];return(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(vn,{initialValues:yn,setFilters:l}),(0,D.jsx)(un,{refetch:o,item:r,offCanvas:i,accountId:t,coveredAreas:c,type:a,filters:d})]})},hn=function(e){var n=[{context:"secondary",icon:["fas","edit"],onClick:function(n,t){return e(n,"edit",t)},tooltip:"Edit"}];return[{hidden:!0},{text:"Area"},{text:"Postcode"},{hidden:!0},{formatter:O.Z,formatterData:n,text:"Actions"}]},gn=function(e){var n=[];return e&&e.forEach((function(e){n.push({id:e.id,area:e.area.name,postcode:e.area.area,status:e.status,actions:""})})),n};function xn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function jn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?xn(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):xn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var In=function(e){var n=e.filters,t=e.accountId,r=e.handleClick,i=(0,q.x)({filters:n}),o=i.initialData,a=i.ref,s=(0,c.a)(u.lk,{variables:jn({supplierId:t},o)}),d=s.loading,l=s.data,m=(l=void 0===l?{coverage:[],meta:{aggregate:{totalCount:0}}}:l).coverage,p=l.meta,f=s.refetch;return(0,D.jsx)(w.t,{columns:hn(r),loading:d,meta:p,ref:a,history:!1,refetch:f,rows:gn(m)})},On=function(e){var n=e.refetch,t=e.supplier,r={q:null},i=(0,s.useContext)(H.Z),o=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=arguments.length>2?arguments[2]:void 0;e.stopPropagation(),i.show({title:"".concat((0,ze.Z)(r)," Postcode Area"),content:(0,D.jsx)(bn,{accountId:t.id,item:o,refetch:n,offCanvas:i,type:r,coveredAreas:t.coverage})})},a=(0,s.useState)(r),c=a[0],u=a[1],d=function(){return(0,D.jsx)(ce.Z,{children:(0,D.jsx)(h.Z,{context:"secondary",content:"Add",onClick:function(e){return o(e,"add")},size:"sm"})})};return(0,D.jsxs)(Z.Z,{toolbar:(0,D.jsx)(d,{}),open:!0,title:"Coverage Area",children:[(0,D.jsx)(vn,{initialValues:r,setFilters:u}),(0,D.jsx)(In,{accountId:t.id,handleClick:o,filters:c})]})},_n=t(74369),Zn=t(98307),An=t(48213);function wn(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Pn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?wn(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):wn(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Sn,Cn,$n=function(e){var n=e.compliances,t=e.supplierId,r=(0,An.JB)(n),o=(0,An.iU)(n),a={content:"Score ".concat(o," %"),context:(0,An.kW)(o)};return(0,D.jsxs)(Z.Z,{open:!0,title:"Compliance Score",children:[o&&(0,D.jsx)(qn,{onClick:function(){i.default.push("/dashboard/suppliers/view?id=".concat(t,"&tab=compliance"))},children:(0,D.jsx)(Qe.Z,Pn({tag:"h1"},a))}),(0,D.jsx)(Qe.Z,{content:"".concat(n.length," compliance item").concat(1!==n.length?"s":""),noMargin:!0,tag:"h4"}),r>0&&(0,D.jsx)(Qe.Z,{context:"danger",content:"".concat(r," expired"),noMargin:!0,tag:"h5"})]})},qn=Ye.ZP.a.withConfig({displayName:"rating__Styleda",componentId:"sc-tz7d1m-0"})(["cursor:pointer;text-decoration:none;"]),Dn=t(87883),kn=t(30381),Rn=t.n(kn),En=t(7755),Tn=function(e,n){if(Array.isArray(n)){var t=null;return n.forEach((function(n){var r=null===e||void 0===e?void 0:e.find((function(e){return e.status===n}));t=(null===r||void 0===r?void 0:r.createdAt)||t})),t}var r=null===e||void 0===e?void 0:e.find((function(e){return e.status===n}));return(null===r||void 0===r?void 0:r.createdAt)||null},Nn=t(83528),Fn=(0,ke.Ps)(Sn||(Sn=(0,De.Z)(["\n  mutation InsertStatusLog($objects: [StatusLog_insert_input!]!) {\n    insert_StatusLog(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),Ln=((0,ke.Ps)(Cn||(Cn=(0,De.Z)(['\n  mutation UpdateJob($id: Int!, $timing: [JobTiming_insert_input!]!) {\n    delete_JobTiming(where: { jobId: { _eq: $id }, status: { _eq: "validated" } }) {\n      returning {\n        jobId\n      }\n    }\n    insert_JobTiming(objects: $timing) {\n      returning {\n        id\n        status\n        createdAt\n      }\n    }\n  }\n']))),function(e){var n=e.status,t=e.entityId,r=e.entityName,i=e.refetch,o=e.toggleShow,a=(0,de.cI)({defaultValues:{notes:""}}),s=a.errors,c=a.handleSubmit,u=a.register,d=(0,L.D)(Fn,{onCompleted:function(){i&&i(),o()}}),l=(0,f.Z)(d,1)[0],m=function(){var e=(0,T.Z)(F().mark((function e(i){var o;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={entityId:t,entity:r,status:n,notes:i.notes},e.next=3,l({variables:{objects:[o]}});case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,D.jsx)(le.Z,{id:"offCanvasForm",handleSubmit:c(m),children:(0,D.jsx)(me.Z,{label:"Notes",children:(0,D.jsx)(Nn.Z,{errors:s,name:"notes",register:u,rows:4})})})}),Un=function(e,n,t){var r,o,a,s,c,u,d,l,m=(0,C.x)().hasRole,p="/dashboard/suppliers/",f=Tn(null===e||void 0===e?void 0:e.statusLogs,"supplierQuestionsSubmitted"),v=Tn(null===e||void 0===e?void 0:e.statusLogs,"supplierQuestionsApproved"),y=(0,Pe.WE)(e,"registered"),b=(0,Pe.WE)(e,"operating"),g=e.createdAt&&(null===(r=e.references[0])||void 0===r?void 0:r.createdAt)&&(null===y||void 0===y?void 0:y.createdAt)&&(null===(o=e.compliances[0])||void 0===o?void 0:o.createdAt)&&(null===(a=e.coverage[0])||void 0===a?void 0:a.createdAt)&&(null===(s=e.services[0])||void 0===s?void 0:s.createdAt)&&v,x=f&&!v&&"Questions were submitted",j=f&&!v&&"awaiting admin approval",I=function(e){e&&t()};return[{id:1,label:"Create account",date:e.createdAt},{id:2,label:"Complete profile",info:"",date:(null===y||void 0===y?void 0:y.createdAt)||null,actions:[{id:1,active:!0,content:"Registered address",context:"secondary",handleClick:function(){n.show({content:(0,D.jsx)(En.H,{addressId:null===y||void 0===y?void 0:y.address.id,entity:"Account",entityId:e.id,id:(null===y||void 0===y?void 0:y.id)||null,onSubmit:I,type:"registered"}),submit:!1,title:"Manage addresses"})},type:"button"},{id:2,active:!0,content:"Operating address",context:"secondary",handleClick:function(){n.show({content:(0,D.jsx)(En.H,{addressId:null===b||void 0===b?void 0:b.address.id,entity:"Account",entityId:e.id,id:(null===b||void 0===b?void 0:b.id)||null,onSubmit:I,type:"operating"}),submit:!1,title:"Manage addresses"})},type:"button"}]},{id:3,label:"Select service lines & coverage",info:"",date:(null===(c=e.coverage[0])||void 0===c?void 0:c.createdAt)&&(null===(u=e.services[0])||void 0===u?void 0:u.createdAt),actions:[{id:1,active:!0,content:"Service lines",context:"secondary",handleClick:function(){i.default.push("".concat(p,"view?id=").concat(e.id,"&tab=services"))},type:"button"},{id:2,active:!0,content:"Coverage",context:"secondary",handleClick:function(){n.show({title:"Add/Update Postcode Area",content:(0,D.jsx)(un,{accountId:e.id,refetch:t,offCanvas:n,type:"add",coveredAreas:e.coverage})})},type:"button"}]},{id:4,label:"Submit documents",info:"",date:(null===(d=e.references[0])||void 0===d?void 0:d.createdAt)&&(null===(l=e.compliances[0])||void 0===l?void 0:l.createdAt),actions:[{id:1,active:!0,content:"Compliances",context:"secondary",handleClick:function(){i.default.push("".concat(p,"view?id=").concat(e.id,"&tab=compliance"))},type:"button"},{id:2,active:m("admin"),content:"References",context:"secondary",handleClick:function(){n.show({title:"Reference",content:(0,D.jsx)(Ge,{accountId:e.id,success:function(){t(),n.close()}})})},type:"button"}]},{id:5,label:"Submit questionnaire",info:m("supplier")?j:x,date:v,content:[{id:1,active:!0,data:function(){return(0,D.jsx)(D.Fragment,{children:(0,D.jsxs)(ce.Z,{align:"flex-start",size:"xs",children:[m("admin")&&f&&!v&&(0,D.jsx)(h.Z,{content:"Approve",context:"primary",onClick:function(){return function(e){var n=e.status,t=e.statusTitle,r=e.entityId,i=e.entityName,o=e.offCanvas,a=e.refetch;o.show({content:(0,D.jsx)(Ln,{entityId:r,entityName:i,refetch:a,status:n,toggleShow:o.close}),title:t})}({status:"supplierQuestionsApproved",statusTitle:"Approve Questions",entityId:e.id,entityName:"Account",offCanvas:n,refetch:t})},size:"xs"}),(0,D.jsx)(h.Z,{content:"Question",context:"secondary",onClick:function(){return i.default.push("".concat(p,"view?id=").concat(e.id,"&tab=questions"))},size:"xs"})]})})}}]},{id:6,label:"Start receiving work",info:"accept job offers",date:g}]},Hn=function(e,n,t){var r=Un(e,n,t);return r.map((function(e){return e.date&&(e.date=Rn()(e.date).format("D MMM YYYY HH:mm")),e})),r},Mn=function(e){return[{label:"Account manager: ",value:e.manager?"".concat(e.manager.nameFirst," ").concat(e.manager.nameLast," "):"Unassigned"},{label:"Users: ",value:e.usersMeta?e.usersMeta.aggregate.count:0},{label:"Status: ",value:e.status||""}]},Gn=function(e){var n=e.supplier,t=e.refetch,r=(0,s.useContext)(H.Z);return(0,D.jsx)(Z.Z,{open:!0,title:"Profile",children:(0,D.jsx)(Dn.Z,{items:Hn(n,r,t),summary:Mn(n)},"stepper-".concat(n.id))})},Vn=t(89331),zn=function(e){var n=e.hasRole,t=e.isSupplier,r=e.refetch,i=e.supplier,s=(0,Pe.WE)(i,"registered"),c=(0,Pe.WE)(i,"operating");return(0,D.jsxs)(o.Z,{children:[(0,D.jsxs)(a.Z,{md:4,children:[(0,D.jsx)(qe.g,{avatar:(0,Ce.Q)(i.media),editable:n("admin"),entity:i,entityName:"Account",icons:n("admin")?(0,Vn.Y)(i):[]}),(0,D.jsx)(Zn.D,{supplier:i}),(0,D.jsx)(_n.T,{supplier:i}),s&&(0,D.jsx)(we.f,{address:s.address,entity:"Account",entityId:i.id,id:s.id,refetch:r,title:"Registered Address",type:"registered"}),c&&(0,D.jsx)(we.f,{address:c.address,entity:"Account",entityId:i.id,id:c.id,refetch:r,title:"Operating Address",type:"operating"}),n("admin")&&(0,D.jsx)(Se.E,{entity:"Account",entityId:i.id,open:!0,title:"Notes"})]}),(0,D.jsx)(a.Z,{md:4,children:(0,D.jsx)(Gn,{refetch:r,supplier:i})}),(0,D.jsxs)(a.Z,{md:4,children:[(0,D.jsx)($e.G,{details:!0,entity:"Account",entityId:i.id}),(0,D.jsx)(On,{refetch:r,supplier:i},"coverage-".concat(i.id)),(0,D.jsx)(Ve,{accountId:i.id,edit:!t,open:!0},"references-".concat(i.id)),(0,D.jsx)($n,{compliances:i.compliances,supplierId:i.id})]})]})},Jn=t(38094),Bn=t(47400),Qn=function(e){var n=e.supplier,t=(0,c.a)(Jn.Dn,{variables:{accountId:n.id}}),r=t.data,i=(r=void 0===r?{financial:{bankAccounts:[]}}:r).financial.bankAccounts,o=t.loading,a=t.refetch;return o?null:(0,D.jsx)(Bn.y,{edit:!0,accountId:n.id,data:i,refetch:a})},Wn=t(81167),Yn=t(66238),Xn=t(1032),Kn=t(69399);function et(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function nt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?et(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):et(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var tt=function(e){var n=e.control,t=e.errors,r=e.initialValues,i=e.register,c=e.setFilters,u=(e.setValue,e.watch),l=(0,s.useContext)(d.Z).hasRole,m={control:n,errors:t,register:i},p=u("customerId"),f=u("supplierId"),v=!r.customerId,y=ee.E6.map((function(e){return l("admin")?e:{text:e.customerText,value:e.value}})),b=[{text:"Status",value:""}].concat((0,Q.Z)(y)).filter((function(e,n,t){return!!l("admin")||t.findIndex((function(n){return n.text===e.text}))===n}));(0,s.useEffect)((function(){v&&c((function(e){return nt(nt({},e),{},{customerId:(null===p||void 0===p?void 0:p.value)||null})}))}),[p]),(0,s.useEffect)((function(){v&&c((function(e){return nt(nt({},e),{},{supplierId:(null===f||void 0===f?void 0:f.value)||null})}))}),[f]);var h=function(e){var n;switch(e){case"quoteNew":n=["quoteNew","quoteOffered","quoteReceived"];break;default:n=e}return n};return(0,D.jsx)(D.Fragment,{children:(0,D.jsx)(o.Z,{align:"baseline",children:(0,D.jsx)(a.Z,{md:6,children:(0,D.jsx)(Kn.r,nt(nt({},m),{},{errors:t,onChange:function(e){return l("admin")?c((function(n){return nt(nt({},n),{},{status:e.target.value||null})})):c((function(n){return nt(nt({},n),{},{status:h(e.target.value)||null})}))},options:b,register:i}))})})})},rt=t(70316),it=t(93515),ot=t(95146),at=t(83894),st=t(76800),ct=t(80937);function ut(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function dt(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?ut(Object(t),!0).forEach((function(n){(0,p.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ut(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var lt=function(e){var n=e.initialValues,t=e.control,r=e.errors,i=e.register,c=e.setFilters,u=e.watch,l=e.setValue,m=(0,s.useContext)(d.Z).hasRole,p={control:t,errors:r,register:i},f=u("userId");return(0,s.useEffect)((function(){c((function(e){return dt(dt({},e),{},{userId:"number"===typeof f?f:(null===f||void 0===f?void 0:f.value)||null})}))}),[f]),m("admin")&&(0,D.jsx)(o.Z,{children:(0,D.jsx)(a.Z,{md:12,children:(0,D.jsxs)(o.Z,{children:[(0,D.jsx)(a.Z,{md:6,children:(0,D.jsx)(st.M,dt(dt({},p),{},{name:"startDate",onChange:function(e){c((function(n){return dt(dt({},n),{},{startDate:e||null})})),l("startDate",e)},placeholder:"Start date"}))}),(0,D.jsx)(a.Z,{md:6,children:(0,D.jsx)(st.M,dt(dt({},p),{},{name:"endDate",onChange:function(e){var n=e?(0,at.Z)(e):e;c((function(e){return dt(dt({},e),{},{endDate:n})})),l("endDate",n)},placeholder:"End date"}))}),(0,D.jsx)(a.Z,{md:6,children:(0,D.jsx)(me.Z,{label:null,children:(0,D.jsx)(it.Z,dt(dt({},p),{},{placeholder:"Select status",name:"status",isMulti:!0,onChange:function(e){var n=e.map((function(e){return e.value}));c((function(e){return dt(dt({},e),{},{status:n.length>0?n:null})})),l("status",e)},options:ee.yW.map((function(e){return{label:e.text,value:e.value}}))}))})}),m("admin")&&(0,D.jsx)(a.Z,{md:6,children:(0,D.jsx)(me.Z,{label:null,children:(0,D.jsx)(it.Z,dt(dt({},p),{},{placeholder:"Select type",name:"type",isMulti:!0,onChange:function(e){var n=e.map((function(e){return e.value}));c((function(e){return dt(dt({},e),{},{type:n.length>0?n:null})})),l("type",e)},options:ct.O.map((function(e){return{label:e.text,value:e.value}}))}))})}),(0,D.jsx)(a.Z,{md:6,children:(0,D.jsx)(ot.P,dt(dt({},p),{},{errors:dt({},r),label:null,userId:n.supplierId,name:"userId",placeholder:"Select user",type:"usersForBookings"}))})]})})})},mt=function(e){var n=e.id,t=e.isSupplier,r=e.adminId,p=(0,s.useContext)(d.Z).hasRole,f=(0,i.useRouter)().query,v=(0,c.a)(u.l1,{variables:{id:n}}),y=v.loading,b=v.refetch,h=v.data,g=(h=void 0===h?{supplier:{}}:h).supplier,x={adminId:r,supplierId:n},j=(0,s.useMemo)((function(){return f.tab||"details"}),[f.tab]);return!y&&(0,D.jsxs)(l.Z,{children:[(0,D.jsx)("div",{active:"details"===j||!j,label:"Details",children:(0,D.jsx)(zn,{hasRole:p,isSupplier:t,refetch:b,supplier:g})}),(0,D.jsx)("div",{active:"finance"===j,label:"Finance",children:(0,D.jsx)(Qn,{supplier:g})}),(0,D.jsx)("div",{active:"users"===j,label:"Users",children:(0,D.jsx)(Wn.P,{accountType:"supplier",filters:{accountId:g.id}})}),(0,D.jsx)("div",{active:"services"===j,label:"Services",children:(0,D.jsx)(Ie,{edit:!t,entity:"Account",entityId:g.id,type:"supplier"})}),(0,D.jsx)("div",{active:"compliance"===j,label:"Compliance",children:(0,D.jsx)(ae.M,{entity:"Account",entityId:g.id})}),(0,D.jsx)("div",{active:"bookings"===j,label:"Bookings",children:(0,D.jsx)(rt.J,{FiltersComp:lt,initialFilters:{supplierId:g.id,jobNumber:null,invoiceNumber:null,userId:null,filterType:"bookings_tab"},TableComp:E})}),(0,D.jsx)("div",{active:"quotations"===j,label:"Quotations",children:(0,D.jsx)(rt.J,{FiltersComp:tt,initialFilters:{supplierId:g.id,customerId:null,status:null,id:null,filterType:"quotations_tab"},TableComp:oe})}),(0,D.jsx)("div",{active:"questions"===j,label:"Questions",children:(0,D.jsx)(B,{accountId:g.id,statusLogs:g.statusLogs,refetch:b})}),(0,D.jsx)("div",{active:"planned-maintenance"===j,label:"Planned Maintenance",children:(0,D.jsx)(m.F,{supplierId:g.id})}),(0,D.jsx)("div",{active:"data"===j,label:"Data",children:(0,D.jsxs)(o.Z,{children:[(0,D.jsx)(a.Z,{md:6,children:(0,D.jsx)(Xn.m,{filters:x})}),(0,D.jsx)(a.Z,{md:6,children:(0,D.jsx)(Yn.e,{filters:x})})]})})]},j)},pt=function(){var e=(0,i.useRouter)().query,n=(0,C.x)(),t=n.hasRole,r=n.user,s=!t("admin")&&t("supplier");return(0,D.jsx)(o.Z,{children:(0,D.jsx)(a.Z,{md:12,children:(0,D.jsx)(mt,{id:s?r.accountId:e.id,isSupplier:s,adminId:r.adminId})})})},ft=function(){return(0,D.jsx)(r.Z,{View:(0,D.jsx)(pt,{})})}},35069:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/suppliers/view",function(){return t(71248)}])}},function(e){e.O(0,[367,6898,284,4195,5312,7287,2002,3086,7134,3486,9082,3515,4712,1265,6996,9666,4177,7431,5597,8158,7615,999,5536,5927,899,3016,1110,9431,9774,2888,179],(function(){return n=35069,e(e.s=n);var n}));var n=e.O();_N_E=n}]);