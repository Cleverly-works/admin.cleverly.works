(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2744],{93633:function(e,t,n){"use strict";n.d(t,{a:function(){return o}});var r=n(81322);function o(e,t){return(0,r.r)(e,t,!1)}},71247:function(e,t,n){"use strict";var r=n(87462),o=n(70885),i=n(45987),a=n(67294),s=n(45697),c=n(42778),l=n(82373),u=n(49787),d=["disabled","errors","helperMessage","name","placeholder","readOnly","regExp","register","size","validate","withAddon"],f=function(e){var t=e.disabled,n=e.errors,s=e.helperMessage,l=e.name,f=e.placeholder,p=e.readOnly,g=(e.regExp,e.register),b=e.size,v=(e.validate,e.withAddon),m=(0,i.Z)(e,d),y=(0,a.useState)(!1),h=(0,o.Z)(y,2),O=h[0],w=h[1];return a.createElement(c.Z,(0,r.Z)({"aria-label":l,component:u.Z,disabled:t,helperMessage:s,onKeyDown:function(e){w(!0)},onBlur:function(){w(!1)},errors:n[l],isTyping:O,key:l,name:l,placeholder:f,readOnly:p,register:g,size:b,withAddon:v},m))};f.displayName="FormField",f.propTypes={accept:s.string,autoComplete:(0,s.oneOfType)([s.bool,s.string]),autoFocus:s.bool,disabled:s.bool,errors:s.object.isRequired,helperMessage:s.string,label:s.string,name:s.string.isRequired,placeholder:s.string,readOnly:s.bool,register:s.func.isRequired,size:(0,s.oneOf)([l.Z.SM,l.Z.MD,l.Z.LG]),style:s.object,textAlign:s.string,type:s.string,value:(0,s.oneOfType)([s.string,s.number,s.bool,(0,s.arrayOf)((0,s.oneOfType)([s.string,s.number,s.bool]))])},f.defaultProps={autoComplete:"off",autoFocus:!1,disabled:!1,errors:{},readOnly:!1,type:"text"},t.Z=f},49787:function(e,t,n){"use strict";var r,o,i,a,s,c,l=n(30168),u=n(24237),d=n(38425),f=n(88280),p=n(82373),g=u.ZP.input.attrs((function(e){return{autoComplete:"off",autoFocus:!1}}))(r||(r=(0,l.Z)(["\n  ","\n\n  ","\n\n    ","\n"])),(function(e){return(0,d.Z)(e)}),(function(e){return e.errors&&(0,u.iv)(o||(o=(0,l.Z)(["\n      ","\n    "])),(function(e){return(0,f.Z)(e)}))}),(function(e){switch(e.size){case p.Z.SM:return(0,u.iv)(i||(i=(0,l.Z)(["\n          height: 1.5rem;\n        "])));case p.Z.MD:return(0,u.iv)(a||(a=(0,l.Z)(["\n          height: 1.875rem;\n        "])));case p.Z.LG:return(0,u.iv)(s||(s=(0,l.Z)(["\n          height: 2.25rem;\n        "])));default:return(0,u.iv)(c||(c=(0,l.Z)(["\n          height: 2.25rem;\n        "])))}}));t.Z=g},21269:function(e,t,n){"use strict";var r,o,i,a,s,c=n(30168),l=n(67294),u=n(45697),d=n(24237),f=n(37815),p=n(82373),g=function(e){var t=e.addonType,n=(e.className,e.children),r=e.context,o=e.error,i=e.size,a=e.text,s=e.theme;return l.createElement(b,{addonType:t,className:t,children:n,context:r,error:o,size:i,text:a,theme:s})};g.displayName="InputGroupAddon";var b=d.ZP.div(r||(r=(0,c.Z)(["\n  align-items: center;\n  display: flex;\n\n  & > * {\n    height: 100%;\n  }\n\n  ","\n  ","\n\n  &,\n  button {\n    ","\n\n    ","\n  }\n"])),(function(e){var t=e.theme,n=t.COLOUR,r=t.FORM_ELEMENTS_STYLES,i=e.error;return e.text&&(0,d.iv)(o||(o=(0,c.Z)(["\n      background-color: ",";\n      border: 1px solid ",";\n      border-radius: ",";\n      color: ",";\n      display: flex;\n      font-size: 0.75rem;\n      font-weight: 400;\n      line-height: 1;\n      margin-bottom: 0;\n      padding: 0.375rem 1rem;\n      text-align: center;\n      transition: background-color 0.15s linear;\n      white-space: nowrap;\n    "])),i?n.danger:n.light,i?n.danger:n.dark,r.inputBorderRadius,i?n.light:n.dark)}),(function(e){return e.size===p.Z.SM&&(0,d.iv)(i||(i=(0,c.Z)(["\n      font-size: 0.625rem;\n      padding: 0 0.75rem;\n    "])))}),(function(e){return"prepend"===e.addonType&&(0,d.iv)(a||(a=(0,c.Z)(["\n        border-top-right-radius: 0;\n        border-bottom-right-radius: 0;\n        margin-right: -1px;\n      "])))}),(function(e){return"append"===e.addonType&&(0,d.iv)(s||(s=(0,c.Z)(["\n        border-top-left-radius: 0;\n        border-bottom-left-radius: 0;\n        margin-left: -1px;\n      "])))}));g.propTypes={addonType:(0,u.oneOf)(["prepend","append"]),className:u.any,children:u.node,context:(0,u.oneOf)(Object.values(f.Z)),text:u.bool},g.defaultProps={addonType:"append",context:"light"},t.Z=g},44442:function(e,t,n){"use strict";var r,o,i=n(30168),a=n(67294),s=n(45697),c=n(24237),l=function(e){var t=e.children,n=e.error,r=e.fullWidth,o=e.size,i=e.theme;return a.createElement(u,{children:t,error:n,fullWidth:r,size:o,theme:i})};l.displayName="InputGroup";var u=c.ZP.div(r||(r=(0,i.Z)(["\n  align-items: stretch;\n  display: flex;\n  flex-wrap: wrap;\n  position: relative;\n  width: 100%;\n\n  input {\n    ","\n    min-width: 0;\n    margin-bottom: 0;\n    position: relative;\n\n    :not(:first-child) {\n      border-top-left-radius: 0;\n      border-bottom-left-radius: 0;\n    }\n\n    :first-child {\n      border-top-right-radius: 0;\n      border-bottom-right-radius: 0;\n    }\n\n    :not(:last-child) {\n      border-top-right-radius: 0;\n      border-bottom-right-radius: 0;\n    }\n  }\n  ","\n"])),(function(e){return e.fullWidth?"flex: 1 1 0%;":"width: auto;"}),(function(e){var t=e.error,n=e.theme;return t&&n&&(0,c.iv)(o||(o=(0,i.Z)(["\n      &:hover {\n        .prepend,\n        .append {\n          background: ",";\n          border-color: ",";\n        }\n      }\n    "])),n.COLOUR.danger,n.COLOUR.danger)}));l.propTypes={fullWidth:s.bool,size:s.string},l.defaultProps={fullWidth:!0,size:"md"},t.Z=l},65375:function(e,t,n){"use strict";var r,o=n(30168),i=n(67294),a=n(45697),s=n(24237),c=n(22796),l=n(18944),u=function(e){var t=e.children,n=e.id,r=e.label,o=e.show,a=e.size;return i.createElement(d,{hasChild:t,htmlFor:n,show:o},i.createElement(c.Z,{marginBottom:"xs"},i.createElement(l.Z,{size:null!==a&&void 0!==a?a:"md",colour:"darkText",content:r})),t)};u.displayName="FormLabel";var d=s.ZP.label(r||(r=(0,o.Z)(["\n  display: ",";\n  margin-bottom: ",";\n  .react-datepicker-wrapper {\n    width: 100%;\n  }\n"])),(function(e){return e.show?"block":"none"}),(function(e){return e.hasChild?"1rem":"0"}));u.propTypes={children:a.node,id:a.string,label:a.string,show:a.bool},u.defaultProps={show:!0},t.Z=u},91126:function(e,t,n){"use strict";n.d(t,{Z:function(){return j}});var r=n(67294),o=n(45697),i=n(58448),a=n(37815),s=n(71070),c=function(e){var t=e.children,n=e.tooltip;return r.createElement(s.Z,{content:n},t)};c.displayName="TableActionsTooltip",c.propTypes={children:o.node.isRequired,tooltip:o.string.isRequired};var l,u,d=c,f=n(30168),p=n(11163),g=n(24237),b=n(14347),v=n(55657),m=(0,r.forwardRef)((function(e,t){var n,o=e.context,i=e.disabled,a=e.icon,s=e.numberOverlay,c=e.onClick,l=e.overlayCustom,u=e.row,d=e.to,f=Array.isArray(a),g=u[s]||l,b=c?function(e){return c(e,u)}:(n="".concat(d,"?id=").concat(u.id),function(e){e.preventDefault(),e.stopPropagation(),p.default.push(n)});return r.createElement(y,{forwardedAs:"a",context:o,disabled:i,itemCount:g,onClick:b,ref:t,size:"sm"},r.createElement(h,{icon:a?f?a[1]:a:null,prefix:a&&f&&a[0]}))})),y=(0,g.ZP)(b.Z)(l||(l=(0,f.Z)(["\n  font-size: 14px;\n  padding: 0.5rem;\n  position: relative;\n"]))),h=(0,g.ZP)(v.Z)(u||(u=(0,f.Z)(["\n  pointer-events: 'none';\n"])));m.propTypes={context:(0,o.oneOf)(Object.values(a.Z)),disabled:o.bool,icon:(0,o.oneOfType)([o.array,o.string]),numberOverlay:o.string,onClick:o.func,overlayCustom:o.string,row:o.object.isRequired,to:o.string};var O=m,w=function(e){var t,n=e.align,o=e.data,a=e.row;return t="function"===typeof o?o()(a):o,r.createElement(i.Z,{align:n},t.map((function(e,t){var n=e.context,o=e.disabled,i=e.icon,s=e.numberOverlay,c=e.onClick,l=e.overlayCustom,u=e.to,f=e.tooltip;return r.createElement(d,{key:t,tooltip:f},r.createElement(O,{context:n,disabled:o,icon:i,numberOverlay:s,onClick:c,overlayCustom:l,row:a,to:u}))})))};w.displayName="TableActions",w.propTypes={align:o.string,data:(0,o.arrayOf)((0,o.shape)({content:o.string,context:(0,o.oneOf)(Object.values(a.Z)),disabled:o.bool,icon:(0,o.oneOfType)([o.array,o.string]),numberOverlay:o.string,onClick:o.func,overlayCustom:o.string,to:o.string,tooltip:o.string})).isRequired,row:o.object.isRequired},w.defaultProps={align:"flex-start"};var j=w},18862:function(e,t,n){"use strict";var r=n(64509);t.Z=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Date(e),o=n.getFullYear(),i=""+(n.getMonth()+1),a=""+n.getDate();i.length<2&&(i="0"+i),a.length<2&&(a="0"+a);var s=[o,i,a].join("-");return t?s+" "+(0,r.Z)(e):s}},64509:function(e,t){"use strict";t.Z=function(e){var t=new Date(e),n=""+t.getHours(),r=""+t.getMinutes();return n.length<2&&(n="0"+n),r.length<2&&(r="0"+r),"".concat(n,":").concat(r)}},63867:function(e,t){"use strict";t.Z=function(e){var t=window.location,n=t.protocol,r=t.host,o=t.pathname,i="".concat(n,"//").concat(r).concat(o).concat(e);window.history.pushState({path:i},"",i)}},66805:function(e,t,n){"use strict";n.d(t,{H:function(){return u}});var r=n(92809),o=n(77417),i=n(58448),a=n(14347),s=n(85893);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=function(e){var t=e.children,n=e.content,r=e.context,c=e.data,u=e.disabled,d=e.handleClick,f=e.size,p=e.type;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{size:"sm"}),(0,s.jsxs)(i.Z,{align:"flex-end",children:[t,(0,s.jsx)(a.Z,l({content:n,context:r,disabled:u,onClick:d,size:f,type:p},c))]})]})};u.defaultProps={content:"Add",context:"secondary",disabled:!1,size:"sm",type:"button"}},69399:function(e,t,n){"use strict";n.d(t,{r:function(){return i}});var r=n(46482),o=n(85893),i=function(e){var t=e.errors,n=e.name,i=e.onChange,a=e.options,s=e.register;return(0,o.jsx)(r.Z,{errors:t,name:n,onChange:i,options:a,register:s})};i.defaultProps={name:"status"}},8163:function(e,t,n){"use strict";n.d(t,{t:function(){return r}});var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return[{context:"secondary",icon:["fas","edit"],onClick:t.onEditClick,to:"".concat(e,"manage"),tooltip:"Edit"}]}},81185:function(e,t,n){"use strict";n.d(t,{t:function(){return c}});var r=n(67294),o=n(11163),i=n(30493),a=n(52002),s=n(85893),c=(0,r.forwardRef)((function(e,t){var n=e.columns,c=e.history,l=e.initialSort,u=e.isResetTable,d=e.loading,f=e.meta,p=e.paginationSize,g=e.refetch,b=e.rowClick,v=e.rows,m=(0,o.useRouter)(),y=m.query,h=void 0===y?{}:y,O=(0,r.useState)(parseInt(null===h||void 0===h?void 0:h.page,10)||1),w=O[0],j=O[1],Z=(0,r.useState)(i.C1.paginationSize),S=Z[0],x=Z[1];l||(l={item:"createdAt",order:"desc"}),(0,r.useEffect)((function(){j(1)}),[u]);var P=(0,r.useState)({item:l.item,order:l.order}),k=P[0],C=P[1],A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=m.query,n=void 0===t?{}:t;e>1?n.page=e:delete n.page;var r=Object.keys(n).length>0;if(r){var o=Object.keys(n).map((function(t){return"page"===t?"".concat(t,"=").concat(e):"".concat(t,"=").concat(n[t])})).join("&&");return"?".concat(o)}return{}};(0,r.useImperativeHandle)(t,(function(){return{currentPage:w,pageSize:S,sort:k,resetPagination:function(){!function(){C({item:l.item,order:l.order}),j(1);var e=A();m.push(e),x(i.C1.paginationSize)}()}}}));return(0,s.jsx)(a.Z,{columns:n,loading:d,paginationSize:p,pagination:f&&!0,paginationProps:f&&{currentPage:w,onPageChange:function(e){var t=A(e);c&&m.push(t),j(e),g&&g()},onPageSizeChange:function(e){e!==i.C1.paginationSize&&(x(e),g&&g())},pageCount:Math.ceil(f.aggregate.totalCount/S),perPage:S},rowClick:b,rows:v,sort:k,setSort:function(e){var t=e.item,n=e.order;C({item:t,order:n}),g&&g()}})}));c.defaultProps={history:!0,loading:!0,paginationSize:!1}},49705:function(e,t,n){"use strict";n.d(t,{x:function(){return u}});var r=n(92809),o=n(67294),i=n(63867),a=n(30493),s=n(34770);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var u=function(e){var t,n,c,u,d,f,p,g,b,v,m,y=e.filters,h=e.initialSort,O=(0,o.useRef)();(0,o.useEffect)((function(){var e;(null===O||void 0===O||null===(e=O.current)||void 0===e?void 0:e.currentPage)>1&&(null===O||void 0===O||O.current.resetPagination(),(0,i.Z)("?page=1"))}),[y]);var w=h||{item:"createdAt",order:"desc"},j=(0,r.Z)({},(null===(t=O.current)||void 0===t?void 0:t.sort.item)||w.item,w.inneritem?(0,r.Z)({},w.inneritem,(null===(n=O.current)||void 0===n?void 0:n.sort.order)||w.order):(null===(c=O.current)||void 0===c?void 0:c.sort.order)||w.order);return{initialData:l(l({},y),{},{limit:"Infinity"===(null===(u=O.current)||void 0===u?void 0:u.pageSize)?null:parseInt(null===(d=O.current)||void 0===d?void 0:d.pageSize,10)||a.C1.paginationSize,offset:((null===(f=O.current)||void 0===f?void 0:f.currentPage)-1||0)*((null===(p=O.current)||void 0===p?void 0:p.pageSize)||a.C1.paginationSize),orderBy:(0,s.c)(null===(g=O.current)||void 0===g||null===(b=g.sort)||void 0===b||null===(v=b.item)||void 0===v?void 0:v.replace(/ORDER/i,null===(m=O.current)||void 0===m?void 0:m.sort.order))||j}),initialSort:h,ref:O}}},34770:function(e,t,n){"use strict";n.d(t,{s:function(){return r},c:function(){return o}});var r=function(e){try{JSON.parse(e)}catch(t){return!1}return!0},o=function(e){try{return JSON.parse(e)}catch(t){return!1}}},51681:function(e,t,n){"use strict";n.d(t,{qZ:function(){return r},Me:function(){return o},aW:function(){return i}});var r=[{entity:"Asset",event:"assetVacated",title:"Asset Vacated"},{entity:"Job",event:"issueReported",title:"Issue reported"},{entity:"Job",event:"jobRaised",title:"Job raised"},{entity:"Job",event:"supplierBookingAccepted",title:"Supplier accepted job offer"},{entity:"Job",event:"jobCompleted",title:"Supplier completed job"},{entity:"Job",event:"jobReportSent",title:"Supplier sent job report"},{entity:"Job",event:"jobCustomerPaid",title:"Customer paid invoice"},{entity:"Job",event:"jobDisputeAdded",title:"Job dispute submitted"},{entity:"Job",event:"quoteCreated",title:"Quote Created"},{entity:"Job",event:"quoteAccepted",title:"Quote accepted by customer"},{entity:"Job",event:"quoteRejected",title:"Quote rejected by customer"},{entity:"Sensor",event:"sensorOutOfBounds",title:"Sensor out of bounds"},{entity:"Supplier",event:"supplierCreated",title:"New supplier registered"},{entity:"Supplier",event:"supplierProfileCompleted",title:"Supplier completed profile"}],o=[{entity:"Account",for:["Asset","Job","Sensor"],name:"customer",title:"Customer is",type:"select"},{entity:"Account",for:["Job"],name:"supplier",title:"Supplier is",type:"select"},{entity:"Location",for:["Asset","Job","Sensor"],name:"property",title:"Property is",type:"select"},{entity:"Service",for:["Job"],name:"service",title:"Service line is",type:"select"},{entity:"Asset",for:["Asset","Job","Sensor"],name:"asset",title:"Asset is",type:"select"},{entity:"Sensor",for:["Sensor"],name:"sensor",title:"Sensor is",type:"select"},{entity:"Sensor",for:["Sensor"],name:"sensorAbove",title:"Sensor reading is above",type:"text"},{entity:"Sensor",for:["Sensor"],name:"sensorBelow",title:"Sensor reading is below",type:"text"},{entity:"SLA",for:["Job"],name:"sla",title:"Priority is",type:"select"},{entity:"User",for:["Job","Supplier"],name:"manager",title:"Assigned to manager",type:"select"},{entity:"Job",for:["Job"],name:"title",title:"Job title contains",type:"text"},{entity:"Job",for:["Job"],name:"description",title:"Job description contains",type:"text"},{entity:"PostcodeArea",for:["Asset","Supplier","Sensor"],name:"coverage",title:"Coverage area is",type:"select"},{entity:"Address",for:["Supplier","Sensor"],name:"city",title:"City is",type:"text"}],i=[{action:"createJob",entity:"Job",for:["Asset","Sensor"],title:"Create a new job",type:"none"},{action:"assignManager",entity:"User",for:["Asset","Job","Supplier","Sensor"],name:"manager",title:"Assign Manager",type:"select"},{action:"assignSupplier",entity:"Account",for:["Asset","Job","Sensor"],name:"supplier",title:"Assign Supplier",type:"select"},{action:"assignPriority",entity:"SLA",for:["Asset","Job","Sensor"],name:"sla",title:"Assign Priority",type:"select"},{action:"createTask",entity:"Task",for:["Asset","Job","Supplier","Sensor"],name:"task",title:"Create a new task",type:"text"},{action:"sendReminder",entity:"Communication",for:["Job","Supplier"],name:"message",title:"Send a reminder",type:"text"}]},30016:function(e,t,n){"use strict";n.d(t,{Z3:function(){return l},CS:function(){return u},mJ:function(){return f}});var r,o,i,a,s=n(52209),c=n(54397),l=(0,c.Ps)(r||(r=(0,s.Z)(["\n  fragment WorkflowFields on Workflow {\n    id\n    title\n    event\n    status\n    createdAt\n  }\n"]))),u=(0,c.Ps)(o||(o=(0,s.Z)(["\n  fragment WorkflowActionFields on WorkflowAction {\n    id\n    action\n    actionEntity\n    actionEntityId\n    actionValue\n    createdAt\n  }\n"]))),d=(0,c.Ps)(i||(i=(0,s.Z)(["\n  fragment WorkflowConditionFields on WorkflowCondition {\n    id\n    condition\n    conditionEntity\n    conditionEntityId\n    conditionValue\n    createdAt\n  }\n"]))),f=(0,c.Ps)(a||(a=(0,s.Z)(["\n  query GetWorkflow($id: Int!) {\n    workflow: Workflow_by_pk(id: $id) {\n      ...WorkflowFields\n      actions: WorkflowActions {\n        ...WorkflowActionFields\n      }\n      conditions: WorkflowConditions {\n        ...WorkflowConditionFields\n      }\n    }\n  }\n  ","\n  ","\n  ","\n"])),l,u,d)},75838:function(e,t,n){"use strict";n.d(t,{bg:function(){return r},WG:function(){return o}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],o=[{text:"Status",value:""},{text:"Open",value:"open"},{text:"Resolved",value:"resolved"},{text:"Closed",value:"closed"}]},70316:function(e,t,n){"use strict";n.d(t,{J:function(){return C}});var r=n(92809),o=n(80318),i=n(10219),a=n(11163),s=n(67294),c=n(78215),l=n(2356),u=n(42283),d=n(97202),f=n(80284),p=n(65375),g=n(10973),b=n(14347),v=n(66805),m=n(69119),y=n(23855),h=n(83894);function O(e,t,n){var r=(0,s.useState)((function(){if(JSON.parse(window.sessionStorage.getItem(e))&&!Object.values(JSON.parse(window.sessionStorage[e])).includes(n))return t;try{var r=JSON.parse(window.sessionStorage.getItem(e));return r&&(r.startDate=r.startDate?(0,m.Z)((0,y.Z)(r.startDate)):null,r.endDate=r.endDate?(0,h.Z)((0,y.Z)(r.endDate)):null),r||t}catch(o){return console.log(o),t}})),o=r[0],i=r[1];return[o,function(t){try{var n=t instanceof Function?t(o):t;i(n),window.sessionStorage.setItem(e,JSON.stringify(n))}catch(r){console.log(r)}}]}var w=n(85893);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var S=function(e){var t=e.initialValues,n=e.renderFilters,r=e.setFilters,i=e.lastQuery,a=e.filters,m=t.filterType,y=O("form_data",t,m),h=(0,o.Z)(y,2),j=h[0],S=h[1],x=(0,u.cI)({defaultValues:j||t}),P=x.control,k=x.errors,C=x.handleSubmit,A=x.register,E=x.reset,J=x.watch,D=x.setValue,T=Z(Z({},J()),{},{filterType:m});(0,s.useEffect)((function(){E(T)}),[E]),(0,s.useEffect)((function(){S(T)}),[a]);var z=function(e){var n=e.query;if(n!==i){var o={q:"%".concat(n,"%")||0},a=/^\d+$/.test(n);"id"in t&&(o.id=a?Number(n):null),"meta"in t&&(o.meta=a?{invoiceNumbers:[n]}:null),"jobNumber"in t&&(o.jobNumber=a?String(n):null,o.invoiceNumber=a?Number(n):null),(o.id||o.meta||o.jobNumber)&&(o.q=null),r((function(e){return Z(Z({},e),o)}))}};return(0,w.jsx)(d.Z,{handleSubmit:C(z),children:(0,w.jsxs)(f.Z,{title:"Filters",children:[(0,w.jsxs)(c.Z,{children:[(0,w.jsx)(l.Z,{sm:12,lg:12,children:(0,w.jsx)(p.Z,{label:"",children:(0,w.jsx)(g.Z,{errors:k,label:"Search",name:"email",placeholder:"Search...",prependSearchIcon:!0,register:A,type:"search"})})}),(0,w.jsx)(l.Z,{sm:12,lg:12,children:n({control:P,errors:k,initialValues:t,register:A,setFilters:r,watch:J,setValue:D,reset:E})})]}),(0,w.jsx)(v.H,{content:"Search",context:"secondary",handleClick:z,type:"submit",children:(0,w.jsx)(b.Z,{content:"Clear",context:"danger",onClick:function(e){Object.keys(t).map((function(e){return D(e,null)})),r(t),E(t),z("")},size:"sm"})})]})})},x=["FiltersComp","initialFilters","TableComp"];function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var C=function(e){var t=e.FiltersComp,n=e.initialFilters,r=e.TableComp,u=(0,i.Z)(e,x),d=O("filters",n,n.filterType),f=(0,o.Z)(d,2),p=f[0],g=f[1],b=(0,s.useState)(p||n),v=b[0],m=b[1],y=(0,a.useRouter)().query.show;return(0,s.useEffect)((function(){g(v)}),[v]),(0,w.jsx)(c.Z,{children:(0,w.jsxs)(l.Z,{sm:12,lg:12,children:[(0,w.jsx)(S,{initialValues:n,renderFilters:function(e){return(0,w.jsx)(t,k(k(k({},e),u),{},{show:y}))},setFilters:m,filters:v}),(0,w.jsx)(r,k({filters:v,initialFilters:n},u))]})})}},70892:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return q}});var r,o=n(66918),i=n(70316),a=n(11163),s=n(93633),c=n(52209),l=n(54397),u=n(30016),d=(0,l.Ps)(r||(r=(0,c.Z)(["\n  query GetWorkflows(\n    $action: String\n    $event: String\n    $limit: Int\n    $offset: Int\n    $orderBy: Workflow_order_by!\n    $q: String\n    $status: String\n  ) {\n    workflows: Workflow(\n      limit: $limit\n      offset: $offset\n      order_by: [$orderBy]\n      where: {\n        WorkflowActions: { action: { _eq: $action } }\n        event: { _eq: $event }\n        title: { _ilike: $q }\n        status: { _eq: $status }\n      }\n    ) {\n      ...WorkflowFields\n      actions: WorkflowActions {\n        ...WorkflowActionFields\n      }\n    }\n    meta: Workflow_aggregate(\n      where: {\n        WorkflowActions: { action: { _eq: $action } }\n        event: { _eq: $event }\n        title: { _ilike: $q }\n        status: { _eq: $status }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n  ","\n  ","\n"])),u.Z3,u.CS),f=n(91126),p=n(18862),g=n(58448),b=n(14347),v=n(80284),m=n(8163),y=n(51681),h=n(81185),O=n(49705),w=n(85893),j="/dashboard/workflows/",Z=function(e){var t=e.filters,n=(0,O.x)({filters:t}),r=n.initialData,o=n.ref,i=(0,s.a)(d,{variables:r}),c=i.data,l=(c=void 0===c?{workflows:[],meta:{aggregate:{totalCount:0}}}:c).workflows,u=c.meta,Z=i.loading,S=i.refetch,x=[{hidden:!0},{text:"Workflow"},{text:"Event"},{text:"Action"},{text:"Status"},{text:"Created",sortable:!0,sortName:"createdAt"},{formatter:f.Z,formatterData:(0,m.t)(j),text:"Actions"}],P=function(e){e.stopPropagation(),a.default.push("".concat(j,"manage"))},k=function(){return(0,w.jsx)(g.Z,{children:(0,w.jsx)(b.Z,{context:"secondary",content:"Create Workflow",onClick:P,size:"sm"})})};return(0,w.jsx)(v.Z,{toolbar:(0,w.jsx)(k,{}),open:!0,title:"Workflows",children:(0,w.jsx)(h.t,{columns:x,loading:Z,meta:u,ref:o,refetch:S,rowClick:function(e){a.default.push("".concat(j,"view?id=").concat(e.id))},rows:l.map((function(e){var t,n,r=(null===(t=y.qZ.find((function(t){return t.event===e.event})))||void 0===t?void 0:t.title)||"",o=e.actions[0],i=(null===(n=y.aW.find((function(e){return e.action===o.action})))||void 0===n?void 0:n.title)||"";return{id:e.id,title:e.title,event:r,action:i,status:e.status,createdAt:(0,p.Z)(e.createdAt),actions:""}}))})})},S=n(83789),x=n(92809),P=n(78215),k=n(2356),C=n(46482),A=n(22796),E=n(69399),J=n(75838);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,x.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var z=function(e){var t=e.control,n=e.errors,r=e.register,o=e.setFilters,i=y.qZ.map((function(e){return{value:e.event,text:e.title}})),a=y.aW.map((function(e){return{value:e.action,text:e.title}})),s={control:t,errors:n,register:r};return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(P.Z,{children:[(0,w.jsx)(k.Z,{md:6,children:(0,w.jsx)(E.r,T(T({},s),{},{onChange:function(e){return o((function(t){return T(T({},t),{},{status:e.target.value||null})}))},options:J.bg}))}),(0,w.jsx)(k.Z,{md:6,children:(0,w.jsx)(C.Z,T(T({},s),{},{name:"event",onChange:function(e){return o((function(t){return T(T({},t),{},{event:e.target.value||null})}))},options:[{text:"Event",value:""}].concat((0,S.Z)(i))}))})]}),(0,w.jsx)(P.Z,{children:(0,w.jsxs)(k.Z,{md:6,children:[(0,w.jsx)(A.Z,{marginTop:"xs"}),(0,w.jsx)(C.Z,T(T({},s),{},{name:"action",onChange:function(e){return o((function(t){return T(T({},t),{},{action:e.target.value||null})}))},options:[{text:"Action",value:""}].concat((0,S.Z)(a))}))]})})]})},W={action:null,event:null,q:null,status:null,filterType:"workflows_table"},F=function(){return(0,w.jsx)(i.J,{FiltersComp:z,initialFilters:W,TableComp:Z})},q=function(){return(0,w.jsx)(o.Z,{pageHeading:{heading:"Automated Workflows"},View:(0,w.jsx)(F,{})})}},45499:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/workflows",function(){return n(70892)}])},10219:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}n.d(t,{Z:function(){return r}})}},function(e){e.O(0,[284,4195,5312,2002,3086,4712,7431,9774,2888,179],(function(){return t=45499,e(e.s=t);var t}));var t=e.O();_N_E=t}]);