(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5524],{22796:function(e,t,n){"use strict";n.d(t,{Z:function(){return j}});var r,a,o,i,s,c=n(42982),d=n(30168),u=n(67294),l=n(45697),p=n(24237),m=n(82373),f=n(34974),g={xxsSize:"0.25rem",xsSize:"0.5rem",smSize:"0.75rem",mdSize:"1rem",lgSize:"1.5rem",xlSize:"2rem",xxlSize:"2.5rem",xxxlSize:"3rem"},v=function(e){var t="",n=0;return e.forEach((function(e){e.v&&(n++,t+="".concat(e.k,": ").concat(g[e.v+"Size"],";\n      ").concat(f.Z.desktop(r||(r=(0,d.Z)(["\n        ",": calc("," * 2);"])),e.k,g[e.v+"Size"]),"\n      "))})),0===n?(0,p.iv)(a||(a=(0,d.Z)(["\n      margin-bottom: ",";\n      ","\n    "])),g.mdSize,f.Z.desktop(o||(o=(0,d.Z)(["\n        margin-bottom: calc("," * 2);"])),g.mdSize)):(0,p.iv)(i||(i=(0,d.Z)(["\n    ","\n  "])),t)},h=function(e){var t=e.children,n=e.className,r=e.content,a=e.margin,o=e.marginX,i=e.marginY,s=e.marginTop,c=e.marginRight,d=e.marginBottom,l=e.marginLeft,p=e.padding,m=e.paddingX,f=e.paddingY,g=e.paddingTop,v=e.paddingRight,h=e.paddingBottom,j=e.paddingLeft;return u.createElement(b,{className:n,margin:a,marginX:o,marginY:i,marginTop:s,marginRight:c,marginBottom:d,marginLeft:l,padding:p,paddingX:m,paddingY:f,paddingTop:g,paddingRight:v,paddingBottom:h,paddingLeft:j},r||t)};h.displayName="Space";var b=p.ZP.div(s||(s=(0,d.Z)(["\n  margin: 0;\n  padding: 0;\n  ","\n"])),(function(e){var t=e.margin,n=e.marginBottom,r=e.marginTop,a=e.marginLeft,o=e.marginRight,i=e.marginX,s=e.marginY,d=e.padding,u=e.paddingBottom,l=e.paddingLeft,p=e.paddingRight,m=e.paddingTop,f=e.paddingX,g=e.paddingY;return v([{k:"margin",v:t},{k:"margin-bottom",v:n},{k:"margin-left",v:a},{k:"margin-right",v:o},{k:"margin-top",v:r},{k:"padding",v:d},{k:"padding-bottom",v:u},{k:"padding-left",v:l},{k:"padding-right",v:p},{k:"padding-top",v:m}].concat((0,c.Z)(s?[{k:"margin-top",v:s},{k:"margin-bottom",v:s}]:[]),(0,c.Z)(i?[{k:"margin-left",v:i},{k:"margin-right",v:i}]:[]),(0,c.Z)(g?[{k:"padding-top",v:g},{k:"padding-bottom",v:g}]:[]),(0,c.Z)(f?[{k:"padding-left",v:f},{k:"padding-right",v:f}]:[])))}));h.propTypes={children:l.node,content:l.string,margin:(0,l.oneOf)(Object.values(m.Z)),marginY:(0,l.oneOf)(Object.values(m.Z)),marginX:(0,l.oneOf)(Object.values(m.Z)),marginTop:(0,l.oneOf)(Object.values(m.Z)),marginRight:(0,l.oneOf)(Object.values(m.Z)),marginBottom:(0,l.oneOf)(Object.values(m.Z)),marginLeft:(0,l.oneOf)(Object.values(m.Z)),padding:(0,l.oneOf)(Object.values(m.Z)),paddingY:(0,l.oneOf)(Object.values(m.Z)),paddingX:(0,l.oneOf)(Object.values(m.Z)),paddingTop:(0,l.oneOf)(Object.values(m.Z)),paddingRight:(0,l.oneOf)(Object.values(m.Z)),paddingBottom:(0,l.oneOf)(Object.values(m.Z)),paddingLeft:(0,l.oneOf)(Object.values(m.Z))};var j=h},66918:function(e,t,n){"use strict";var r=n(4942),a=n(67294),o=n(45697),i=n(11570),s=n(4513),c=n(98479),d=n(97721),u=n(22796),l=n(37815);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=function(e){var t=e.children,n=e.meta,r=e.pageHeading,o=e.resultAlert,l=e.View,p=o.context,f=o.message,g=m(m({},{description:"Admin",path:"/",title:"Admin"}),n);return a.createElement(a.Suspense,{fallback:a.createElement(d.Z,{indicator:a.createElement(s.Z,null)})},a.createElement(c.Z,{fluid:!0,meta:g,pageHeading:r},l||t,f&&a.createElement(a.Fragment,null,a.createElement(u.Z,null),a.createElement(i.Z,{content:f,context:p}))))};f.displayName="Dashboard",f.propTypes={children:o.node,meta:(0,o.shape)({description:o.string,path:o.string,title:o.string}),pageHeading:(0,o.shape)({center:o.bool,context:(0,o.oneOf)(Object.values(l.Z)),divider:o.bool,heading:o.any.isRequired,help:o.bool,helpContent:o.any,strapline:o.string}),resultAlert:(0,o.shape)({context:o.string,message:o.string}),View:o.node},f.defaultProps={resultAlert:{context:"success",message:""}},t.Z=f},98479:function(e,t,n){"use strict";n.d(t,{Z:function(){return j}});var r=n(30168),a=n(67294),o=n(45697),i=n(24237),s=n(17743),c=n(44902),d=n(9008),u=function(e){var t=e.canonical,n=e.brand,r=e.meta,o=r.description,i=r.path,s=r.title;return a.createElement(d.default,null,a.createElement("title",null,s," | ",n),a.createElement("meta",{name:"description",content:o,key:"description"}),a.createElement("meta",{rel:"canonical",href:t+i,key:"canonical"}),a.createElement("meta",{property:"og:title",content:s}),a.createElement("meta",{property:"og:description",content:o}),a.createElement("meta",{property:"og:url",content:t+i}),a.createElement("meta",{name:"twitter:url",content:t+i}),a.createElement("meta",{name:"twitter:title",content:s}),a.createElement("meta",{name:"twitter:description",content:o}))};u.displayName="MetaHead",u.propTypes={brand:o.string.isRequired,meta:o.object.isRequired};var l,p=u,m=n(33120),f=n(22796),g=n(37815),v=n(82373),h=function(e){var t=e.children,n=e.fluid,r=e.meta,o=e.padding,i=e.pageHeading,d=(0,a.useContext)(s.Z).config,u=d.Brand,l=d.Canonical;return a.createElement(b,null,o&&a.createElement(f.Z,{paddingTop:o}),r&&a.createElement(p,{canonical:l,brand:u.name,meta:r}),a.createElement(c.Z,{fluid:n},i&&a.createElement(m.Z,i),t),o&&a.createElement(f.Z,{paddingBottom:o}))};h.displayName="Page";var b=i.ZP.div(l||(l=(0,r.Z)(["\n  background-color: ",";\n"])),(function(e){return e.theme.PAGE.backGroundColour}));h.propTypes={children:o.node.isRequired,fluid:o.bool,meta:(0,o.shape)({description:o.string.isRequired,path:o.string,title:o.string.isRequired}),padding:(0,o.oneOfType)([o.bool,(0,o.oneOf)(Object.values(v.Z))]),pageHeading:(0,o.shape)({center:o.bool,context:(0,o.oneOf)(Object.values(g.Z)),divider:o.bool,heading:o.any.isRequired,help:o.bool,helpContent:o.any,strapline:o.string})},h.defaultProps={fluid:!1,padding:"md"};var j=h},33120:function(e,t,n){"use strict";var r,a,o,i,s,c=n(30168),d=n(67294),u=n(45697),l=n(24237),p=n(77417),m=n(11417),f=n(37815),g=function(e){var t=e.center,n=e.children,r=e.context,a=e.divider,o=e.heading,i=e.help,s=e.helpContent,c=e.strapline;return d.createElement(v,{center:t,divider:a},d.createElement(h,null,d.createElement(j,{content:o,context:r,pageHeading:!0}),c&&d.createElement("div",null,c)),(n||i)&&d.createElement(b,null,n||s),a&&d.createElement(x,{size:"md"}))};g.displayName="PageHeading";var v=l.ZP.header(r||(r=(0,c.Z)(["\n  align-items: center;\n  display: flex;\n  flex-flow: row wrap;\n  justify-content: space-between;\n  margin-bottom: ",";\n  text-align: ",";\n"])),(function(e){return!e.divider&&"2rem"}),(function(e){return e.center&&"center"})),h=l.ZP.span(a||(a=(0,c.Z)(["\n  flex: 1;\n"]))),b=l.ZP.span(o||(o=(0,c.Z)(["\n  display: flex;\n  flex: 1;\n  justify-content: flex-end;\n"]))),j=(0,l.ZP)(m.Z)(i||(i=(0,c.Z)(["\n  margin-bottom: ",";\n"])),(function(e){return e.divider?"0.5rem":"0"})),x=(0,l.ZP)(p.Z)(s||(s=(0,c.Z)(["\n  width: 100%;\n"])));g.propTypes={center:u.bool,children:u.element,context:(0,u.oneOf)(Object.values(f.Z)),divider:u.bool,heading:u.any.isRequired,help:u.bool,helpContent:u.any,strapline:u.string},g.defaultProps={center:!1,context:"primary",divider:!0,help:!1,helpContent:"",strapline:""},t.Z=g},80382:function(e,t,n){"use strict";n.d(t,{f:function(){return P}});var r=n(92809),a=n(30266),o=n(80318),i=n(64687),s=n.n(i),c=n(75709),d=n(86007),u=n(42283),l=n(79665),p=n(97202),m=n(65375),f=n(46482),g=n(83528),v=n(76800),h=n(95146),b=n(75838),j=n(19501),x=function(e){return(0,j.Ry)().shape({startDate:(0,j.hT)().required(),endDate:(0,j.hT)().required().min((0,j.iH)("startDate"),"start date should be greater than end date"),meta:(0,j.Z_)(),notes:(0,j.Z_)(),alternativeUser:(0,j.Ry)().required(),user:e?(0,j.Ry)().required():(0,j.Ry)(),status:(0,j.Z_)().oneOf(["active","inactive"]).required()})},y=n(1323),Z=n(85893);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(e){var t=e.defaultValues,n=e.userId,r=e.onSuccess,i=(0,y.x)(),j=i.hasRole,O=i.user,P=j(["admin","superadmin"])&&!n,D=(0,u.cI)({defaultValues:t,resolver:(0,l.S)(x(P))}),k=D.control,_=D.errors,S=D.handleSubmit,A=D.register,I=(0,c.D)(d.RZ,{onCompleted:function(){r&&r()}}),C=(0,o.Z)(I,1)[0],E=(0,c.D)(d.U7,{onCompleted:function(){r&&r()}}),U=(0,o.Z)(E,1)[0],R=function(){var e=(0,a.Z)(s().mark((function e(r){var a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=r).alternativeUserId=r.alternativeUser.value,a.user&&a.user.value?a.userId=a.user.value:a.userId=n,delete a.alternativeUser,a.user&&delete a.user,!t.id){e.next=10;break}return e.next=8,U({variables:{id:t.id,changes:a}});case 8:e.next=12;break;case 10:return e.next=12,C({variables:{objects:[a]}});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q={control:k,errors:_,register:A};return(0,Z.jsxs)(p.Z,{id:"offCanvasForm",handleSubmit:S(R),children:[P&&(0,Z.jsx)(h.P,w(w({},q),{},{errors:w({},_),accountId:O.accountId,label:"User",name:"user",type:"user"})),(0,Z.jsx)(h.P,w(w({},q),{},{errors:w({},_),accountId:O.accountId,label:"Alternative User",name:"alternativeUser",type:"user"})),(0,Z.jsx)(m.Z,{label:"Start date",children:(0,Z.jsx)(v.M,w(w({},q),{},{dateFormat:"d MMM yyyy HH:mm",name:"startDate",placeholderText:"Click to select start date",showTimeSelect:!0}))}),(0,Z.jsx)(m.Z,{label:"End date",children:(0,Z.jsx)(v.M,w(w({},q),{},{name:"endDate",dateFormat:"d MMM yyyy HH:mm",placeholderText:"Click to select end date",showTimeSelect:!0}))}),(0,Z.jsx)(m.Z,{label:"Status",children:(0,Z.jsx)(f.Z,w(w({},q),{},{name:"status",options:b.bg}))}),(0,Z.jsx)(m.Z,{label:"Notes",children:(0,Z.jsx)(g.Z,w(w({},q),{},{name:"notes"}))})]})}},847:function(e,t,n){"use strict";n.d(t,{X:function(){return a}});var r=n(45697),a=function(e){var t=e.row,n=e.initialDate;return t?{id:t.id,alternativeUser:{value:t.AlternativeUser.id,label:t.AlternativeUser.fullName},user:{value:t.User.id,label:t.User.fullName},startDate:new Date(t.startDate),endDate:new Date(t.endDate),status:t.status.toLowerCase(),notes:t.notes}:{status:"active",startDate:n,endDate:n}};a.propTypes={row:r.object,initialDate:r.date}},86007:function(e,t,n){"use strict";n.d(t,{RZ:function(){return d},U7:function(){return u},Zd:function(){return p},M6:function(){return m}});var r,a,o,i,s=n(52209),c=n(54397),d=(0,c.Ps)(r||(r=(0,s.Z)(["\n  mutation addHoliday($objects: [Holiday_insert_input!]!) {\n    insert_Holiday(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),u=(0,c.Ps)(a||(a=(0,s.Z)(["\n  mutation updateHoliday($changes: Holiday_set_input = {}, $id: Int!) {\n    update_Holiday_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),l="{ User: { id: { _eq: $userId } }, meta: $meta }\norder_by: { startDate: asc, endDate: asc }",p=(0,c.Ps)(o||(o=(0,s.Z)(["\n  query GetHoliday($userId: Int!, $meta: jsonb_comparison_exp = {},$limit: Int,$offset: Int) {\n    Holiday(\n      limit: $limit\n      offset: $offset\n      where: ","\n    ) {\n      createdAt\n      endDate\n      id\n      notes\n      startDate\n      status\n      userId\n      AlternativeUser {\n        id\n        fullName\n        nameFirst\n        nameLast\n      }\n      User {\n        id\n        nameFirst\n        nameLast\n        fullName\n      }\n    }\n    meta: Holiday_aggregate(where:",") {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"])),l,l),m=(0,c.Ps)(i||(i=(0,s.Z)(['\n  query Holiday($startDate: timestamptz = "", $endDate: timestamptz = "", $userId: Int) {\n    events: Holiday(\n      where: {\n        _and: { startDate: { _gte: $startDate }, endDate: { _lte: $endDate } }\n        User: { id: { _eq: $userId } }\n      }\n    ) {\n      startDate\n      endDate\n      createdAt\n      id\n      notes\n      status\n      userId\n      User {\n        id\n        nameFirst\n        nameLast\n        fullName\n      }\n      AlternativeUser {\n        id\n        fullName\n        nameFirst\n        nameLast\n      }\n    }\n  }\n'])))},17517:function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var r=function(e){var t=e.addresses;return null!==t&&void 0!==t&&t.address?{__html:"".concat(t.address.addressLine1,"<br />").concat(t.address.postCode)}:"Please add"}},10076:function(e,t,n){"use strict";n.d(t,{H:function(){return S}});var r=n(92809),a=n(83789),o=n(93633),i=n(42283),s=n(79665),c=n(84550),d=n(97202),u=n(65375),l=n(46482),p=n(71247),m=n(69128),f=n(34003),g=n(98315),v=n(19501),h=(0,v.Ry)().shape({nameFirst:(0,v.Z_)().required(),nameLast:(0,v.Z_)().required(),email:(0,v.Z_)().required().email(),phone:(0,v.Z_)().required(),status:(0,v.Z_)().when("$hasRole",(function(e){return e?(0,v.Z_)().oneOf(["active","inactive"]).required():void 0})),invoiceThreshold:(0,v.Rx)().nullable(!0).transform((function(e){return isNaN(e)?null:e})),quoteThreshold:(0,v.Rx)().nullable(!0).transform((function(e){return isNaN(e)?null:e})),role:(0,v.Z_)().when(["$hasRole","accountId"],(function(e,t){return e?t&&t.length>0&&(0,v.Z_)().required():void 0})),position:(0,v.Z_)().when("accountId",{is:function(e){return e&&e.length>0},then:(0,v.Z_)()}),isContact:(0,v.Z_)().when("accountId",{is:function(e){return e&&e.length>0},then:(0,v.Z_)().oneOf(["yes","no"]).required()}),location:(0,v.IX)().when("$hasLocation",(function(e){return e?(0,v.IX)().of((0,v.Rx)().integer().required()).required():void 0}))}),b=n(1323),j=n(56257),x=n(27834),y=n(17517),Z=n(81185),O=n(49705),w=n(85893);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(e,t){return"customer"!==e&&"supplier"!==e||t([].concat((0,a.Z)(j.td),(0,a.Z)(j.Sf),(0,a.Z)(j.n),(0,a.Z)(j.nx)))},_=["customer_user"],S=function(e){var t=e.accountType,n=e.defaultValues,r=e.meta,v=e.submit,P=(0,b.x)(),S=P.hasRole,A=P.user,I=(0,O.x)({filters:{}}),C=I.initialData,E=I.ref,U=(0,i.cI)({defaultValues:n&&D({},n),resolver:(0,s.S)(h),context:{hasRole:k(t,S),hasLocation:!_.includes(A.role)&&_.includes("".concat(t,"_").concat(null===n||void 0===n?void 0:n.role))}}),R=U.control,q=U.errors,L=U.handleSubmit,N=U.register,T=(0,U.watch)("role"),H=(0,o.a)(x.ZA,{variables:D(D({},C),{},{accountId:n.accountId})}),$=H.data,z=($=void 0===$?{location:[],meta:{aggregate:{totalCount:0}}}:$).location,F=$.meta,M=H.loading,V=H.refetch,X=(0,a.Z)(g.I);switch(t){case"supplier":X.push({text:"Operative",value:"contractor"});break;case"admin":X.push({text:"Helpdesk",value:"helpdesk"})}var B={control:R,errors:q,register:N},Y=[{hidden:!S([].concat((0,a.Z)(j.td),(0,a.Z)(j.Sf),(0,a.Z)(j.n))),formatter:function(e){var t=e.row;return(0,w.jsx)(c.Z,D(D({},B),{},{name:"location",data:[{value:t.id}]}))}},{text:"Name"},{text:"Address"}];return(0,w.jsxs)(d.Z,{id:"offCanvasForm",handleSubmit:L((function(e){v(e,r)})),children:[(0,w.jsx)(f.q,D({},B)),n.accountId&&(0,w.jsxs)(w.Fragment,{children:[k(t,S)&&(0,w.jsx)(u.Z,{label:"Role",children:(0,w.jsx)(l.Z,D(D({},B),{},{name:"role",options:X}))}),(0,w.jsx)(u.Z,{label:"Position / Job title",children:(0,w.jsx)(p.Z,D(D({},B),{},{name:"position"}))}),S(["admin_owner","admin_manager","customer_owner","customer_manger","supplier_owner","supplier_manager"])&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(u.Z,{label:"Threshold limit / Invoice",children:(0,w.jsx)(p.Z,D(D({},B),{},{name:"invoiceThreshold"}))}),(0,w.jsx)(u.Z,{label:"Threshold limit / Quote",children:(0,w.jsx)(p.Z,D(D({},B),{},{name:"quoteThreshold"}))})]}),(0,w.jsx)(m.Z,D(D({},B),{},{data:[{id:"yes",label:"Yes",value:"yes"},{id:"no",label:"No",value:"no"}],legend:"Contact User",name:"isContact",stacked:!0})),_.includes("".concat(t,"_").concat(T))&&(0,w.jsx)(u.Z,{label:"Locations",children:(0,w.jsx)(Z.t,{columns:Y,loading:M,meta:F,ref:E,refetch:V,rows:function(){var e=z.map((function(e){return{id:e.accountLocations[0].id,name:e.name,address:(0,y.u)({addresses:e.addresses[0]})}}));return _.includes(A.role)?e.filter((function(e){var t;return null===n||void 0===n||null===(t=n.location)||void 0===t?void 0:t.includes("".concat(e.id))})):e}()})})]}),(null===n||void 0===n?void 0:n.id)&&(0,w.jsx)(p.Z,D(D({},B),{},{name:"id",type:"hidden"})),(null===n||void 0===n?void 0:n.accountId)&&(0,w.jsx)(p.Z,D(D({},B),{},{name:"accountId",type:"hidden"})),(null===n||void 0===n?void 0:n.accountUserId)&&(0,w.jsx)(p.Z,D(D({},B),{},{name:"accountUserId",type:"hidden"}))]})}},34003:function(e,t,n){"use strict";n.d(t,{q:function(){return h}});var r=n(83789),a=n(92809),o=n(78215),i=n(2356),s=n(65375),c=n(71247),d=n(50710),u=n(46482),l=n(75838),p=n(1323),m=n(56257),f=n(85893);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,a.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(e){var t=e.errors,n=e.prefix,a=e.register,g=(0,p.x)().hasRole,h={errors:t,register:a};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(o.Z,{children:[(0,f.jsx)(i.Z,{md:6,children:(0,f.jsx)(s.Z,{label:"First name",children:(0,f.jsx)(c.Z,v(v({},h),{},{name:"".concat(n,"nameFirst")}))})}),(0,f.jsx)(i.Z,{md:6,children:(0,f.jsx)(s.Z,{label:"Last name",children:(0,f.jsx)(c.Z,v(v({},h),{},{name:"".concat(n,"nameLast")}))})}),(0,f.jsx)(i.Z,{md:6,children:(0,f.jsxs)(s.Z,{label:"Email",children:[(0,f.jsx)(c.Z,v(v({},h),{},{name:"".concat(n,"email"),type:"email"})),t["".concat(n,"email")]&&"duplicate"===t["".concat(n,"email")].type&&(0,f.jsx)(d.Z,{message:t["".concat(n,"email")].message})]})}),(0,f.jsx)(i.Z,{md:6,children:(0,f.jsx)(s.Z,{label:"Mobile",children:(0,f.jsx)(c.Z,v(v({},h),{},{name:"".concat(n,"phone")}))})})]}),g([].concat((0,r.Z)(m.td),(0,r.Z)(m.Sf),(0,r.Z)(m.n),(0,r.Z)(m.nx)))&&(0,f.jsx)(s.Z,{label:"Status",children:(0,f.jsx)(u.Z,v(v({},h),{},{name:"".concat(n,"status"),options:l.bg}))}),(0,f.jsx)(c.Z,v(v({},h),{},{name:"".concat(n,"userId"),type:"hidden"}))]})};h.defaultProps={prefix:""}},75838:function(e,t,n){"use strict";n.d(t,{bg:function(){return r},WG:function(){return a}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],a=[{text:"Status",value:""},{text:"Open",value:"open"},{text:"Resolved",value:"resolved"},{text:"Closed",value:"closed"}]},98315:function(e,t,n){"use strict";n.d(t,{I:function(){return r}});var r=[{text:"Select Role",value:""},{text:"Owner",value:"owner"},{text:"Manager",value:"manager"},{text:"User",value:"user"}]},3866:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return ze}});var r=n(66918),a=n(67294),o=n(11163),i=n(93633),s=n(27834),c=n(42593),d=n(78215),u=n(2356),l=n(28323),p=n(92809),m=n(86007),f=n(80880),g=n(18862),v=n(64509),h=n(91126),b=n(58448),j=n(14347),x=n(80284),y=n(81185),Z=n(80382),O=n(847),w=n(49705),P=n(85893);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function k(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _,S,A,I=function(e){var t=e.userId,n=(0,w.x)({filters:{}}),r=n.initialData,o=n.ref,s=(0,a.useContext)(f.Z),c=(0,i.a)(m.Zd,{variables:k({userId:parseInt(t)},r)}),d=c.data,u=(d=void 0===d?{Holiday:[],meta:{aggregate:{totalCount:0}}}:d).Holiday,l=d.meta,p=c.refetch,D=c.loading,_=function(){p(),s.close()},S=function(e,n){e.stopPropagation(),s.show({content:(0,P.jsx)(Z.f,{defaultValues:(0,O.X)({row:n}),userId:t,onSuccess:_}),title:n?"Edit":"Add Holiday"})},A=[{hidden:!0},{hidden:!0},{hidden:!0},{hidden:!0},{formatter:function(e){var t=e.row;return"".concat((0,g.Z)(t.startDate)," ").concat((0,v.Z)(t.startDate))},sortable:!0,sortName:"startDate",text:"Start date"},{formatter:function(e){var t=e.row;return"".concat((0,g.Z)(t.endDate)," ").concat((0,v.Z)(t.endDate))},text:"End date"},{formatter:function(e){return e.row.AlternativeUser.fullName},text:"Alternative User"},{text:"Status"},{formatter:function(e){var t=e.row;return(0,g.Z)(t.createdAt)},text:"Created At"},{formatter:h.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:S,tooltip:"Edit"}],text:"Actions"}],I=function(){return(0,P.jsx)(b.Z,{children:(0,P.jsx)(j.Z,{context:"secondary",content:"Add Holiday",onClick:S,size:"sm"})})};return(0,P.jsx)(x.Z,{toolbar:(0,P.jsx)(I,{}),open:!0,title:"Holidays",children:(0,P.jsx)(y.t,{columns:A,loading:D,meta:l,ref:o,refetch:p,rows:u.map((function(e){return{id:e.id,userId:e.userId,AlternativeUser:e.AlternativeUser,User:e.User,notes:e.notes,startDate:e.startDate,endDate:e.endDate,status:e.status,createdAt:e.createdAt,actions:""}}))})})},C=n(52209),E=n(54397),U=(0,E.Ps)(_||(_=(0,C.Z)(["\n  query GetLogs($id: Int!) {\n    logs: audit_Session(order_by: { createdAt: desc }, where: { userId: { _eq: $id } }) {\n      id\n      app\n      appVersion\n      createdAt\n      userAgent\n    }\n    meta: audit_Session_aggregate {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]))),R=n(97202),q=n(93443),L=function(e){var t=e.log;return(0,P.jsxs)(R.Z,{id:"offCanvasForm",children:[(0,P.jsx)(q.Z,{content:"App:",text:t.app}),(0,P.jsx)(q.Z,{content:"Date:",text:t.createdAt}),(0,P.jsx)(q.Z,{content:"App Version:",text:t.appVersion}),(0,P.jsx)(q.Z,{content:"User Agent:",text:t.userAgent})]})},N=function(e){var t=e.userId,n=(0,w.x)({filters:{}}).ref,r=(0,a.useContext)(f.Z),o=(0,i.a)(U,{variables:{id:parseInt(t)}}),s=o.data,c=(s=void 0===s?{logs:[],meta:{aggregate:{totalCount:0}}}:s).logs,d=s.meta,u=o.loading,l=o.refetch;return!u&&(0,P.jsx)(x.Z,{open:!0,title:"User Logs",children:(0,P.jsx)(y.t,{columns:[{hidden:!0},{text:"App"},{text:"Date"},{hidden:!0,text:"User Agent"},{text:"App Version"}],history:!1,loading:u,meta:d,ref:n,refetch:l,rowClick:function(e){r.show({content:(0,P.jsx)(L,{log:e}),submit:!1,title:"Log Details"})},rows:c.map((function(e){return{id:e.id,app:e.app,createdAt:(0,g.Z)(e.createdAt,!0),userAgent:e.userAgent,appVersion:e.appVersion}}))})})},T=n(77567),H=n(29444),$=n(73165),z=n(52002),F=n(83789),M=n(30266),V=n(80318),X=n(64687),B=n.n(X),Y=n(75709),G=(0,E.Ps)(S||(S=(0,C.Z)(["\n  mutation addAccountUser($objects: [Account_User_insert_input!]!) {\n    insert_Account_User(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),J=(0,E.Ps)(A||(A=(0,C.Z)(["\n  mutation UpdateAccountUser($id: Int!, $changes: Account_User_set_input) {\n    update_Account_User_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),Q=n(42283),K=n(79665),W=n(65375),ee=n(46482),te=n(71247),ne=n(69128),re=n(95146),ae=n(75838),oe=n(98315),ie=n(19501),se=(0,ie.Ry)().shape({accountSelected:(0,ie.Ry)().required(),position:(0,ie.Z_)().required(),role:(0,ie.Z_)().required(),isContact:(0,ie.Z_)().oneOf(["yes","no"]).required(),status:(0,ie.Z_)().oneOf(["active","inactive"]).required()});function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function de(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ue=function(e){var t,n=e.defaultValues,r=e.onSuccess,a=(0,Q.cI)({defaultValues:n,resolver:(0,K.S)(se)}),o=a.control,i=a.errors,s=a.handleSubmit,c=a.register,d=a.watch,u=(0,Y.D)(G,{onCompleted:function(e){var t=e.insert_Account_User.returning[0].id;r&&r(t)}}),l=(0,V.Z)(u,1)[0],p=(0,Y.D)(J,{onCompleted:function(e){var t=e.update_Account_User_by_pk.id;r&&r(t)}}),m=(0,V.Z)(p,1)[0],f=d("accountSelected"),g=function(){var e=(0,M.Z)(B().mark((function e(t){var r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=t).isContact="yes"===r.isContact,r.accountId=r.accountSelected.value,delete r.accountSelected,!n.id){e.next=9;break}return e.next=7,m({variables:{id:n.id,changes:r}});case 7:e.next=11;break;case 9:return e.next=11,l({variables:{objects:[r]}});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),v="supplier"===((null===f||void 0===f?void 0:f.type)||(null===f||void 0===f||null===(t=f.account)||void 0===t?void 0:t.type))?[].concat((0,F.Z)(oe.I),[{text:"Operative",value:"contractor"}]):oe.I,h={control:o,errors:i,register:c};return(0,P.jsxs)(R.Z,{id:"offCanvasForm",handleSubmit:s(g),children:[(0,P.jsx)(re.P,de(de({},h),{},{errors:de({},i),label:"Account",name:"accountSelected"})),!!f&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(W.Z,{label:"Role",children:(0,P.jsx)(ee.Z,de(de({},h),{},{name:"role",options:v}))}),(0,P.jsx)(W.Z,{label:"Position / Job title",children:(0,P.jsx)(te.Z,de(de({},h),{},{name:"position"}))}),(0,P.jsx)(ne.Z,de(de({},h),{},{data:[{id:"yes",label:"Yes",value:"yes"},{id:"no",label:"No",value:"no"}],legend:"Contact User",name:"isContact",stacked:!0})),(0,P.jsx)(W.Z,{label:"Status",children:(0,P.jsx)(ee.Z,de(de({},h),{},{name:"status",options:ae.bg}))}),n.id?(0,P.jsx)(te.Z,de(de({},h),{},{name:"id",type:"hidden"})):(0,P.jsx)(te.Z,de(de({},h),{},{name:"userId",type:"hidden"}))]})]})},le=function(e){var t=e.refetch,n=e.user,r=(0,a.useContext)(c.Z).hasRole,o=(0,a.useContext)(f.Z),i=Object.assign({},n);i.name="".concat(i.nameFirst," ").concat(i.nameLast);var s=function(){t(),o.close()},d=function(e,t){var r,a;(e.stopPropagation(),null!==(r=t)&&void 0!==r&&r.id)?(t.isContact=null===(a=t)||void 0===a?void 0:a.isContact.toLowerCase(),t.role=t.role.toLowerCase(),t.status=t.status.toLowerCase()):((t={}).isContact="no",t.status="active",t.userId=n.id);o.show({content:(0,P.jsx)(ue,{defaultValues:t,onSuccess:s}),title:t.id?"Edit":"Assign Account"})},u=[{hidden:!0},{formatter:(0,H.Z)("","accountId","name","url"),text:"Account"},{text:"Type"},{text:"Role"},{text:"Position"},{text:"Contact"},{text:"Status"},{hidden:!0},{hidden:!r("admin"),formatter:h.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:d,tooltip:"Edit"}],text:"Actions"},{hidden:!0},{hidden:!0}],l=function(){return(0,P.jsx)(b.Z,{children:(0,P.jsx)(j.Z,{context:"secondary",content:"Assign Account",onClick:d,size:"sm"})})};return(0,P.jsx)(x.Z,{toolbar:r("admin")&&(0,P.jsx)(l,{}),open:!0,title:"Accounts",children:(0,P.jsx)(z.Z,{columns:u,rows:i.accounts.filter((function(e){return null!==e.account})).map((function(e){return{id:e.id,name:e.account.name,type:(0,$.Z)(e.account.type),role:(0,$.Z)(e.role),position:e.position||"N/A",isContact:e.isContact?"Yes":"No",status:(0,$.Z)(e.status),accountId:e.account.id,actions:"",url:"tenant"===e.account.type.toLowerCase()?"":"/dashboard/".concat(e.account.type.toLowerCase(),"s/view"),accountSelected:{label:e.account.name,type:e.account.type,value:e.account.id}}}))})})},pe=n(10076),me=n(1323);function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ge=function(e){var t,n=e.refetch,r=e.user,o=(0,me.x)(),i=o.user.id,c=o.hasRole,d=(0,a.useContext)(f.Z),u=Object.assign({},r),l=(0,Y.D)(s.AX,{onCompleted:function(e){d.close(),n()}}),m=(0,V.Z)(l,1)[0],v=function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);delete t.userId,m({variables:{accountUserId:0,changes:t,id:t.id,updateAccountUser:!1}})},h=function(e){e.stopPropagation(),d.show({content:(0,P.jsx)(pe.H,{defaultValues:u,submit:v}),title:"Edit user"})},y=function(){return(0,P.jsx)(b.Z,{children:(0,P.jsx)(j.Z,{context:"secondary",content:"Edit",onClick:h,size:"sm"})})};u.name="".concat(u.nameFirst," ").concat(u.nameLast);var Z=c(["superadmin","admin"])||u.id===i;return(0,P.jsxs)(x.Z,{toolbar:c("admin")&&(0,P.jsx)(y,{}),open:!0,title:"Details",children:[(0,P.jsx)(q.Z,{content:"Name",text:u.name}),Z&&(0,P.jsx)(q.Z,{content:"Email",text:u.email}),(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(q.Z,{content:"Position",text:""}),(null===u||void 0===u?void 0:u.accounts.length)>1?null===u||void 0===u?void 0:u.accounts.map((function(e){return(0,P.jsx)(q.Z,{content:"",text:"".concat(e.account.name,": ").concat(e.position||"N/A")})})):(0,P.jsx)(q.Z,{content:"",text:(null===u||void 0===u||null===(t=u.accounts[0])||void 0===t?void 0:t.position)||"N/A"})]}),Z&&(0,P.jsx)(q.Z,{content:"Phone",text:u.phone}),(0,P.jsx)(q.Z,{content:"Status",text:u.status}),(0,P.jsx)(q.Z,{content:"Date Added",text:(0,g.Z)(u.createdAt)})]})},ve=n(47357),he=n(18944),be=n(21899),je=n(9638),xe=n(45697);function ye(e){var t,n,r=(0,i.a)(s.nh,{variables:{id:e}}),a=r.loading,o=r.data,c=r.refetch;n=null===o||void 0===o||null===(t=o.user)||void 0===t?void 0:t.meta;var d,u,l,p,m,f,g,v,h,b={google:!1,microsoft:!1,sage:!1};a||(b={google:!(null===(d=n)||void 0===d||null===(u=d.integration)||void 0===u||null===(l=u.google)||void 0===l||null===(p=l.tokens)||void 0===p||!p.access_token),microsoft:!(null===(m=n)||void 0===m||null===(f=m.integration)||void 0===f||null===(g=f.microsoft)||void 0===g||!g.id),sage:!!(null!==(v=n)&&void 0!==v&&null!==(h=v.modules)&&void 0!==h&&h.sageIntegration&&n.modules.sageIntegration.length>0)});return{loading:a,data:{integration:b,meta:n},refetch:c}}ye.propTypes={accountId:xe.number.isRequired};var Ze=function(e){var t=e.id,n=ye(t),r=n.data,a=r.integration,o=r.meta,i=n.refetch;return(0,P.jsxs)(x.Z,{fitParentHeight:!0,open:!0,title:"Integrations",children:[(0,P.jsxs)(d.Z,{align:"center",children:[(0,P.jsx)(u.Z,{md:2,children:(0,P.jsx)(ve.Z,{alt:"Microsoft Outlook",src:"/static/logo/Microsoft_Outlook-Logo.svg"})}),(0,P.jsxs)(u.Z,{md:6,children:[(0,P.jsx)(he.Z,{content:"Microsoft Outlook"}),(0,P.jsx)(he.Z,{content:"Add asset bookings to your calendar",size:"sm"})]}),(0,P.jsx)(u.Z,{md:4,children:(0,P.jsx)(be.e,{credentials:{id:t,type:"user"},isLoggedIn:a.microsoft,refetch:i})})]}),(0,P.jsxs)(d.Z,{align:"center",children:[(0,P.jsx)(u.Z,{md:2,children:(0,P.jsx)(ve.Z,{alt:"Google Calendar",src:"/static/logo/Google_Calendar-Logo.svg"})}),(0,P.jsxs)(u.Z,{md:6,children:[(0,P.jsx)(he.Z,{content:"Google Calendar"}),(0,P.jsx)(he.Z,{content:"Add asset bookings to your calendar",size:"sm"})]}),(0,P.jsx)(u.Z,{md:4,children:(0,P.jsx)(je.i,{credentials:{id:t,type:"user"},isLoggedIn:a.google,refetch:i,meta:o})})]})]})},Oe=n(24237),we=n(4513),Pe=n(11570),De=n(22796),ke=n(31990);function _e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ae=function(e){var t,n,r,a,o,i,s,c=e.userMeta,d=e.data,u=e.documentSide,l=Se({},c);null!==(t=l)&&void 0!==t&&t.identityDocument||(l=Se(Se({},l),{},{identityDocument:{}}));var p=d.key,m=d.data.find((function(e){return"large"===e.name}));s=m?m.relativePath:p;var f,g={key:d.key,extension:null===(n=s)||void 0===n?void 0:n.split(".").pop(),thumbnails:d.data||null};switch(u){case"documentFrontSide":f=null===(r=l.identityDocument)||void 0===r||null===(a=r.front)||void 0===a?void 0:a.key,l.identityDocument=Se(Se({},l.identityDocument),{},{front:g});break;case"documentBackSide":f=null===(o=l.identityDocument)||void 0===o||null===(i=o.back)||void 0===i?void 0:i.key,l.identityDocument=Se(Se({},l.identityDocument),{},{back:g})}return{meta:l,key:f}},Ie=n(3805),Ce=(0,ie.Ry)().shape({dropzone:(0,ie.nK)().required()}),Ee=n(34155),Ue=function(){var e=(0,M.Z)(B().mark((function e(t){var n,r;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"cleverly-staging-media",n=Ee.env.NEXT_PUBLIC_S3_DELETE_URL,e.next=4,window.fetch(n,{method:"POST",body:{bucket:"cleverly-staging-media",keys:(0,F.Z)(t)}});case 4:return r=e.sent,e.abrupt("return",r.json());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Re=n(55863);function qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qe(Object(n),!0).forEach((function(t){(0,p.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ne=function(e){var t=e.userId,n=e.onSuccess,r=e.userMeta,o=e.documentSide,i=(0,a.useState)(!1),c=i[0],d=i[1],u=(0,a.useState)(""),l=u[0],p=u[1],m=(0,Q.cI)({resolver:(0,K.S)(Ce)}),f=m.control,g=m.errors,v=m.handleSubmit,h=m.register,b=(0,Y.D)(s.uz,{onCompleted:n,update:function(e,n){var r=n.data.update_User_by_pk.meta;e.readQuery({query:s.JA,variables:{id:t}});e.writeQuery({query:s.JA,variables:{id:t},data:{meta:r}})}}),j=(0,V.Z)(b,2),x=j[0],y=j[1].loading,Z=function(){var e=(0,M.Z)(B().mark((function e(n){var a,i,s,c,u,l;return B().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=n.dropzone,e.prev=1,d(!0),!(i=a[0])){e.next=16;break}return e.next=7,(0,Ie.V)(i,"image");case 7:if((s=e.sent).success){e.next=10;break}return e.abrupt("return",p(s.message));case 10:if(c=Ae({userMeta:r,data:s,documentSide:o}),u=c.meta,!(l=c.key)){e.next=14;break}return e.next=14,Ue(l);case 14:return e.next=16,x({variables:{userId:t,meta:u}});case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(1),p(e.t0),(0,Re.Tb)({message:e.t0,section:"upload"});case 22:case"end":return e.stop()}}),e,null,[[1,18]])})));return function(t){return e.apply(this,arguments)}}(),O={control:f,errors:g,register:h};return c||y?(0,P.jsx)(Te,{children:(0,P.jsx)(we.Z,{})}):(0,P.jsxs)(R.Z,{id:"offCanvasForm",handleSubmit:v(Z),children:[l.length>0&&(0,P.jsxs)(P.Fragment,{children:[(0,P.jsx)(Pe.Z,{content:l,context:"warning"}),(0,P.jsx)(De.Z,{})]}),(0,P.jsx)(W.Z,{label:"Media"}),(0,P.jsx)(Q.Qr,Le(Le({},O),{},{as:(0,P.jsx)(ke.Z,{accept:"image/*, .heic",multiple:!1}),name:"dropzone"}))]})},Te=Oe.ZP.div.withConfig({displayName:"form__StyledLoading",componentId:"sc-rf182i-0"})(["height:85vh;padding:0;margin:0;display:flex;align-items:center;justify-content:center;"]);Ne.defaultProps={accept:ke.Z.defaultProps.accept};var He=function(e){var t=e.userId,n=e.userMeta,r=(0,a.useContext)(f.Z),o=function(e){var a="documentFrontSide"===e?"Front":"Back";r.show({content:(0,P.jsx)(Ne,{userId:t,userMeta:n,onSuccess:r.close,documentSide:e}),title:"Upload Identity Document ".concat(a)})},i=[{key:"Identity Card Front",value:null,calcAmount:function(){var e;return(0,P.jsxs)(d.Z,{children:[(0,P.jsx)(u.Z,{sm:6,children:(0,P.jsx)(he.Z,{size:"sm",children:null!==n&&void 0!==n&&null!==(e=n.identityDocument)&&void 0!==e&&e.front?"Already Assigned":"Not Assigned"})}),(0,P.jsx)(u.Z,{size:6,children:(0,P.jsx)(j.Z,{context:"secondary",content:"Assign",size:"sm","data-cy":"AssignIdentityDocument",onClick:function(){return o("documentFrontSide")}})})]})},show:!0},{key:"Identity Card Back",value:null,calcAmount:function(){var e;return(0,P.jsxs)(d.Z,{children:[(0,P.jsx)(u.Z,{sm:6,children:(0,P.jsx)(he.Z,{size:"sm",children:null!==n&&void 0!==n&&null!==(e=n.identityDocument)&&void 0!==e&&e.back?"Already Assigned":"Not Assigned"})}),(0,P.jsx)(u.Z,{size:6,children:(0,P.jsx)(j.Z,{context:"secondary",content:"Assign",size:"sm","data-cy":"AssignIdentityDocument",onClick:function(){return o("documentBackSide")}})})]})},show:!0}];return(0,P.jsx)(x.Z,{open:!0,title:"Identity document",children:(0,P.jsx)(z.Z,{rows:i})})},$e=function(){var e=(0,a.useContext)(c.Z).hasRole,t=(0,o.useRouter)().query,n=(0,i.a)(s.JA,{variables:{id:parseInt(t.id)}}),r=n.data,p=(r=void 0===r?{user:{}}:r).user,m=n.loading,f=n.refetch;return!m&&(0,P.jsxs)(d.Z,{children:[(0,P.jsxs)(u.Z,{md:6,children:[(0,P.jsx)(T.g,{avatar:(0,l.Q)(p.media),editable:e("admin"),entity:{name:"".concat(p.nameFirst," ").concat(p.nameLast)},entityName:"User",prefix:"/dashboard/users/"}),(0,P.jsx)(ge,{refetch:f,user:p}),e("supplier")&&(0,P.jsx)(He,{userId:t.id,userMeta:p.meta}),e("admin")&&(0,P.jsx)(N,{userId:t.id})]}),(0,P.jsxs)(u.Z,{md:6,children:[(0,P.jsx)(le,{refetch:f,user:p}),(0,P.jsx)(I,{userId:p.id}),(0,P.jsx)(Ze,{id:p.id})]})]})},ze=function(){return(0,P.jsx)(r.Z,{View:(0,P.jsx)($e,{})})}},34341:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/users/view",function(){return n(3866)}])}},function(e){e.O(0,[367,284,4195,5312,7287,2002,3086,7134,3486,9082,3515,4712,1265,6996,9666,4177,8674,5146,899,3016,8412,9774,2888,179],(function(){return t=34341,e(e.s=t);var t}));var t=e.O();_N_E=t}]);