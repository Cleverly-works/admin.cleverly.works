(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8473],{92700:function(e,t,n){"use strict";n.d(t,{A:function(){return s}});var r=n(68794),a=n(85893),s=function(e){var t=e.dateClick,n=e.events,s=e.eventClick,i=e.eventContent,o=(e.hasLoading,e.height),u=e.initialView;return(0,a.jsx)(r.Z,{dateClick:t,eventClick:s,eventContent:i,events:n,hasLoading:!0,height:o,headerToolbar:{start:"prev,next today",center:"title",end:"dayGridMonth,timeGridWeek,timeGridDay,listWeek"},initialView:u})};s.defaultProps={initialView:"listWeek",hasLoading:!0,height:550}},76800:function(e,t,n){"use strict";n.d(t,{M:function(){return f}});var r=n(92809),a=n(10219),s=n(42426),i=n(19716),o=n(22796),u=n(85893),c=["control","errors","name","space"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=function(e){var t=e.control,n=e.errors,r=e.name,d=e.space,f=(0,a.Z)(e,c);return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(i.Z,l({control:t,errors:n,locale:s.Z,name:r},f)),d&&(0,u.jsx)(o.Z,{marginBottom:"sm"})]})};f.defaultProps={space:!0}},80382:function(e,t,n){"use strict";n.d(t,{f:function(){return _}});var r=n(92809),a=n(30266),s=n(80318),i=n(64687),o=n.n(i),u=n(75709),c=n(86007),d=n(42283),l=n(79665),f=n(97202),p=n(65375),v=n(46482),m=n(83528),y=n(76800),b=n(95146),h=n(75838),O=n(19501),g=function(e){return(0,O.Ry)().shape({startDate:(0,O.hT)().required(),endDate:(0,O.hT)().required().min((0,O.iH)("startDate"),"start date should be greater than end date"),meta:(0,O.Z_)(),notes:(0,O.Z_)(),alternativeUser:(0,O.Ry)().required(),user:e?(0,O.Ry)().required():(0,O.Ry)(),status:(0,O.Z_)().oneOf(["active","inactive"]).required()})},j=n(1323),x=n(85893);function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var _=function(e){var t=e.defaultValues,n=e.userId,r=e.onSuccess,i=(0,j.x)(),O=i.hasRole,D=i.user,_=O(["admin","superadmin"])&&!n,P=(0,d.cI)({defaultValues:t,resolver:(0,l.S)(g(_))}),Z=P.control,U=P.errors,C=P.handleSubmit,k=P.register,I=(0,u.D)(c.RZ,{onCompleted:function(){r&&r()}}),H=(0,s.Z)(I,1)[0],$=(0,u.D)(c.U7,{onCompleted:function(){r&&r()}}),R=(0,s.Z)($,1)[0],L=function(){var e=(0,a.Z)(o().mark((function e(r){var a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=r).alternativeUserId=r.alternativeUser.value,a.user&&a.user.value?a.userId=a.user.value:a.userId=n,delete a.alternativeUser,a.user&&delete a.user,!t.id){e.next=10;break}return e.next=8,R({variables:{id:t.id,changes:a}});case 8:e.next=12;break;case 10:return e.next=12,H({variables:{objects:[a]}});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S={control:Z,errors:U,register:k};return(0,x.jsxs)(f.Z,{id:"offCanvasForm",handleSubmit:C(L),children:[_&&(0,x.jsx)(b.P,w(w({},S),{},{errors:w({},U),accountId:D.accountId,label:"User",name:"user",type:"user"})),(0,x.jsx)(b.P,w(w({},S),{},{errors:w({},U),accountId:D.accountId,label:"Alternative User",name:"alternativeUser",type:"user"})),(0,x.jsx)(p.Z,{label:"Start date",children:(0,x.jsx)(y.M,w(w({},S),{},{dateFormat:"d MMM yyyy HH:mm",name:"startDate",placeholderText:"Click to select start date",showTimeSelect:!0}))}),(0,x.jsx)(p.Z,{label:"End date",children:(0,x.jsx)(y.M,w(w({},S),{},{name:"endDate",dateFormat:"d MMM yyyy HH:mm",placeholderText:"Click to select end date",showTimeSelect:!0}))}),(0,x.jsx)(p.Z,{label:"Status",children:(0,x.jsx)(v.Z,w(w({},S),{},{name:"status",options:h.bg}))}),(0,x.jsx)(p.Z,{label:"Notes",children:(0,x.jsx)(m.Z,w(w({},S),{},{name:"notes"}))})]})}},847:function(e,t,n){"use strict";n.d(t,{X:function(){return a}});var r=n(45697),a=function(e){var t=e.row,n=e.initialDate;return t?{id:t.id,alternativeUser:{value:t.AlternativeUser.id,label:t.AlternativeUser.fullName},user:{value:t.User.id,label:t.User.fullName},startDate:new Date(t.startDate),endDate:new Date(t.endDate),status:t.status.toLowerCase(),notes:t.notes}:{status:"active",startDate:n,endDate:n}};a.propTypes={row:r.object,initialDate:r.date}},86007:function(e,t,n){"use strict";n.d(t,{RZ:function(){return c},U7:function(){return d},Zd:function(){return f},M6:function(){return p}});var r,a,s,i,o=n(52209),u=n(54397),c=(0,u.Ps)(r||(r=(0,o.Z)(["\n  mutation addHoliday($objects: [Holiday_insert_input!]!) {\n    insert_Holiday(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),d=(0,u.Ps)(a||(a=(0,o.Z)(["\n  mutation updateHoliday($changes: Holiday_set_input = {}, $id: Int!) {\n    update_Holiday_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),l="{ User: { id: { _eq: $userId } }, meta: $meta }\norder_by: { startDate: asc, endDate: asc }",f=(0,u.Ps)(s||(s=(0,o.Z)(["\n  query GetHoliday($userId: Int!, $meta: jsonb_comparison_exp = {},$limit: Int,$offset: Int) {\n    Holiday(\n      limit: $limit\n      offset: $offset\n      where: ","\n    ) {\n      createdAt\n      endDate\n      id\n      notes\n      startDate\n      status\n      userId\n      AlternativeUser {\n        id\n        fullName\n        nameFirst\n        nameLast\n      }\n      User {\n        id\n        nameFirst\n        nameLast\n        fullName\n      }\n    }\n    meta: Holiday_aggregate(where:",") {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"])),l,l),p=(0,u.Ps)(i||(i=(0,o.Z)(['\n  query Holiday($startDate: timestamptz = "", $endDate: timestamptz = "", $userId: Int) {\n    events: Holiday(\n      where: {\n        _and: { startDate: { _gte: $startDate }, endDate: { _lte: $endDate } }\n        User: { id: { _eq: $userId } }\n      }\n    ) {\n      startDate\n      endDate\n      createdAt\n      id\n      notes\n      status\n      userId\n      User {\n        id\n        nameFirst\n        nameLast\n        fullName\n      }\n      AlternativeUser {\n        id\n        fullName\n        nameFirst\n        nameLast\n      }\n    }\n  }\n'])))},90358:function(e,t,n){"use strict";n.d(t,{t:function(){return a}});var r=n(17437),a=function(e){switch(e){case"raised":case"pending":return r.Q.COLOUR.info;case"offered":return r.Q.COLOUR.warning;case"accepted":return r.Q.COLOUR.success;case"inProgress":return r.Q.COLOUR.primary;case"completed":return"rgb(217,217,217)";case"reportSent":return"rgb(153, 153, 153)";case"invoiceSent":return r.Q.COLOUR.secondary;case"customerPaid":case"supplierPaid":return r.Q.COLOUR.help;case"closed":return r.Q.COLOUR.black;case"quoteOffered":case"quoteReceived":case"quoteNew":return"rgb(255,178, 255)";default:return r.Q.COLOUR.info}}},75838:function(e,t,n){"use strict";n.d(t,{bg:function(){return r},WG:function(){return a}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],a=[{text:"Status",value:""},{text:"Open",value:"open"},{text:"Resolved",value:"resolved"},{text:"Closed",value:"closed"}]},24775:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var r=n(66918),a=n(80284),s=n(30266),i=n(64687),o=n.n(i),u=n(67294),c=n(26075),d=n(86007),l=n(80880),f=n(92700),p=n(90358),v=n(1323),m=n(80382),y=n(847),b=n(85893),h=function(){var e=(0,v.x)(),t=e.hasRole,n=e.user,r=(0,c.x)(),a=t(["admin","superadmin"])?null:n.id,i=function(){var e=(0,s.Z)(o().mark((function e(t,n){var s,i,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.query({query:d.M6,variables:{userId:a,startDate:t.start,endDate:t.end}});case 2:s=e.sent,i=s.data,u=(i=void 0===i?{events:[]}:i).events,n(u.map((function(e){return{start:e.startDate,end:e.endDate,title:e.User.fullName,color:(0,p.t)(e.status),extendedProps:e}})));case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),h=(0,u.useContext)(l.Z),O=function(e){var t,n=null===e||void 0===e||null===(t=e.event)||void 0===t?void 0:t.extendedProps;h.show({content:(0,b.jsx)(m.f,{defaultValues:(0,y.X)({row:n,initialDate:!n&&new Date(e.date)}),onSuccess:h.close,userId:a}),title:n?"Edit":"Add Holiday"})};return(0,b.jsx)(f.A,{dateClick:O,eventClick:O,events:i,hasLoading:!0})},O=function(){return(0,b.jsx)(r.Z,{pageHeading:{heading:"Holiday Time"},children:(0,b.jsx)(a.Z,{open:!0,title:"Holiday",children:(0,b.jsx)(h,{})})})}},61686:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/holidays",function(){return n(24775)}])}},function(e){e.O(0,[284,4195,5312,7287,3086,7134,3486,9082,3515,1265,7123,5146,9774,2888,179],(function(){return t=61686,e(e.s=t);var t}));var t=e.O();_N_E=t}]);