(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6305],{26075:function(e,n,t){"use strict";t.d(n,{x:function(){return a}});var r=t(67294),o=t(47591),i=t(24273);function a(){var e=r.useContext((0,i.K)()).client;return __DEV__?(0,o.kG)(e,"No Apollo Client instance can be found. Please ensure that you have called `ApolloProvider` higher up in your tree."):(0,o.kG)(e,36),e}},93633:function(e,n,t){"use strict";t.d(n,{a:function(){return o}});var r=t(81322);function o(e,n){return(0,r.r)(e,n,!1)}},58448:function(e,n,t){"use strict";var r,o,i=t(30168),a=t(67294),s=t(45697),c=t(24237),u=function(e){var n=e.align,t=e.children;return a.createElement(l,{align:n,"aria-label":"Toolbar with button groups",role:"toolbar"},a.createElement(d,{role:"group","aria-label":"First group"},t))};u.displayName="ButtonToolbar";var l=c.ZP.div(r||(r=(0,i.Z)(["\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: ",";\n"])),(function(e){return e.align})),d=c.ZP.div(o||(o=(0,i.Z)(["\n  display: inline-flex;\n  position: relative;\n  vertical-align: middle;\n\n  a:hover {\n    color: white;\n  }\n\n  &:last-child > div:last-of-type button {\n    border-top-right-radius: 0.25rem;\n    border-bottom-right-radius: 0.25rem;\n    border-right: 0;\n  }\n\n  a:not(:last-child),\n  button:not(:last-child) {\n    border-bottom-right-radius: 0;\n    border-right: 1px solid ",";\n    border-top-right-radius: 0;\n  }\n\n  a:not(:first-child),\n  button:not(:first-child),\n  a:not(:first-child) button,\n  div:not(:first-child) button {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n    margin-left: 0;\n  }\n\n  a:not(:last-child) button,\n  div:not(:last-child) button {\n    border-bottom-right-radius: 0;\n    border-right: 1px solid ",";\n    border-top-right-radius: 0;\n  }\n"])),(function(e){return e.theme.COLOUR.light}),(function(e){return e.theme.COLOUR.light}));u.propTypes={align:s.string,children:s.node.isRequired},u.defaultProps={align:"center"},n.Z=u},71247:function(e,n,t){"use strict";var r=t(87462),o=t(70885),i=t(45987),a=t(67294),s=t(45697),c=t(42778),u=t(82373),l=t(49787),d=["disabled","errors","helperMessage","name","placeholder","readOnly","regExp","register","size","validate","withAddon"],p=function(e){var n=e.disabled,t=e.errors,s=e.helperMessage,u=e.name,p=e.placeholder,f=e.readOnly,g=(e.regExp,e.register),b=e.size,m=(e.validate,e.withAddon),h=(0,i.Z)(e,d),v=(0,a.useState)(!1),y=(0,o.Z)(v,2),O=y[0],j=y[1];return a.createElement(c.Z,(0,r.Z)({"aria-label":u,component:l.Z,disabled:n,helperMessage:s,onKeyDown:function(e){j(!0)},onBlur:function(){j(!1)},errors:t[u],isTyping:O,key:u,name:u,placeholder:p,readOnly:f,register:g,size:b,withAddon:m},h))};p.displayName="FormField",p.propTypes={accept:s.string,autoComplete:(0,s.oneOfType)([s.bool,s.string]),autoFocus:s.bool,disabled:s.bool,errors:s.object.isRequired,helperMessage:s.string,label:s.string,name:s.string.isRequired,placeholder:s.string,readOnly:s.bool,register:s.func.isRequired,size:(0,s.oneOf)([u.Z.SM,u.Z.MD,u.Z.LG]),style:s.object,textAlign:s.string,type:s.string,value:(0,s.oneOfType)([s.string,s.number,s.bool,(0,s.arrayOf)((0,s.oneOfType)([s.string,s.number,s.bool]))])},p.defaultProps={autoComplete:"off",autoFocus:!1,disabled:!1,errors:{},readOnly:!1,type:"text"},n.Z=p},21269:function(e,n,t){"use strict";var r,o,i,a,s,c=t(30168),u=t(67294),l=t(45697),d=t(24237),p=t(37815),f=t(82373),g=function(e){var n=e.addonType,t=(e.className,e.children),r=e.context,o=e.error,i=e.size,a=e.text,s=e.theme;return u.createElement(b,{addonType:n,className:n,children:t,context:r,error:o,size:i,text:a,theme:s})};g.displayName="InputGroupAddon";var b=d.ZP.div(r||(r=(0,c.Z)(["\n  align-items: center;\n  display: flex;\n\n  & > * {\n    height: 100%;\n  }\n\n  ","\n  ","\n\n  &,\n  button {\n    ","\n\n    ","\n  }\n"])),(function(e){var n=e.theme,t=n.COLOUR,r=n.FORM_ELEMENTS_STYLES,i=e.error;return e.text&&(0,d.iv)(o||(o=(0,c.Z)(["\n      background-color: ",";\n      border: 1px solid ",";\n      border-radius: ",";\n      color: ",";\n      display: flex;\n      font-size: 0.75rem;\n      font-weight: 400;\n      line-height: 1;\n      margin-bottom: 0;\n      padding: 0.375rem 1rem;\n      text-align: center;\n      transition: background-color 0.15s linear;\n      white-space: nowrap;\n    "])),i?t.danger:t.light,i?t.danger:t.dark,r.inputBorderRadius,i?t.light:t.dark)}),(function(e){return e.size===f.Z.SM&&(0,d.iv)(i||(i=(0,c.Z)(["\n      font-size: 0.625rem;\n      padding: 0 0.75rem;\n    "])))}),(function(e){return"prepend"===e.addonType&&(0,d.iv)(a||(a=(0,c.Z)(["\n        border-top-right-radius: 0;\n        border-bottom-right-radius: 0;\n        margin-right: -1px;\n      "])))}),(function(e){return"append"===e.addonType&&(0,d.iv)(s||(s=(0,c.Z)(["\n        border-top-left-radius: 0;\n        border-bottom-left-radius: 0;\n        margin-left: -1px;\n      "])))}));g.propTypes={addonType:(0,l.oneOf)(["prepend","append"]),className:l.any,children:l.node,context:(0,l.oneOf)(Object.values(p.Z)),text:l.bool},g.defaultProps={addonType:"append",context:"light"},n.Z=g},44442:function(e,n,t){"use strict";var r,o,i=t(30168),a=t(67294),s=t(45697),c=t(24237),u=function(e){var n=e.children,t=e.error,r=e.fullWidth,o=e.size,i=e.theme;return a.createElement(l,{children:n,error:t,fullWidth:r,size:o,theme:i})};u.displayName="InputGroup";var l=c.ZP.div(r||(r=(0,i.Z)(["\n  align-items: stretch;\n  display: flex;\n  flex-wrap: wrap;\n  position: relative;\n  width: 100%;\n\n  input {\n    ","\n    min-width: 0;\n    margin-bottom: 0;\n    position: relative;\n\n    :not(:first-child) {\n      border-top-left-radius: 0;\n      border-bottom-left-radius: 0;\n    }\n\n    :first-child {\n      border-top-right-radius: 0;\n      border-bottom-right-radius: 0;\n    }\n\n    :not(:last-child) {\n      border-top-right-radius: 0;\n      border-bottom-right-radius: 0;\n    }\n  }\n  ","\n"])),(function(e){return e.fullWidth?"flex: 1 1 0%;":"width: auto;"}),(function(e){var n=e.error,t=e.theme;return n&&t&&(0,c.iv)(o||(o=(0,i.Z)(["\n      &:hover {\n        .prepend,\n        .append {\n          background: ",";\n          border-color: ",";\n        }\n      }\n    "])),t.COLOUR.danger,t.COLOUR.danger)}));u.propTypes={fullWidth:s.bool,size:s.string},u.defaultProps={fullWidth:!0,size:"md"},n.Z=u},29444:function(e,n,t){"use strict";var r,o=t(30168),i=t(67294),a=t(45697),s=t(11163),c=t(24237),u=t(62906),l=function(e,n,t,r){return function(o){var a,c=o.row;a=c[r]||e;var u=function(){var t=c[r]||e;return"".concat(t,"?id=").concat(c[n])},l=c[t],p=c[n];return a?"-"!==l&&p?i.createElement(d,{border:!1,href:u(),onClick:function(e){e.preventDefault(),e.stopPropagation(),s.default.push(u())}},l):l||"-":l}},d=(0,c.ZP)(u.Z)(r||(r=(0,o.Z)(["\n  &:hover {\n    background: #ddd;\n    margin: -8px;\n    padding: 8px;\n  }\n"])));l.propTypes={row:a.object.isRequired},n.Z=l},80285:function(e,n){"use strict";n.Z=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GBP",t=new Intl.NumberFormat(["en-GB"],{currency:n,currencyDisplay:"symbol",style:"currency"});return t.format(e)}},63867:function(e,n){"use strict";n.Z=function(e){var n=window.location,t=n.protocol,r=n.host,o=n.pathname,i="".concat(t,"//").concat(r).concat(o).concat(e);window.history.pushState({path:i},"",i)}},67762:function(e){e.exports=function(e,n){for(var t,r=-1,o=e.length;++r<o;){var i=n(e[r]);void 0!==i&&(t=void 0===t?i:t+i)}return t}},73303:function(e,n,t){var r=t(67206),o=t(67762);e.exports=function(e,n){return e&&e.length?o(e,r(n,2)):0}},66805:function(e,n,t){"use strict";t.d(n,{H:function(){return l}});var r=t(92809),o=t(77417),i=t(58448),a=t(14347),s=t(85893);function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var l=function(e){var n=e.children,t=e.content,r=e.context,c=e.data,l=e.disabled,d=e.handleClick,p=e.size,f=e.type;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{size:"sm"}),(0,s.jsxs)(i.Z,{align:"flex-end",children:[n,(0,s.jsx)(a.Z,u({content:t,context:r,disabled:l,onClick:d,size:p,type:f},c))]})]})};l.defaultProps={content:"Add",context:"secondary",disabled:!1,size:"sm",type:"button"}},69399:function(e,n,t){"use strict";t.d(n,{r:function(){return i}});var r=t(46482),o=t(85893),i=function(e){var n=e.errors,t=e.name,i=e.onChange,a=e.options,s=e.register;return(0,o.jsx)(r.Z,{errors:n,name:t,onChange:i,options:a,register:s})};i.defaultProps={name:"status"}},81185:function(e,n,t){"use strict";t.d(n,{t:function(){return c}});var r=t(67294),o=t(11163),i=t(30493),a=t(52002),s=t(85893),c=(0,r.forwardRef)((function(e,n){var t=e.columns,c=e.history,u=e.initialSort,l=e.isResetTable,d=e.loading,p=e.meta,f=e.paginationSize,g=e.refetch,b=e.rowClick,m=e.rows,h=(0,o.useRouter)(),v=h.query,y=void 0===v?{}:v,O=(0,r.useState)(parseInt(null===y||void 0===y?void 0:y.page,10)||1),j=O[0],w=O[1],x=(0,r.useState)(i.C1.paginationSize),Z=x[0],P=x[1];u||(u={item:"createdAt",order:"desc"}),(0,r.useEffect)((function(){w(1)}),[l]);var S=(0,r.useState)({item:u.item,order:u.order}),_=S[0],C=S[1],k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=h.query,t=void 0===n?{}:n;e>1?t.page=e:delete t.page;var r=Object.keys(t).length>0;if(r){var o=Object.keys(t).map((function(n){return"page"===n?"".concat(n,"=").concat(e):"".concat(n,"=").concat(t[n])})).join("&&");return"?".concat(o)}return{}};(0,r.useImperativeHandle)(n,(function(){return{currentPage:j,pageSize:Z,sort:_,resetPagination:function(){!function(){C({item:u.item,order:u.order}),w(1);var e=k();h.push(e),P(i.C1.paginationSize)}()}}}));return(0,s.jsx)(a.Z,{columns:t,loading:d,paginationSize:f,pagination:p&&!0,paginationProps:p&&{currentPage:j,onPageChange:function(e){var n=k(e);c&&h.push(n),w(e),g&&g()},onPageSizeChange:function(e){e!==i.C1.paginationSize&&(P(e),g&&g())},pageCount:Math.ceil(p.aggregate.totalCount/Z),perPage:Z},rowClick:b,rows:m,sort:_,setSort:function(e){var n=e.item,t=e.order;C({item:n,order:t}),g&&g()}})}));c.defaultProps={history:!0,loading:!0,paginationSize:!1}},49705:function(e,n,t){"use strict";t.d(n,{x:function(){return l}});var r=t(92809),o=t(67294),i=t(63867),a=t(30493),s=t(34770);function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var l=function(e){var n,t,c,l,d,p,f,g,b,m,h,v=e.filters,y=e.initialSort,O=(0,o.useRef)();(0,o.useEffect)((function(){var e;(null===O||void 0===O||null===(e=O.current)||void 0===e?void 0:e.currentPage)>1&&(null===O||void 0===O||O.current.resetPagination(),(0,i.Z)("?page=1"))}),[v]);var j=y||{item:"createdAt",order:"desc"},w=(0,r.Z)({},(null===(n=O.current)||void 0===n?void 0:n.sort.item)||j.item,j.inneritem?(0,r.Z)({},j.inneritem,(null===(t=O.current)||void 0===t?void 0:t.sort.order)||j.order):(null===(c=O.current)||void 0===c?void 0:c.sort.order)||j.order);return{initialData:u(u({},v),{},{limit:"Infinity"===(null===(l=O.current)||void 0===l?void 0:l.pageSize)?null:parseInt(null===(d=O.current)||void 0===d?void 0:d.pageSize,10)||a.C1.paginationSize,offset:((null===(p=O.current)||void 0===p?void 0:p.currentPage)-1||0)*((null===(f=O.current)||void 0===f?void 0:f.pageSize)||a.C1.paginationSize),orderBy:(0,s.c)(null===(g=O.current)||void 0===g||null===(b=g.sort)||void 0===b||null===(m=b.item)||void 0===m?void 0:m.replace(/ORDER/i,null===(h=O.current)||void 0===h?void 0:h.sort.order))||w}),initialSort:y,ref:O}}},34770:function(e,n,t){"use strict";t.d(n,{s:function(){return r},c:function(){return o}});var r=function(e){try{JSON.parse(e)}catch(n){return!1}return!0},o=function(e){try{return JSON.parse(e)}catch(n){return!1}}},75838:function(e,n,t){"use strict";t.d(n,{bg:function(){return r},WG:function(){return o}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],o=[{text:"Status",value:""},{text:"Open",value:"open"},{text:"Resolved",value:"resolved"},{text:"Closed",value:"closed"}]},70316:function(e,n,t){"use strict";t.d(n,{J:function(){return C}});var r=t(92809),o=t(80318),i=t(10219),a=t(11163),s=t(67294),c=t(78215),u=t(2356),l=t(42283),d=t(97202),p=t(80284),f=t(65375),g=t(10973),b=t(14347),m=t(66805),h=t(69119),v=t(23855),y=t(83894);function O(e,n,t){var r=(0,s.useState)((function(){if(JSON.parse(window.sessionStorage.getItem(e))&&!Object.values(JSON.parse(window.sessionStorage[e])).includes(t))return n;try{var r=JSON.parse(window.sessionStorage.getItem(e));return r&&(r.startDate=r.startDate?(0,h.Z)((0,v.Z)(r.startDate)):null,r.endDate=r.endDate?(0,y.Z)((0,v.Z)(r.endDate)):null),r||n}catch(o){return console.log(o),n}})),o=r[0],i=r[1];return[o,function(n){try{var t=n instanceof Function?n(o):n;i(t),window.sessionStorage.setItem(e,JSON.stringify(t))}catch(r){console.log(r)}}]}var j=t(85893);function w(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function x(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?w(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var Z=function(e){var n=e.initialValues,t=e.renderFilters,r=e.setFilters,i=e.lastQuery,a=e.filters,h=n.filterType,v=O("form_data",n,h),y=(0,o.Z)(v,2),w=y[0],Z=y[1],P=(0,l.cI)({defaultValues:w||n}),S=P.control,_=P.errors,C=P.handleSubmit,k=P.register,q=P.reset,A=P.watch,E=P.setValue,D=x(x({},A()),{},{filterType:h});(0,s.useEffect)((function(){q(D)}),[q]),(0,s.useEffect)((function(){Z(D)}),[a]);var z=function(e){var t=e.query;if(t!==i){var o={q:"%".concat(t,"%")||0},a=/^\d+$/.test(t);"id"in n&&(o.id=a?Number(t):null),"meta"in n&&(o.meta=a?{invoiceNumbers:[t]}:null),"jobNumber"in n&&(o.jobNumber=a?String(t):null,o.invoiceNumber=a?Number(t):null),(o.id||o.meta||o.jobNumber)&&(o.q=null),r((function(e){return x(x({},e),o)}))}};return(0,j.jsx)(d.Z,{handleSubmit:C(z),children:(0,j.jsxs)(p.Z,{title:"Filters",children:[(0,j.jsxs)(c.Z,{children:[(0,j.jsx)(u.Z,{sm:12,lg:12,children:(0,j.jsx)(f.Z,{label:"",children:(0,j.jsx)(g.Z,{errors:_,label:"Search",name:"email",placeholder:"Search...",prependSearchIcon:!0,register:k,type:"search"})})}),(0,j.jsx)(u.Z,{sm:12,lg:12,children:t({control:S,errors:_,initialValues:n,register:k,setFilters:r,watch:A,setValue:E,reset:q})})]}),(0,j.jsx)(m.H,{content:"Search",context:"secondary",handleClick:z,type:"submit",children:(0,j.jsx)(b.Z,{content:"Clear",context:"danger",onClick:function(e){Object.keys(n).map((function(e){return E(e,null)})),r(n),q(n),z("")},size:"sm"})})]})})},P=["FiltersComp","initialFilters","TableComp"];function S(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function _(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?S(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):S(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var C=function(e){var n=e.FiltersComp,t=e.initialFilters,r=e.TableComp,l=(0,i.Z)(e,P),d=O("filters",t,t.filterType),p=(0,o.Z)(d,2),f=p[0],g=p[1],b=(0,s.useState)(f||t),m=b[0],h=b[1],v=(0,a.useRouter)().query.show;return(0,s.useEffect)((function(){g(m)}),[m]),(0,j.jsx)(c.Z,{children:(0,j.jsxs)(u.Z,{sm:12,lg:12,children:[(0,j.jsx)(Z,{initialValues:t,renderFilters:function(e){return(0,j.jsx)(n,_(_(_({},e),l),{},{show:v}))},setFilters:h,filters:m}),(0,j.jsx)(r,_({filters:m,initialFilters:t},l))]})})}},43434:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return z}});var r,o=t(66918),i=t(70316),a=t(11163),s=t(93633),c=t(52209),u=(0,t(54397).Ps)(r||(r=(0,c.Z)(['\n  query GetScheduledJobs($accountId: Int, $limit: Int, $offset: Int, $q: String, $status: String) {\n    properties: Location(\n      limit: $limit\n      offset: $offset\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n        status: { _eq: $status }\n        JobSchedules: {}\n        _or: [\n          { name: { _ilike: $q } }\n          {\n            Addresses: {\n              Address: { city: { _ilike: $q } }\n              entity: { _eq: "Location" }\n              registered: { _eq: true }\n            }\n          }\n          {\n            Addresses: {\n              Address: { postCode: { _ilike: $q } }\n              entity: { _eq: "Location" }\n              registered: { _eq: true }\n            }\n          }\n        ]\n      }\n    ) {\n      id\n      access\n      createdAt\n      name\n      contactUserId\n      addresses: Addresses(where: { entity: { _eq: "Location" } }) {\n        id\n        registered\n        operating\n        trading\n        invoice\n        status\n        address: Address {\n          id\n          name\n          addressLine1\n          addressLine2\n          addressLine3\n          city\n          county\n          geo\n          postCode\n          country: Country {\n            id\n            name\n          }\n        }\n      }\n      customer: Account_Locations {\n        id\n        account: Account {\n          id\n          name\n        }\n      }\n      compliances: Compliances(\n        where: { entity: { _eq: "Location" } }\n        order_by: { expiryAt: asc }\n      ) {\n        id\n        expiryAt\n        compliance: Compliance {\n          id\n          name\n        }\n      }\n      jobSchedules: JobSchedules {\n        id\n        jobs: Jobs(where: { status: { _neq: "canceled" } }) {\n          id\n          title\n          status\n          amount\n          supplierLabourAmount\n          type\n          timings: JobTimings {\n            id\n            status\n            createdAt\n          }\n        }\n        amounts: Jobs_aggregate(where: { status: { _neq: "canceled" } }) {\n          aggregate {\n            sum {\n              customerAmount: amount\n              supplierAmount: supplierLabourAmount\n            }\n          }\n        }\n      }\n      bookings: Jobs {\n        id\n        amount\n      }\n    }\n    meta: Location_aggregate(\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n        status: { _eq: $status }\n        JobSchedules: {}\n        _or: [\n          { name: { _ilike: $q } }\n          {\n            Addresses: {\n              Address: { city: { _ilike: $q } }\n              entity: { _eq: "Location" }\n              registered: { _eq: true }\n            }\n          }\n          {\n            Addresses: {\n              Address: { postCode: { _ilike: $q } }\n              entity: { _eq: "Location" }\n              registered: { _eq: true }\n            }\n          }\n        ]\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),l=t(29444),d=t(18944),p=t(80285),f=t(80284),g=t(81185),b=t(49705),m=t(73303),h=t.n(m),v=function(e){return h()(e,"amounts.aggregate.sum.supplierAmount")},y=t(85893),O=function(e){var n=e.filters,t=(0,b.x)({filters:n}),r=t.initialData,o=t.ref,i=(0,s.a)(u,{variables:r}),c=i.data,m=(c=void 0===c?{properties:[],meta:{aggregate:{totalCount:0}}}:c).properties,O=c.meta,j=i.loading,w=i.refetch,x=[{hidden:!0},{formatter:(0,l.Z)("/dashboard/properties/view","locationId","location"),text:"Property"},{hidden:!0},{formatter:(0,l.Z)("/dashboard/customers/view","customerId","customer"),text:"Customer"},{text:"Tasks"},{hidden:!0},{formatter:function(e){var n=e.row;return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)(d.Z,{size:"xs",children:["Customer ",(0,p.Z)(n.costCustomer)]}),(0,y.jsxs)(d.Z,{size:"xs",children:["Supplier ",(0,p.Z)(n.costSupplier)]})]})},text:"Cost"}];return(0,y.jsx)(f.Z,{open:!0,title:"Tasks",children:(0,y.jsx)(g.t,{columns:x,loading:j,meta:O,ref:o,refetch:w,rowClick:function(e){a.default.push("/dashboard/properties/view?id=".concat(e.locationId,"&tab=planned-maintenance"))},rows:m.map((function(e){return{locationId:e.id,location:e.name,customerId:e.customer[0].account.id,customer:e.customer[0].account.name,tasks:e.jobSchedules.length,costCustomer:(n=e.jobSchedules,h()(n,"amounts.aggregate.sum.customerAmount")),costSupplier:v(e.jobSchedules)};var n}))})})},j=t(92809),w=t(67294),x=t(78215),Z=t(2356),P=t(65375),S=t(95146),_=t(69399),C=t(75838);function k(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function q(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?k(Object(t),!0).forEach((function(n){(0,j.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):k(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var A=function(e){var n=e.control,t=e.errors,r=e.register,o=e.setFilters,i={control:n,errors:t,register:r},a=(0,e.watch)("accountId");return(0,w.useEffect)((function(){o((function(e){return q(q({},e),{},{accountId:(null===a||void 0===a?void 0:a.value)||null})}))}),[a]),(0,y.jsxs)(x.Z,{children:[(0,y.jsx)(Z.Z,{md:2,children:(0,y.jsx)(S.P,q(q({},i),{},{errors:q({},t),label:"",name:"accountId",placeholder:"Select customer"}))}),(0,y.jsx)(Z.Z,{md:2,children:(0,y.jsx)(P.Z,{children:(0,y.jsx)(_.r,q(q({},i),{},{onChange:function(e){return o((function(n){return q(q({},n),{},{status:e.target.value||null})}))},options:C.bg}))})})]})},E={accountId:null,q:null,status:null,filterType:"scheduled_job_table"},D=function(){return(0,y.jsx)(i.J,{FiltersComp:A,initialFilters:E,TableComp:O})},z=function(){return(0,y.jsx)(o.Z,{pageHeading:{heading:"Planned Maintenance"},View:(0,y.jsx)(D,{})})}},31211:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/scheduledjob",function(){return t(43434)}])}},function(e){e.O(0,[284,4195,5312,7287,2002,7134,9082,3515,7431,5146,9774,2888,179],(function(){return n=31211,e(e.s=n);var n}));var n=e.O();_N_E=n}]);