(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2833],{81185:function(e,t,n){"use strict";n.d(t,{t:function(){return c}});var r=n(67294),i=n(11163),o=n(30493),a=n(52002),s=n(85893),c=(0,r.forwardRef)((function(e,t){var n=e.columns,c=e.history,u=e.initialSort,l=e.isResetTable,d=e.loading,p=e.meta,m=e.paginationSize,f=e.refetch,j=e.rowClick,b=e.rows,v=(0,i.useRouter)(),g=v.query,x=void 0===g?{}:g,h=(0,r.useState)(parseInt(null===x||void 0===x?void 0:x.page,10)||1),O=h[0],y=h[1],S=(0,r.useState)(o.C1.paginationSize),Z=S[0],P=S[1];u||(u={item:"createdAt",order:"desc"}),(0,r.useEffect)((function(){y(1)}),[l]);var w=(0,r.useState)({item:u.item,order:u.order}),R=w[0],_=w[1],D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=v.query,n=void 0===t?{}:t;e>1?n.page=e:delete n.page;var r=Object.keys(n).length>0;if(r){var i=Object.keys(n).map((function(t){return"page"===t?"".concat(t,"=").concat(e):"".concat(t,"=").concat(n[t])})).join("&&");return"?".concat(i)}return{}};(0,r.useImperativeHandle)(t,(function(){return{currentPage:O,pageSize:Z,sort:R,resetPagination:function(){!function(){_({item:u.item,order:u.order}),y(1);var e=D();v.push(e),P(o.C1.paginationSize)}()}}}));return(0,s.jsx)(a.Z,{columns:n,loading:d,paginationSize:m,pagination:p&&!0,paginationProps:p&&{currentPage:O,onPageChange:function(e){var t=D(e);c&&v.push(t),y(e),f&&f()},onPageSizeChange:function(e){e!==o.C1.paginationSize&&(P(e),f&&f())},pageCount:Math.ceil(p.aggregate.totalCount/Z),perPage:Z},rowClick:j,rows:b,sort:R,setSort:function(e){var t=e.item,n=e.order;_({item:t,order:n}),f&&f()}})}));c.defaultProps={history:!0,loading:!0,paginationSize:!1}},49705:function(e,t,n){"use strict";n.d(t,{x:function(){return l}});var r=n(92809),i=n(67294),o=n(63867),a=n(30493),s=n(34770);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){var t,n,c,l,d,p,m,f,j,b,v,g=e.filters,x=e.initialSort,h=(0,i.useRef)();(0,i.useEffect)((function(){var e;(null===h||void 0===h||null===(e=h.current)||void 0===e?void 0:e.currentPage)>1&&(null===h||void 0===h||h.current.resetPagination(),(0,o.Z)("?page=1"))}),[g]);var O=x||{item:"createdAt",order:"desc"},y=(0,r.Z)({},(null===(t=h.current)||void 0===t?void 0:t.sort.item)||O.item,O.inneritem?(0,r.Z)({},O.inneritem,(null===(n=h.current)||void 0===n?void 0:n.sort.order)||O.order):(null===(c=h.current)||void 0===c?void 0:c.sort.order)||O.order);return{initialData:u(u({},g),{},{limit:"Infinity"===(null===(l=h.current)||void 0===l?void 0:l.pageSize)?null:parseInt(null===(d=h.current)||void 0===d?void 0:d.pageSize,10)||a.C1.paginationSize,offset:((null===(p=h.current)||void 0===p?void 0:p.currentPage)-1||0)*((null===(m=h.current)||void 0===m?void 0:m.pageSize)||a.C1.paginationSize),orderBy:(0,s.c)(null===(f=h.current)||void 0===f||null===(j=f.sort)||void 0===j||null===(b=j.item)||void 0===b?void 0:b.replace(/ORDER/i,null===(v=h.current)||void 0===v?void 0:v.sort.order))||y}),initialSort:x,ref:h}}},34770:function(e,t,n){"use strict";n.d(t,{s:function(){return r},c:function(){return i}});var r=function(e){try{JSON.parse(e)}catch(t){return!1}return!0},i=function(e){try{return JSON.parse(e)}catch(t){return!1}}},75838:function(e,t,n){"use strict";n.d(t,{bg:function(){return r},WG:function(){return i}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],i=[{text:"Status",value:""},{text:"Open",value:"open"},{text:"Resolved",value:"resolved"},{text:"Closed",value:"closed"}]},40759:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return oe}});var r,i,o,a,s=n(66918),c=n(30266),u=n(80318),l=n(64687),d=n.n(l),p=n(67294),m=n(93633),f=n(75709),j=n(52209),b=n(54397),v=(0,b.Ps)(r||(r=(0,j.Z)(["\n  query GetSlas($limit: Int, $offset: Int, $q: String, $orderBy: SLA_order_by!) {\n    slas: SLA(\n      limit: $limit\n      offset: $offset\n      where: { name: { _ilike: $q } }\n      order_by: [$orderBy]\n    ) {\n      id\n      name\n      notes\n      normalRate\n      oohRate\n      premiumRate\n      minimumInterval\n      minimumLength\n      onSite\n      onSiteUnit\n      jobReport\n      jobReportUnit\n      completion\n      completionUnit\n      status\n    }\n    meta: SLA_aggregate(where: { name: { _ilike: $q } }) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]))),g=((0,b.Ps)(i||(i=(0,j.Z)(["\n  query GetSla($id: Int!) {\n    sla: SLA_by_pk(id: $id) {\n      id\n      name\n      notes\n      normalRate\n      oohRate\n      premiumRate\n      onSite\n      onSiteUnit\n      jobReport\n      jobReportUnit\n      completion\n      completionUnit\n      minimumInterval\n      minimumLength\n    }\n  }\n"]))),(0,b.Ps)(o||(o=(0,j.Z)(["\n  mutation AddSla($objects: [SLA_insert_input!]!) {\n    insert_SLA(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"])))),x=(0,b.Ps)(a||(a=(0,j.Z)(["\n  mutation UpdateSla($id: Int!, $changes: SLA_set_input) {\n    update_SLA_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),h=n(80880),O=n(91126),y=n(58448),S=n(14347),Z=n(80284),P=n(81185),w=function(e){return e.normalRate=parseFloat(e.normalRate).toFixed(1),e.oohRate=parseFloat(e.oohRate).toFixed(1),e.premiumRate=parseFloat(e.premiumRate).toFixed(1),e},R=n(92809),_=n(42283),D=n(79665),C=n(97202),k=n(71247),E=n(78215),A=n(2356),N=n(65375),I=n(46482),$=n(83528),L=n(75838),F=n(85893);function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,R.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e){var t=e.errors,n=e.register,r=e.showStatus,i={errors:t,register:n};return(0,F.jsxs)(E.Z,{children:[(0,F.jsxs)(A.Z,{md:4,children:[(0,F.jsx)(N.Z,{label:"Name",children:(0,F.jsx)(k.Z,U(U({},i),{},{name:"name"}))}),r&&(0,F.jsx)(N.Z,{label:"Status",children:(0,F.jsx)(I.Z,U(U({},i),{},{name:"status",options:L.bg}))})]}),(0,F.jsx)(A.Z,{md:8,children:(0,F.jsx)(N.Z,{label:"Notes",children:(0,F.jsx)($.Z,U(U({},i),{},{name:"notes",rows:2}))})})]})},H=n(11417);function M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?M(Object(n),!0).forEach((function(t){(0,R.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):M(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(e){var t={errors:e.errors,min:0,register:e.register,type:"number"};return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(H.Z,{content:"Default Rates",tag:"h3"}),(0,F.jsxs)(E.Z,{children:[(0,F.jsx)(A.Z,{md:4,children:(0,F.jsx)(N.Z,{label:"Normal Rate",children:(0,F.jsx)(k.Z,J(J({},t),{},{name:"normalRate",step:"0.01"}))})}),(0,F.jsx)(A.Z,{md:4,children:(0,F.jsx)(N.Z,{label:"Out Of Hours Rate",children:(0,F.jsx)(k.Z,J(J({},t),{},{name:"oohRate",step:"0.01"}))})}),(0,F.jsx)(A.Z,{md:4,children:(0,F.jsx)(N.Z,{label:"Premium Rate",children:(0,F.jsx)(k.Z,J(J({},t),{},{name:"premiumRate",step:"0.01"}))})})]}),(0,F.jsxs)(E.Z,{children:[(0,F.jsx)(A.Z,{md:4,children:(0,F.jsx)(N.Z,{label:"Minimum Interval (minutes)",children:(0,F.jsx)(k.Z,J(J({},t),{},{name:"minimumInterval"}))})}),(0,F.jsx)(A.Z,{md:4,children:(0,F.jsx)(N.Z,{label:"Minimum Job Length (Hours)",children:(0,F.jsx)(k.Z,J(J({},t),{},{name:"minimumLength",step:"0.01"}))})})]})]})},B=n(24237);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){(0,R.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=function(e){var t={errors:e.errors,register:e.register};return(0,F.jsxs)(F.Fragment,{children:[(0,F.jsx)(H.Z,{content:"Timings",tag:"h3"}),(0,F.jsxs)(E.Z,{children:[(0,F.jsx)(A.Z,{md:4,children:(0,F.jsx)(N.Z,{label:"On Site",children:(0,F.jsxs)(W,{children:[(0,F.jsx)(k.Z,V(V({},t),{},{name:"onSite",type:"number",min:0})),(0,F.jsx)(I.Z,V(V({},t),{},{name:"onSiteUnit",label:"",options:[{text:"Select",value:""},{text:"Minutes",value:"minutes"},{text:"Hours",value:"hours"},{text:"Days",value:"days"}]}))]})})}),(0,F.jsx)(A.Z,{md:4,children:(0,F.jsx)(N.Z,{label:"Job Report",children:(0,F.jsxs)(W,{children:[(0,F.jsx)(k.Z,V(V({},t),{},{name:"jobReport",type:"number",min:0})),(0,F.jsx)(I.Z,V(V({},t),{},{name:"jobReportUnit",label:"",options:[{text:"Select",value:""},{text:"Minutes",value:"minutes"},{text:"Hours",value:"hours"},{text:"Days",value:"days"}]}))]})})}),(0,F.jsx)(A.Z,{md:4,children:(0,F.jsx)(N.Z,{label:"Completion",children:(0,F.jsxs)(W,{children:[(0,F.jsx)(k.Z,V(V({},t),{},{name:"completion",type:"number",min:0})),(0,F.jsx)(I.Z,V(V({},t),{},{name:"completionUnit",label:"",options:[{text:"Select",value:""},{text:"Minutes",value:"minutes"},{text:"Hours",value:"hours"},{text:"Days",value:"days"}]}))]})})})]})]})},W=B.ZP.div.withConfig({displayName:"timings__StyledOption",componentId:"sc-10cr621-0"})(["display:flex;max-width:180px;& input{margin-right:5px;text-align:center;width:70px;}& select{width:90px;}"]),K=n(19501),Q=(0,K.Ry)().shape({name:(0,K.Z_)().required(),status:(0,K.Z_)().when("id",{is:function(e){return e},then:(0,K.Z_)().oneOf(["active","inactive"]).required()}),group:(0,K.Rx)()});function Y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Y(Object(n),!0).forEach((function(t){(0,R.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te=function(e){var t=e.onSubmit,n=e.sla,r=(0,_.cI)({defaultValues:n,resolver:(0,D.S)(Q)}),i=r.errors,o=r.handleSubmit,a={errors:i,register:r.register};return(0,F.jsxs)(C.Z,{id:"offCanvasForm",handleSubmit:o(t),children:[(0,F.jsx)(q,ee(ee({},a),{},{showStatus:!(null===n||void 0===n||!n.id)})),(0,F.jsx)(T,ee({},a)),(0,F.jsx)(X,ee({},a)),(0,F.jsx)(k.Z,ee(ee({},a),{},{name:"id",type:"hidden"}))]})},ne=n(49705),re=n(1323),ie=function(){var e=(0,ne.x)({filters:{}}),t=e.initialData,n=e.ref,r=(0,re.x)().user,i=(0,p.useContext)(h.Z),o=(0,m.a)(v,{variables:t}),a=o.data,s=(a=void 0===a?{slas:[],meta:{aggregate:{totalCount:0}}}:a).slas,l=a.meta,j=o.loading,b=o.refetch,R=(0,f.D)(g),_=(0,u.Z)(R,1)[0],D=(0,f.D)(x),C=(0,u.Z)(D,1)[0],k=function(){var e=(0,c.Z)(d().mark((function e(t){return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Number(t.id)>0)){e.next=5;break}return e.next=3,C({variables:{id:t.id,changes:w(t)}});case 3:e.next=10;break;case 5:return delete t.id,t.status="active",t.adminId=r.accountId,e.next=10,_({variables:{objects:[w(t)]}});case 10:i.close(),b();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(e,t){e.stopPropagation(),i.show({content:(0,F.jsx)(te,{onSubmit:k,sla:null===t||void 0===t?void 0:t.sla}),title:"".concat(t?"Edit":"Add"," SLA"),width:"50%"})},A=[{hidden:!0},{text:"Name"},{text:"Normal",sortable:!0,sortName:"normalRate"},{text:"OOH",sortable:!0,sortName:"oohRate"},{text:"Premium",sortable:!0,sortName:"premiumRate"},{text:"On Site"},{text:"Job Report"},{text:"Completion"},{text:"Status"},{hidden:!0},{text:"Notes"},{formatter:O.Z,formatterData:[{content:"Edit",context:"secondary",icon:["fas","edit"],onClick:E,tooltip:"Edit"}],text:"Actions"}],N=function(){return(0,F.jsx)(y.Z,{children:(0,F.jsx)(S.Z,{context:"secondary",content:"Edit",onClick:E,size:"sm",children:"Create SLA"})})};return(0,F.jsx)(Z.Z,{toolbar:(0,F.jsx)(N,{}),open:!0,title:"SLAs",children:(0,F.jsx)(P.t,{columns:A,loading:j,meta:l,ref:n,refetch:b,rows:s.map((function(e){return{id:e.id,name:e.name,normalRate:parseFloat(e.normalRate).toFixed(1)+"x",oohRate:parseFloat(e.oohRate).toFixed(1)+"x",premiumRate:parseFloat(e.premiumRate).toFixed(1)+"x",onSite:e.onSite?"".concat(e.onSite," ").concat(e.onSiteUnit):"-",jobReport:e.jobReport?"".concat(e.jobReport," ").concat(e.jobReportUnit):"-",completion:e.completion?"".concat(e.completion," ").concat(e.completionUnit):"-",status:e.status,sla:e,notes:e.notes||"-",actions:""}}))})})},oe=function(){return(0,F.jsx)(s.Z,{pageHeading:{heading:"SLAs"},View:(0,F.jsx)(ie,{})})}},24633:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/slas",function(){return n(40759)}])}},function(e){e.O(0,[284,4195,5312,2002,3086,7134,3486,4712,598,9774,2888,179],(function(){return t=24633,e(e.s=t);var t}));var t=e.O();_N_E=t}]);