(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4208],{15067:function(t,e,n){"use strict";n.d(e,{K:function(){return P}});var r=n(67294),o=n(14347),i=n(80284),a=n(92809),c=n(93633),s=n(40682),u=n(80880),l=n(91126),d=n(18862),f=n(64509),p=n(58448),g=n(25610),v=n(75201),b=n(81185),j=n(49705),m=n(85893);function h(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function O(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?h(Object(n),!0).forEach((function(e){(0,a.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var y={item:"bookingStart",order:"asc"},x=function(t){var e=t.assetId,n=t.locationId,i=t.userId,a=(0,j.x)({filters:{},initialSort:y}),h=a.initialData,x=a.ref,S=(0,r.useContext)(u.Z),P=(0,c.a)(s.M8,{variables:O(O({},h),{},{assetId:e,userId:i})}),w=P.loading,k=P.data,I=(k=void 0===k?{asset:null}:k).assetBookings,Z=k.meta,C=P.refetch,D=function(){S.close()},E=[{hidden:!0},{text:"Asset",hidden:e},{text:"Title"},{text:"Start"},{text:"End"},{text:"Description"},{text:"Name"},{text:"All Day"},{formatter:l.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:function(t,r){return function(t,r){t.stopPropagation(),S.show({content:(0,m.jsx)(g.D,{assetId:e,data:r.data,locationId:n,onSuccess:D}),title:"Edit Booking",width:"40%"})}(t,r)},tooltip:"Edit"}],text:"Actions"}];return(0,m.jsxs)(m.Fragment,{children:[I&&(0,m.jsx)(b.t,{columns:E,initialSort:y,loading:w,meta:Z,ref:x,refetch:C,rowClick:function(t){S.show({content:(0,m.jsx)(v.e,{assetId:e,data:t.data,locationId:n}),submit:!1,title:"View Booking",width:"40%"})},rows:I.map((function(t){return{data:O(O({},t),{assetSelected:{label:t.asset.name,value:t.asset.id}}),asset:t.asset.name,title:t.title,bookingStart:"".concat((0,d.Z)(t.bookingStart)," - ").concat((0,f.Z)(t.bookingStart)),bookingEnd:"".concat((0,d.Z)(t.bookingEnd)," - ").concat((0,f.Z)(t.bookingEnd)),description:t.description,name:t.user.fullName,allDay:t.allDay,actions:""}}))}),(0,m.jsx)(p.Z,{align:"flex-end",children:(0,m.jsx)(o.Z,{content:"Make a booking",context:"secondary",onClick:function(){S.show({content:(0,m.jsx)(g.D,{assetId:e,locationId:n}),title:"Make a Booking",width:"40%"})},size:"sm"})})]})},S=n(56881),P=function(t){var e=t.assetId,n=t.locationId,a=(0,r.useState)(!0),c=a[0],s=a[1],u=function(){return(0,m.jsx)(o.Z,{context:"info",onClick:function(t){return function(t){t.stopPropagation(),s(!c)}(t)},size:"sm",startIcon:c?"table":"calendar-alt",startIconProps:{size:"lg"}})};return(0,m.jsx)(i.Z,{fitParentHeight:!0,open:!0,title:"Asset bookings",toolbar:(0,m.jsx)(u,{}),children:c?(0,m.jsx)(S.n,{assetId:e,locationId:n}):(0,m.jsx)(x,{assetId:e,locationId:n})})}},81185:function(t,e,n){"use strict";n.d(e,{t:function(){return s}});var r=n(67294),o=n(11163),i=n(30493),a=n(52002),c=n(85893),s=(0,r.forwardRef)((function(t,e){var n=t.columns,s=t.history,u=t.initialSort,l=t.isResetTable,d=t.loading,f=t.meta,p=t.paginationSize,g=t.refetch,v=t.rowClick,b=t.rows,j=(0,o.useRouter)(),m=j.query,h=void 0===m?{}:m,O=(0,r.useState)(parseInt(null===h||void 0===h?void 0:h.page,10)||1),y=O[0],x=O[1],S=(0,r.useState)(i.C1.paginationSize),P=S[0],w=S[1];u||(u={item:"createdAt",order:"desc"}),(0,r.useEffect)((function(){x(1)}),[l]);var k=(0,r.useState)({item:u.item,order:u.order}),I=k[0],Z=k[1],C=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=j.query,n=void 0===e?{}:e;t>1?n.page=t:delete n.page;var r=Object.keys(n).length>0;if(r){var o=Object.keys(n).map((function(e){return"page"===e?"".concat(e,"=").concat(t):"".concat(e,"=").concat(n[e])})).join("&&");return"?".concat(o)}return{}};(0,r.useImperativeHandle)(e,(function(){return{currentPage:y,pageSize:P,sort:I,resetPagination:function(){!function(){Z({item:u.item,order:u.order}),x(1);var t=C();j.push(t),w(i.C1.paginationSize)}()}}}));return(0,c.jsx)(a.Z,{columns:n,loading:d,paginationSize:p,pagination:f&&!0,paginationProps:f&&{currentPage:y,onPageChange:function(t){var e=C(t);s&&j.push(e),x(t),g&&g()},onPageSizeChange:function(t){t!==i.C1.paginationSize&&(w(t),g&&g())},pageCount:Math.ceil(f.aggregate.totalCount/P),perPage:P},rowClick:v,rows:b,sort:I,setSort:function(t){var e=t.item,n=t.order;Z({item:e,order:n}),g&&g()}})}));s.defaultProps={history:!0,loading:!0,paginationSize:!1}},49705:function(t,e,n){"use strict";n.d(e,{x:function(){return l}});var r=n(92809),o=n(67294),i=n(63867),a=n(30493),c=n(34770);function s(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach((function(e){(0,r.Z)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var l=function(t){var e,n,s,l,d,f,p,g,v,b,j,m=t.filters,h=t.initialSort,O=(0,o.useRef)();(0,o.useEffect)((function(){var t;(null===O||void 0===O||null===(t=O.current)||void 0===t?void 0:t.currentPage)>1&&(null===O||void 0===O||O.current.resetPagination(),(0,i.Z)("?page=1"))}),[m]);var y=h||{item:"createdAt",order:"desc"},x=(0,r.Z)({},(null===(e=O.current)||void 0===e?void 0:e.sort.item)||y.item,y.inneritem?(0,r.Z)({},y.inneritem,(null===(n=O.current)||void 0===n?void 0:n.sort.order)||y.order):(null===(s=O.current)||void 0===s?void 0:s.sort.order)||y.order);return{initialData:u(u({},m),{},{limit:"Infinity"===(null===(l=O.current)||void 0===l?void 0:l.pageSize)?null:parseInt(null===(d=O.current)||void 0===d?void 0:d.pageSize,10)||a.C1.paginationSize,offset:((null===(f=O.current)||void 0===f?void 0:f.currentPage)-1||0)*((null===(p=O.current)||void 0===p?void 0:p.pageSize)||a.C1.paginationSize),orderBy:(0,c.c)(null===(g=O.current)||void 0===g||null===(v=g.sort)||void 0===v||null===(b=v.item)||void 0===b?void 0:b.replace(/ORDER/i,null===(j=O.current)||void 0===j?void 0:j.sort.order))||x}),initialSort:h,ref:O}}},34770:function(t,e,n){"use strict";n.d(e,{s:function(){return r},c:function(){return o}});var r=function(t){try{JSON.parse(t)}catch(e){return!1}return!0},o=function(t){try{return JSON.parse(t)}catch(e){return!1}}},92341:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return p}});var r=n(66918),o=n(67294),i=n(43566),a=n(78215),c=n(2356),s=n(80284),u=n(15067),l=n(36178),d=n(85893),f=function(){var t=(0,o.useContext)(i.Z).user;return(0,d.jsxs)(a.Z,{children:[(0,d.jsx)(c.Z,{sm:12,md:6,children:(0,d.jsx)(s.Z,{fitParentHeight:!0,iconComponent:null,open:!0,title:"Property Bookings",children:(0,d.jsx)(l.Q,{filters:{userId:t.id}})})}),(0,d.jsx)(c.Z,{sm:12,md:(t.accountType,6),children:(0,d.jsx)(u.K,{userId:t.id})})]})},p=function(){return(0,d.jsx)(r.Z,{pageHeading:{heading:"My Bookings"},View:(0,d.jsx)(f,{})})}},83836:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/booking/view",function(){return n(92341)}])}},function(t){t.O(0,[284,4195,5312,7287,2002,3086,7134,3486,9082,3515,4712,1265,6996,4436,5146,6881,6178,9774,2888,179],(function(){return e=83836,t(t.s=e);var e}));var e=t.O();_N_E=e}]);