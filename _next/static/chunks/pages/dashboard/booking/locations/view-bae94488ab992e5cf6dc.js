(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[305],{25610:function(e,n,t){"use strict";t.d(n,{D:function(){return $}});var o=t(80318),i=t(92809),r=t(67294),s=t(38460),a=t(75709),d=t(40682),l=t(42283),c=t(79665),u=t(43566),m=t(18862),f=t(97202),g=t(78215),b=t(2356),v=t(93443),p=t(26398),y=t(65375),h=t(71247),k=t(83528),_=t(76800),j=t(95146),w=t(78416),x=t(19501),A=(0,x.Ry)().shape({title:(0,x.Z_)().required(),description:(0,x.Z_)(),bookingStart:(0,x.hT)().required(),bookingEnd:(0,x.hT)().required(),invitees:(0,x.Z_)()}),I=t(85893);function O(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function Z(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?O(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var $=function(e){var n,t=e.assetId,i=e.assetName,x=e.data,O=e.date,$=e.locationId,P=e.onSuccess,D=(0,r.useContext)(u.Z).user,S=(0,l.cI)({defaultValues:Z(Z({},x),{},{bookingStart:x.bookingStart?new Date(x.bookingStart):(0,w.ry)(O),bookingEnd:x.bookingEnd?new Date(x.bookingEnd):""}),resolver:(0,c.S)(A)}),T=S.control,C=S.errors,B=S.handleSubmit,E=S.register,q=S.watch,M=S.setValue,N=q("bookingStart"),F=(null===(n=q("assetSelected"))||void 0===n?void 0:n.value)||t,L=(0,s.t)(d.M8,{variables:{assetId:F,startDate:(0,m.Z)(new Date)}}),U=(0,o.Z)(L,2),z=U[0],G=U[1].data,H=(G=void 0===G?{assetBookings:[]}:G).assetBookings;(0,r.useEffect)((function(){z(),J()}),[F]);var W=(0,a.D)(d.ev,{onCompleted:function(e){P&&P()}}),R=(0,o.Z)(W,1)[0],V=(0,a.D)(d.W$,{onCompleted:function(e){P&&P()}}),X=(0,o.Z)(V,1)[0],J=function(){M("bookingStart",x.bookingStart?new Date(x.bookingStart):(0,w.ry)(O)),M("bookingEnd",x.bookingEnd?new Date(x.bookingEnd):"")},K=function(e){var n=e.time,t=e.endTime,o=void 0!==t&&t,i=o?new Date(N):new Date,r=new Date(n),s=H.filter((function(e){return e.id!==x.id})),a=s.map((function(e){return new Date(e.bookingStart).getTime()})),d=s.map((function(e){return new Date(e.bookingEnd).getTime()}));return r.getTime()>i.getTime()&&(0,w.CP)({selectedDate:r,assetBookingDateStarts:a,assetBookingDateEnds:d,endTime:o,minDate:o&&new Date(N)})},Q={control:T,isClearable:!1,errors:C,register:E};return(0,I.jsxs)(f.Z,{id:"offCanvasForm",handleSubmit:B((function(e){(0,w.iW)({assetId:t,form:e,user:D}),null!==x&&void 0!==x&&x.id?X({variables:{id:x.id,changes:e}}):R({variables:{objects:[e]}})})),children:[t?(0,I.jsx)(g.Z,{children:(0,I.jsx)(b.Z,{md:12,children:(0,I.jsx)(v.Z,{content:"Asset",text:(0,I.jsx)(p.Z,{border:!1,passHref:!0,to:"/dashboard/assets/view?id=".concat(t),children:i})})})}):(0,I.jsx)(g.Z,{children:(0,I.jsx)(b.Z,{md:12,children:(0,I.jsx)(j.P,Z(Z({},Q),{},{label:"Asset",locationId:$,name:"assetSelected",type:"assetBookable"}))})}),(0,I.jsx)(g.Z,{children:(0,I.jsx)(b.Z,{md:12,children:(0,I.jsx)(y.Z,{label:"Title",children:(0,I.jsx)(h.Z,Z(Z({},Q),{},{name:"title",placeholder:"Booking Title"}))})})}),(0,I.jsx)(y.Z,{label:"Start time"}),(0,I.jsx)(_.M,Z(Z({},Q),{},{onChange:function(e){M("bookingStart",new Date(e)),M("bookingEnd",null)},dateFormat:"d MMM yyyy HH:mm",filterTime:function(e){return K({time:e})},name:"bookingStart",showTimeSelect:!0,todayButton:!1})),(0,I.jsx)(y.Z,{label:"End time"}),(0,I.jsx)(_.M,Z(Z({},Q),{},{dateFormat:"d MMM yyyy HH:mm",filterTime:function(e){return K({time:e,endTime:!0})},minDate:new Date(N),name:"bookingEnd",showTimeSelect:!0,todayButton:!1})),(0,I.jsx)(g.Z,{children:(0,I.jsx)(b.Z,{md:12,children:(0,I.jsx)(y.Z,{label:"Invitees",children:(0,I.jsx)(h.Z,Z(Z({},Q),{},{multiple:!0,name:"invitees",type:"email",placeholder:"List of invitees separated by comma"}))})})}),(0,I.jsx)(g.Z,{children:(0,I.jsx)(b.Z,{md:12,children:(0,I.jsx)(y.Z,{label:"Description",children:(0,I.jsx)(k.Z,Z(Z({},Q),{},{name:"description",placeholder:"Booking Description",rows:2}))})})})]})};$.defaultProps={data:{},assetName:""}},78416:function(e,n,t){"use strict";t.d(n,{ry:function(){return r},lq:function(){return s},iW:function(){return a},CP:function(){return d}});var o=t(85817),i=t(92311),r=function(e){var n=(0,o.Z)(e),t=(0,o.Z)(new Date),r=n||t+1;return(0,i.Z)(e||new Date,{hours:r,minutes:0,seconds:0})},s=function(e){var n,t,o,i,r;return{allDay:e.allDay,assetSelected:{label:null===(n=e.extendedProps)||void 0===n?void 0:n.assetName,value:null===(t=e.extendedProps)||void 0===t?void 0:t.assetId},bookingEnd:e.end,bookingStart:e.start,color:e.backgroundColor,description:null===(o=e.extendedProps)||void 0===o?void 0:o.description,id:null===(i=e.extendedProps)||void 0===i?void 0:i.id,invitees:null===(r=e.extendedProps)||void 0===r?void 0:r.invitees,title:e.title}},a=function(e){var n=e.assetId,t=e.form,o=e.user;t.assetId=n,t.userId=o.id,t.color="green",t.status="active",n||(t.assetId=t.assetSelected.value,delete t.assetSelected),delete t.timing},d=function(){var e="",n="";return function(t){var o=t.selectedDate,i=t.assetBookingDateStarts,r=t.assetBookingDateEnds,s=t.endTime,a=t.minDate,d=i.find((function(e){return e===o.getTime()}));d&&(e=d);var l=r.find((function(e){return e===o.getTime()}));return l&&(n=l),!(o.getTime()>=e&&o.getTime()<=n)&&!(o.getTime()>=e&&o.getTime()<=e)&&!(s&&a<e&&o.getTime()>=e)}}()},40682:function(e,n,t){"use strict";t.d(n,{M8:function(){return d},ev:function(){return l},W$:function(){return c}});var o,i,r,s=t(52209),a=t(54397),d=(0,a.Ps)(o||(o=(0,s.Z)(['\n  query GetAssetBookings(\n    $assetId: Int\n    $startDate: timestamptz\n    $endDate: timestamptz\n    $userId: Int\n    $limit: Int\n    $offset: Int\n    $orderBy: [AssetBooking_order_by!]\n  ) {\n    assetBookings: AssetBooking(\n      where: {\n        assetId: { _eq: $assetId }\n        userId: { _eq: $userId }\n        status: { _eq: "active" }\n        _and: [{ bookingStart: { _gte: $startDate } }, { bookingStart: { _lte: $endDate } }]\n      }\n      limit: $limit\n      offset: $offset\n      order_by: $orderBy\n    ) {\n      allDay\n      bookingEnd\n      bookingStart\n      color\n      description\n      id\n      invitees\n      meta\n      title\n      asset: Asset {\n        id\n        name\n      }\n      user: User {\n        email\n        fullName\n      }\n    }\n    meta: AssetBooking_aggregate(\n      where: {\n        assetId: { _eq: $assetId }\n        userId: { _eq: $userId }\n        status: { _eq: "active" }\n        _and: [{ bookingStart: { _gte: $startDate } }, { bookingStart: { _lte: $endDate } }]\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),l=(0,a.Ps)(i||(i=(0,s.Z)(["\n  mutation AddAssetBooking($adminId: Int, $objects: [AssetBookingInput!]!) {\n    createAssetBookings(adminId: $adminId, bookings: $objects) {\n      data\n      success\n    }\n  }\n"]))),c=(0,a.Ps)(r||(r=(0,s.Z)(["\n  mutation UpdateAssetBooking($id: Int!, $changes: AssetBooking_set_input) {\n    update_AssetBooking_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"])))},42160:function(e,n,t){"use strict";var o=t(45697),i=function(e){var n=e.accountId,t=e.bookable,o=e.categoryId,i=e.customFilters,r=e.date,s=e.excludeCategoryId,a=e.locationId,d=e.limit,l=e.offset,c=e.orderBy,u=(e.q,{});return n&&(u.accountId={_eq:n}),t&&(u.bookable={_eq:t}),o&&(u.categoryId={_eq:o}),i&&(u.customFilters={_contains:i}),a&&(u.locationId={_eq:a}),name&&(u.name={_ilike:name}),s&&(u._not={categoryId:{_eq:s}}),{date:r,limit:d||50,offset:l||0,orderBy:c||"asc",where:u}};i.propTypes={filters:o.object},i.defaultProps={filters:{}},n.Z=i},64930:function(e,n,t){"use strict";t.d(n,{RL:function(){return p},yC:function(){return v},tG:function(){return b},Al:function(){return g},Wx:function(){return y}});var o,i,r,s,a,d,l,c,u=t(52209),m=t(54397),f=(0,m.Ps)(o||(o=(0,u.Z)(["\n  fragment AssetFields on Asset {\n    id\n    name\n    bookable\n    customFields\n    description\n    meta\n    status\n    createdAt\n  }\n"]))),g=(0,m.Ps)(i||(i=(0,u.Z)(['\n  query GetAssets(\n    $date: timestamptz\n    $limit: Int\n    $offset: Int\n    $orderBy: Asset_order_by!\n    $where: Asset_bool_exp\n  ) {\n    assets: Asset(limit: $limit, offset: $offset, where: $where, order_by: [$orderBy]) {\n      ...AssetFields\n      category: Category {\n        id\n        meta\n        name\n        childs: Taxonomies(order_by: { id: asc }) {\n          taxonomyId: id\n          name\n          type\n          meta\n        }\n      }\n      customer: Account {\n        id\n        name\n        type\n      }\n      location: Location {\n        id\n        name\n      }\n      userId: User {\n        value: id\n        label: fullName\n      }\n      parentId: ParentAsset {\n        value: id\n        label: fullName\n        category\n        media: Media(where: { entity: { _eq: "Asset" } }) {\n          id\n          item: Medium {\n            id\n            name\n            filename\n            category\n          }\n        }\n      }\n      media: Media {\n        medium: Medium {\n          id\n          filename\n        }\n      }\n\n      bookings: AssetBookings(\n        where: {\n          bookingStart: { _lte: $date }\n          bookingEnd: { _gte: $date }\n          status: { _eq: "active" }\n        }\n      ) {\n        id\n      }\n    }\n    meta: Asset_aggregate(where: $where) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n  ',"\n"])),f),b=(0,m.Ps)(r||(r=(0,u.Z)(['\n  query GetAssets(\n    $date: timestamptz\n    $limit: Int\n    $offset: Int\n    $orderBy: Asset_order_by!\n    $where: Asset_bool_exp\n  ) {\n    assets: Asset(limit: $limit, offset: $offset, where: $where, order_by: [$orderBy]) {\n      ...AssetFields\n      category: Category {\n        id\n        meta\n        name\n        childs: Taxonomies(order_by: { id: asc }) {\n          taxonomyId: id\n          name\n          type\n          meta\n        }\n      }\n      customer: Account {\n        id\n        name\n        type\n      }\n      location: Location {\n        id\n        name\n      }\n      userId: User {\n        value: id\n        label: fullName\n      }\n      parentId: ParentAsset {\n        value: id\n        label: fullName\n        category\n        media: Media(where: { entity: { _eq: "Asset" } }) {\n          id\n          item: Medium {\n            id\n            name\n            filename\n            category\n          }\n        }\n      }\n      media: Media {\n        medium: Medium {\n          id\n          filename\n        }\n      }\n      childAssets: Assets(limit: 1) {\n        logs: AssetLogs(limit: 1, order_by: { eventTime: desc }) {\n          value\n          eventTime\n        }\n      }\n      bookings: AssetBookings(\n        where: {\n          bookingStart: { _lte: $date }\n          bookingEnd: { _gte: $date }\n          status: { _eq: "active" }\n        }\n      ) {\n        id\n      }\n    }\n    meta: Asset_aggregate(where: $where) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n  ',"\n"])),f),v=(0,m.Ps)(s||(s=(0,u.Z)(['\n  query GetAsset($id: Int!) {\n    asset: Asset_by_pk(id: $id) {\n      ...AssetFields\n      sensorType: customFields(path: "$.Type")\n      category: Category {\n        id\n        name\n        sublocation: meta(path: "$.sublocation")\n        childs: Taxonomies(order_by: { id: asc }) {\n          taxonomyId: id\n          name\n          type\n          meta\n        }\n      }\n      customer: Account {\n        id\n        name\n        type\n      }\n      location: Location {\n        id\n        name\n      }\n      userId: User {\n        value: id\n        label: fullName\n      }\n      parentId: ParentAsset {\n        value: id\n        label: fullName\n        category\n        media: Media(where: { entity: { _eq: "Asset" } }) {\n          id\n          item: Medium {\n            id\n            name\n            filename\n            category\n          }\n        }\n      }\n    }\n  }\n  ',"\n"])),f),p=((0,m.Ps)(a||(a=(0,u.Z)(["\n  subscription GetAssetMeterByAssetId($assetId: Int!) {\n    meters: AssetMeter(where: { assetId: { _eq: $assetId } }, order_by: { id: desc }) {\n      id\n      name\n      unit\n      frequency\n      rangeLower\n      rangeUpper\n      status\n      meta\n      logs: AssetLogs(limit: 1000, order_by: { id: desc }) {\n        id\n        status\n        eventTime\n        type\n        value\n      }\n    }\n  }\n"]))),(0,m.Ps)(d||(d=(0,u.Z)(['\n  mutation AddAsset($objects: [Asset_insert_input!]!, $date: timestamptz) {\n    insert_Asset(objects: $objects) {\n      returning {\n        ...AssetFields\n        category: Category {\n          id\n          meta\n          name\n          childs: Taxonomies(order_by: { id: asc }) {\n            taxonomyId: id\n            name\n            type\n            meta\n          }\n        }\n        customer: Account {\n          id\n          name\n          type\n        }\n        location: Location {\n          id\n          name\n        }\n        userId: User {\n          value: id\n          label: fullName\n        }\n        parentId: ParentAsset {\n          value: id\n          label: fullName\n          category\n          media: Media(where: { entity: { _eq: "Asset" } }) {\n            id\n            item: Medium {\n              id\n              name\n              filename\n              category\n            }\n          }\n        }\n        media: Media {\n          medium: Medium {\n            id\n            filename\n          }\n        }\n        childAssets: Assets(limit: 1) {\n          logs: AssetLogs(limit: 1, order_by: { eventTime: desc }) {\n            value\n            eventTime\n          }\n        }\n        bookings: AssetBookings(\n          where: {\n            bookingStart: { _lte: $date }\n            bookingEnd: { _gte: $date }\n            status: { _eq: "active" }\n          }\n        ) {\n          id\n        }\n      }\n    }\n  }\n  ',"\n"])),f)),y=(0,m.Ps)(l||(l=(0,u.Z)(["\n  mutation UpdateAsset($id: Int!, $changes: Asset_set_input) {\n    update_Asset_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n      name\n      bookable\n      customFields\n      description\n      meta\n      status\n    }\n  }\n"])));(0,m.Ps)(c||(c=(0,u.Z)(["\n  mutation DeleteAsset($id: Int!) {\n    delete_Asset_by_pk(id: $id) {\n      id\n    }\n  }\n"])))},67082:function(e,n,t){"use strict";t.d(n,{T:function(){return h}});var o=t(92809),i=t(67294),r=t(42283),s=t(24237),a=t(80880),d=t(20305),l=t(78215),c=t(2356),u=t(46482),m=t(22796),f=t(34717),g=t(25610),b=t(83479),v=t(85893);function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var h=function(e){var n=e.assets,t=e.locationId,o=e.onSuccess,s=e.sublocations,p=(0,i.useContext)(a.Z),h=(0,i.useState)(null),_=h[0],j=h[1],w=(0,i.useState)(null),x=w[0],A=w[1],I=(0,r.cI)(),O={control:I.control,errors:I.errors,register:I.register},Z=function(e){var n,t,o=s.find((function(n){return n.id===e})),i=null===o||void 0===o||null===(n=o.media[0])||void 0===n||null===(t=n.medium)||void 0===t?void 0:t.filename,r="".concat("https://d1hk88326p7ilp.cloudfront.net","/").concat(i);A(i?r:null)};return(0,i.useEffect)((function(){var e;if(null!==(e=s[0])&&void 0!==e&&e.id){var n,t=null===(n=s[0])||void 0===n?void 0:n.id;j(t),Z(t)}}),[]),(0,v.jsx)(v.Fragment,{children:(0,v.jsxs)(l.Z,{children:[(0,v.jsx)(c.Z,{md:3,children:(0,v.jsx)(u.Z,y(y({},O),{},{name:"status",options:function(){for(var e=[],n=0;n<s.length;n++){var t,o,i;e.push({text:s[n].name,value:s[n].id,filename:null===(t=s[n])||void 0===t||null===(o=t.media[0])||void 0===o||null===(i=o.medium)||void 0===i?void 0:i.filename})}return e}(),onChange:function(e){return function(e){var n=Number(e.target.value);j(n),Z(n)}(e)}}))}),(0,v.jsx)(m.Z,{}),(0,v.jsx)(c.Z,{md:12,children:(0,v.jsx)(k,{children:(0,v.jsx)(f.Z,{item:{filename:x},initialZoomLevel:1,maxZoomLevel:14,markers:function(){for(var e=[],t=0;t<n.length;t++){var o,i,r,s,a,l,c,u,m,f,g,p;if((null===(o=n[t].parentId)||void 0===o?void 0:o.value)===_&&null!==(i=n[t].meta)&&void 0!==i&&i.coordinates)e.push({icon:null!==(r=null===(s=n[t].meta)||void 0===s||null===(a=s.markerStyles)||void 0===a||null===(l=a.shape)||void 0===l?void 0:l.icon)&&void 0!==r?r:"circle",popupComponent:(0,v.jsxs)(v.Fragment,{children:[n[t].name,(0,v.jsx)("br",{}),(null===(c=n[t].childAssets)||void 0===c?void 0:c.length)&&(null===(u=n[t].childAssets[0].logs)||void 0===u?void 0:u.length)&&(0,d.Z)(n[t].childAssets[0].logs[0].eventTime)||"",(0,v.jsx)("br",{}),"green"===(0,b.t)({asset:n[t]})?"Unoccupied":"Occupied"]}),x:null===(m=n[t].meta)||void 0===m||null===(f=m.coordinates)||void 0===f?void 0:f.x,y:null===(g=n[t].meta)||void 0===g||null===(p=g.coordinates)||void 0===p?void 0:p.y,colour:(0,b.t)({asset:n[t]}),data:n[t],id:n[t].id,name:n[t].name})}return e}(),onMarkerClick:function(e){p.show({content:(0,v.jsx)(g.D,{assetId:e.data.id,locationId:t,onSuccess:o}),title:"Add asset booking"})}})})})]})})},k=s.ZP.div.withConfig({displayName:"canvas__StyledContainer",componentId:"sc-1t5eak-0"})(["padding:1rem;position:relative;"]);h.defaultProps={}},83479:function(e,n,t){"use strict";t.d(n,{t:function(){return r},l:function(){return s}});var o=t(29444),i=t(91126),r=function(e){var n,t,o,i,r=e.asset;if(r){var s="green",a=!1;null!==(n=r.childAssets)&&void 0!==n&&n.length&&null!==(t=r.childAssets[0].logs)&&void 0!==t&&t.length&&(a=r.childAssets[0].logs[0].value);var d=(null===(o=r.bookings)||void 0===o?void 0:o.length)&&(null===(i=r.bookings)||void 0===i?void 0:i.length)>0;return("true"===a||d)&&(s="red"),s}},s=function(e){var n=e.handleBookingCanvas,t=e.handleEditLocation,r=e.handleEditCanvas,s=e.locationId;return[{hidden:!0},{hidden:!0},{hidden:!0},{text:"Name"},{text:"Category"},{hidden:s,formatter:(0,o.Z)("/dashboard/properties/view","locationId","location"),text:"Location"},{hidden:s,formatter:(0,o.Z)("/dashboard/customers/view","customerId","customer"),text:"Customer"},{sortable:!0,sortName:"createdAt",text:"Created"},{formatter:i.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:r,tooltip:"Edit Asset"},{context:"secondary",icon:["fas","plus"],onClick:n,tooltip:"Make a booking"},{context:"primary",icon:["fas","map-marker-alt"],onClick:t,tooltip:"Edit Location",hidden:!0}],text:"Actions"}]}},76800:function(e,n,t){"use strict";t.d(n,{M:function(){return m}});var o=t(92809),i=t(10219),r=t(42426),s=t(19716),a=t(22796),d=t(85893),l=["control","errors","name","space"];function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){(0,o.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var m=function(e){var n=e.control,t=e.errors,o=e.name,c=e.space,m=(0,i.Z)(e,l);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(s.Z,u({control:n,errors:t,locale:r.Z,name:o},m)),c&&(0,d.jsx)(a.Z,{marginBottom:"sm"})]})};m.defaultProps={space:!0}},64974:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return k}});var o=t(66918),i=t(92809),r=t(67294),s=t(11163),a=t(93633),d=t(64930),l=t(80880),c=t(97721),u=t(4513),m=t(67082),f=t(30493),g=t(42160),b=t(85893);function v(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?v(Object(t),!0).forEach((function(n){(0,i.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var y=new Date,h=function(){var e,n,t,o=(0,r.useRef)(),v=(0,r.useContext)(l.Z),h=(0,s.useRouter)().query,k=h.id,_=p(p({date:y,excludeCategoryId:0},{locationId:parseInt(k)}),{},{limit:f.C1.paginationSize,offset:((null===(e=o.current)||void 0===e?void 0:e.currentPage)-1||0)*f.C1.paginationSize,orderBy:(0,i.Z)({},null===(n=o.current)||void 0===n?void 0:n.sort.item,null===(t=o.current)||void 0===t?void 0:t.sort.order)}),j=(0,a.a)(d.tG,{variables:(0,g.Z)(_)}),w=j.data,x=(w=void 0===w?{assets:[],meta:{aggregate:{totalCount:0}}}:w).assets,A=j.loading,I=j.refetch;if(A)return(0,b.jsx)(c.Z,{indicator:(0,b.jsx)(u.Z,{})});var O=x.filter((function(e){var n;(n=null===e||void 0===e?void 0:e.category).meta&&Object.keys(n.meta).some((function(e){return"sublocation"===e&&!0===n.meta[e]}))})),Z=x.filter((function(e){return!O.find((function(n){return n.id===e.id}))}));return(0,b.jsx)(m.T,{assets:Z,locationId:h.id,onSuccess:function(){I(),v.close()},sublocations:O})},k=function(){return(0,b.jsx)(o.Z,{pageHeading:{heading:""},View:(0,b.jsx)(h,{})})}},93229:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/booking/locations/view",function(){return t(64974)}])}},function(e){e.O(0,[9774,4195,5312,7287,3086,7134,3486,9082,3515,4712,1265,5597,4829,4956,5146,2888,179],(function(){return n=93229,e(e.s=n);var n}));var n=e.O();_N_E=n}]);