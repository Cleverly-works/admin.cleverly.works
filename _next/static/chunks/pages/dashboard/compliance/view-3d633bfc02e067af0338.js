(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4873],{61131:function(e,n,t){"use strict";t.d(n,{z:function(){return $}});var r=t(92809),a=t(30266),i=t(80318),o=t(64687),c=t.n(o),s=t(75709),u=t(33434),d=t(42283),l=t(79665),m=t(97202),p=t(65375),x=t(71247),f=t(83528),v=t(84550),y=t(46482),g=t(1323),j=t(75838),b=t(72197),h=t(19501),Z=(0,h.Ry)().shape({name:(0,h.Z_)().required(),status:(0,h.Z_)().oneOf(["active","inactive"]).required(),complianceCategorySelected:(0,h.Ry)().required(),url:(0,h.Z_)().url()}),_=function(e){var n=e.form,t=e.id,r=e.user;return n.categoryId=n.complianceCategorySelected.value,delete n.complianceCategorySelected,t?{id:t,changes:n}:(n.adminId=r.accountId,{objects:[n]})},C=t(85893);function w(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function O(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?w(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):w(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var $=function(e){var n=e.defaultValues,t=e.onSuccess,r=(0,g.x)().user,o=(0,d.cI)({defaultValues:n,resolver:(0,l.S)(Z)}),h=o.control,w=o.errors,$=o.handleSubmit,A=o.register,E=(0,s.D)(u.gO,{onCompleted:function(e){var n=e.insert_Compliance.returning[0].id;t&&t(n)}}),S=(0,i.Z)(E,1)[0],k=(0,s.D)(u.Vd,{onCompleted:function(e){var n=e.update_Compliance_by_pk.id;t&&t(n)}}),I=(0,i.Z)(k,1)[0],N=function(){var e=(0,a.Z)(c().mark((function e(t){var a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=_({form:t,id:n.id,user:r}),!n.id){e.next=6;break}return e.next=4,I({variables:a});case 4:e.next=8;break;case 6:return e.next=8,S({variables:a});case 8:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),P={control:h,errors:w,register:A};return(0,C.jsxs)(m.Z,{id:"offCanvasForm",handleSubmit:$(N),children:[(0,C.jsx)(p.Z,{label:"Name",children:(0,C.jsx)(x.Z,O(O({},P),{},{name:"name"}))}),(0,C.jsx)(b.l,O(O({},P),{},{label:"Category",name:"complianceCategorySelected",type:"complianceCategory"})),(0,C.jsx)(p.Z,{label:"Description",children:(0,C.jsx)(f.Z,O(O({},P),{},{name:"description",rows:2}))}),(0,C.jsx)(p.Z,{label:"Governing Body",children:(0,C.jsx)(x.Z,O(O({},P),{},{name:"governingBody"}))}),(0,C.jsx)(p.Z,{label:"Registration number example",children:(0,C.jsx)(x.Z,O(O({},P),{},{name:"regNumExample"}))}),(0,C.jsx)(p.Z,{label:"URL",children:(0,C.jsx)(x.Z,O(O({},P),{},{name:"url"}))}),(0,C.jsx)(v.Z,O(O({},P),{},{data:[{id:"hasInsuranceAmount",label:"Has Insurance Amount Attached"}],name:"hasInsuranceAmount"})),(0,C.jsx)(v.Z,O(O({},P),{},{data:[{id:"expectCertificate",label:"Expect Certificate"}],name:"expectCertificate"})),(0,C.jsx)(p.Z,{label:"Status",children:(0,C.jsx)(y.Z,O(O({},P),{},{name:"status",options:j.bg}))})]})}},33434:function(e,n,t){"use strict";t.d(n,{$i:function(){return u},G1:function(){return d},gO:function(){return l},Vd:function(){return m}});var r,a,i,o,c=t(52209),s=t(54397),u=(0,s.Ps)(r||(r=(0,c.Z)(["\n  query GetCompliace($id: Int!) {\n    compliance: Compliance_by_pk(id: $id) {\n      id\n      name\n      url\n      regNumExample\n      status\n      type\n      governingBody\n      hasInsuranceAmount\n      description\n      createdAt\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      Compliance_Entities {\n        Location {\n          id\n          name\n          status\n        }\n        Account {\n          id\n          name\n          type\n        }\n      }\n    }\n  }\n"]))),d=(0,s.Ps)(a||(a=(0,c.Z)(['\n  query GetCompliances(\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: Compliance_order_by!\n    $status: String\n    $type: String\n  ) {\n    compliance: Compliance(\n      limit: $limit\n      offset: $offset\n      where: { name: { _ilike: $q }, status: { _eq: $status }, type: { _eq: $type } }\n      order_by: [$orderBy]\n    ) {\n      id\n      name\n      description\n      status\n      regNumExample\n      hasInsuranceAmount\n      expectCertificate\n      url\n      governingBody\n      createdAt\n      category: Category {\n        id\n        name\n      }\n      questions: Taxonomies {\n        id\n      }\n      media: Media(where: { entity: { _eq: "Compliance" } }) {\n        mediaId\n      }\n    }\n    meta: Compliance_aggregate(\n      where: { name: { _ilike: $q }, status: { _eq: $status }, type: { _eq: $type } }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),l=(0,s.Ps)(i||(i=(0,c.Z)(["\n  mutation AddCompliance($objects: [Compliance_insert_input!]!) {\n    insert_Compliance(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),m=(0,s.Ps)(o||(o=(0,c.Z)(["\n  mutation UpdateCompliance($id: Int!, $changes: Compliance_set_input) {\n    update_Compliance_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"])))},75838:function(e,n,t){"use strict";t.d(n,{bg:function(){return r},WG:function(){return a}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],a=[{text:"Status",value:""},{text:"Open",value:"open"},{text:"Resolved",value:"resolved"},{text:"Closed",value:"closed"}]},59309:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return w}});var r=t(66918),a=t(11163),i=t(93633),o=t(33434),c=t(29444),s=t(78215),u=t(2356),d=t(80284),l=t(52002),m=t(85893),p=function(e){var n=e.summary,t=e.columns,r=e.rows;return(0,m.jsx)(d.Z,{open:!0,title:n,children:(0,m.jsx)(l.Z,{columns:t,rows:r})})},x=t(67294),f=t(80880),v=t(58448),y=t(14347),g=t(93443),j=t(18862),b=t(61131),h=function(e){var n=e.refetch,t=e.compliance,r=(0,x.useContext)(f.Z),a=function(){n(),r.close()},i=function(e){var n=t;r.show({content:(0,m.jsx)(b.z,{defaultValues:t,onSuccess:a}),title:n.id?"Edit":"Add Compliance"}),e.stopPropagation()},o=function(){return(0,m.jsx)(v.Z,{children:(0,m.jsx)(y.Z,{context:"secondary",content:"Edit",onClick:i,size:"sm"})})};return(0,m.jsxs)(d.Z,{toolbar:(0,m.jsx)(o,{}),open:!0,title:"Details",children:[(0,m.jsx)(g.Z,{content:"Name",text:t.name}),(0,m.jsx)(g.Z,{content:"Example Reg Number",text:t.regNumExample?t.regNumExample:"-"}),(0,m.jsx)(g.Z,{content:"Governing Body",text:t.governingBody?t.governingBody:"-"}),(0,m.jsx)(g.Z,{content:"Expect Certificate",text:t.expectCertificate?"Yes":"No"}),(0,m.jsx)(g.Z,{content:"Has Insurance Amount",text:t.hasInsuranceAmount?"Yes":"No"}),(0,m.jsx)(g.Z,{content:"Status",text:t.status?t.status:"-"}),(0,m.jsx)(g.Z,{content:"Type",text:t.type?t.type:"-"}),(0,m.jsx)(g.Z,{content:"Date Added",text:(0,j.Z)(t.createdAt)?(0,j.Z)(t.createdAt):"-"})]})},Z=t(28323),_=t(77567),C=function(){var e=(0,a.useRouter)().query,n=(0,i.a)(o.$i,{variables:{id:e.id}}),t=n.loading,r=n.data,d=(r=void 0===r?{compliance:[]}:r).compliance,l=n.refetch,x=d.Compliance_Entities,f=d.id,v=d.name,y=d.url,g=[{hidden:!0},{formatter:(0,c.Z)("/dashboard","id","name",!0),text:"Account"},{text:"Type"}],j=[{hidden:!0},{formatter:(0,c.Z)("/dashboard","id","name",!0),text:"Account"},{text:"Status"}];return t?null:(0,m.jsxs)(s.Z,{children:[(0,m.jsxs)(u.Z,{md:3,children:[(0,m.jsx)(_.g,{avatar:(0,Z.Q)(d.media),entity:{id:f,name:v,website:y},entityName:"Compliance",prefix:"/dashboard/compliance/"}),(0,m.jsx)(h,{refetch:l,compliance:d})]}),(0,m.jsx)(u.Z,{md:3,children:(0,m.jsx)(p,{summary:"Accounts",columns:g,rows:function(){var e=[];return Object.keys(x).map((function(n,t){var r,a,i;return e.push({id:null===(r=x[n].Account)||void 0===r?void 0:r.id,name:null===(a=x[n].Account)||void 0===a?void 0:a.name,type:null===(i=x[n].Account)||void 0===i?void 0:i.type})})),e}()})}),(0,m.jsx)(u.Z,{md:3,children:(0,m.jsx)(p,{summary:"Properties",columns:j,rows:function(){var e=[];return Object.keys(x).map((function(n,t){var r,a,i;return e.push({id:null===(r=x[n].Location)||void 0===r?void 0:r.id,name:null===(a=x[n].Location)||void 0===a?void 0:a.name,status:null===(i=x[n].Location)||void 0===i?void 0:i.status})})),e}()})})]})},w=function(){return(0,m.jsx)(r.Z,{View:(0,m.jsx)(C,{})})}},34287:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/compliance/view",function(){return t(59309)}])}},function(e){e.O(0,[367,284,4195,5312,7287,2002,3086,7134,3486,9082,3515,4712,1265,6996,9666,4177,2893,5146,899,3016,9774,2888,179],(function(){return n=34287,e(e.s=n);var n}));var n=e.O();_N_E=n}]);