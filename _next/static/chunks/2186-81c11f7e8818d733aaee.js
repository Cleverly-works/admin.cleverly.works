"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2186],{66805:function(e,t,n){n.d(t,{H:function(){return l}});var r=n(92809),o=n(77417),i=n(58448),a=n(14347),s=n(85893);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){var t=e.children,n=e.content,r=e.context,u=e.data,l=e.disabled,p=e.handleClick,d=e.size,y=e.type;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{size:"sm"}),(0,s.jsxs)(i.Z,{align:"flex-end",children:[t,(0,s.jsx)(a.Z,c({content:n,context:r,disabled:l,onClick:p,size:d,type:y},u))]})]})};l.defaultProps={content:"Add",context:"secondary",disabled:!1,size:"sm",type:"button"}},69399:function(e,t,n){n.d(t,{r:function(){return i}});var r=n(46482),o=n(85893),i=function(e){var t=e.errors,n=e.name,i=e.onChange,a=e.options,s=e.register;return(0,o.jsx)(r.Z,{errors:t,name:n,onChange:i,options:a,register:s})};i.defaultProps={name:"status"}},81185:function(e,t,n){n.d(t,{t:function(){return u}});var r=n(67294),o=n(11163),i=n(30493),a=n(52002),s=n(85893),u=(0,r.forwardRef)((function(e,t){var n=e.columns,u=e.history,c=e.initialSort,l=e.isResetTable,p=e.loading,d=e.meta,y=e.paginationSize,f=e.refetch,m=e.rowClick,b=e.rows,v=(0,o.useRouter)(),g=v.query,j=void 0===g?{}:g,O=(0,r.useState)(parseInt(null===j||void 0===j?void 0:j.page,10)||1),h=O[0],x=O[1],S=(0,r.useState)(i.C1.paginationSize),P=S[0],Z=S[1];c||(c={item:"createdAt",order:"desc"}),(0,r.useEffect)((function(){x(1)}),[l]);var w=(0,r.useState)({item:c.item,order:c.order}),_=w[0],q=w[1],T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=v.query,n=void 0===t?{}:t;e>1?n.page=e:delete n.page;var r=Object.keys(n).length>0;if(r){var o=Object.keys(n).map((function(t){return"page"===t?"".concat(t,"=").concat(e):"".concat(t,"=").concat(n[t])})).join("&&");return"?".concat(o)}return{}};(0,r.useImperativeHandle)(t,(function(){return{currentPage:h,pageSize:P,sort:_,resetPagination:function(){!function(){q({item:c.item,order:c.order}),x(1);var e=T();v.push(e),Z(i.C1.paginationSize)}()}}}));return(0,s.jsx)(a.Z,{columns:n,loading:p,paginationSize:y,pagination:d&&!0,paginationProps:d&&{currentPage:h,onPageChange:function(e){var t=T(e);u&&v.push(t),x(e),f&&f()},onPageSizeChange:function(e){e!==i.C1.paginationSize&&(Z(e),f&&f())},pageCount:Math.ceil(d.aggregate.totalCount/P),perPage:P},rowClick:m,rows:b,sort:_,setSort:function(e){var t=e.item,n=e.order;q({item:t,order:n}),f&&f()}})}));u.defaultProps={history:!0,loading:!0,paginationSize:!1}},49705:function(e,t,n){n.d(t,{x:function(){return l}});var r=n(92809),o=n(67294),i=n(63867),a=n(30493),s=n(34770);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var l=function(e){var t,n,u,l,p,d,y,f,m,b,v,g=e.filters,j=e.initialSort,O=(0,o.useRef)();(0,o.useEffect)((function(){var e;(null===O||void 0===O||null===(e=O.current)||void 0===e?void 0:e.currentPage)>1&&(null===O||void 0===O||O.current.resetPagination(),(0,i.Z)("?page=1"))}),[g]);var h=j||{item:"createdAt",order:"desc"},x=(0,r.Z)({},(null===(t=O.current)||void 0===t?void 0:t.sort.item)||h.item,h.inneritem?(0,r.Z)({},h.inneritem,(null===(n=O.current)||void 0===n?void 0:n.sort.order)||h.order):(null===(u=O.current)||void 0===u?void 0:u.sort.order)||h.order);return{initialData:c(c({},g),{},{limit:"Infinity"===(null===(l=O.current)||void 0===l?void 0:l.pageSize)?null:parseInt(null===(p=O.current)||void 0===p?void 0:p.pageSize,10)||a.C1.paginationSize,offset:((null===(d=O.current)||void 0===d?void 0:d.currentPage)-1||0)*((null===(y=O.current)||void 0===y?void 0:y.pageSize)||a.C1.paginationSize),orderBy:(0,s.c)(null===(f=O.current)||void 0===f||null===(m=f.sort)||void 0===m||null===(b=m.item)||void 0===b?void 0:b.replace(/ORDER/i,null===(v=O.current)||void 0===v?void 0:v.sort.order))||x}),initialSort:j,ref:O}}},64152:function(e,t,n){n.d(t,{R:function(){return g}});var r=n(92809),o=n(67294),i=n(93633),a=n(33462),s=n(80880),u=n(91126),c=n(73165),l=n(66805),p=n(7550),d=n(81185),y=n(49705),f=n(85893);function m(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?m(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):m(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={item:"name",order:"asc"},g=function(e){var t=e.entity,n=e.entityId,r=e.refetchCompliance,m=e.parentId,g=e.type,j=(0,o.useContext)(s.Z),O=(0,y.x)({filters:{},initialSort:v}),h=O.initialData,x=O.ref,S=b(b({},h),{},{parentId:m}),P=(0,i.a)(a.Im,{variables:S}),Z=P.data,w=(Z=void 0===Z?{taxonomy:[],meta:{aggregate:{totalCount:0}}}:Z).taxonomy,_=Z.meta,q=P.loading,T=P.refetch,I=function(){T(),r&&r(),j.close()},$=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};j.show({title:r.id?"Edit":"Add",content:(0,f.jsx)(p.j,{entity:t,entityId:n,defaultValues:b(b({},r),{},{type:g}),onSuccess:I,groups:{},parentId:m})})},C=[{hidden:!0},{hidden:!0},{text:"Name"},{hidden:!0},{text:"Status"},{formatter:u.Z,formatterData:function(e){var t;return[{context:"secondary",disabled:null===(t=e.data.meta)||void 0===t?void 0:t.isSystem,icon:["fas","edit"],onClick:function(e,t){return $("edit",t.data)},tooltip:"Edit"}]},text:"Actions"}];return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(d.t,{columns:C,loading:q,meta:_,ref:x,refetch:T,rows:w.map((function(e){return{data:e,id:e.id,name:e.name,status:e.status,statusText:(0,c.Z)(e.status),actions:""}}))}),(0,f.jsx)(l.H,{content:"Add New",handleClick:$})]})}},7550:function(e,t,n){n.d(t,{j:function(){return V}});var r=n(30266),o=n(80318),i=n(92809),a=n(64687),s=n.n(a),u=n(67294),c=n(75709),l=n(33462),p=n(42283),d=n(79665),y=n(97202),f=n(65375),m=n(71247),b=n(46482),v=n(34610),g=n(11570),j=n(78215),O=n(2356),h=n(97625),x=n(22796),S=n(84550),P=[{disabled:!0,text:"Please choose...",value:""},{text:"Checkbox",value:"checkbox",hasOptions:!0},{text:"CurrencyInput",value:"currencyInput",hasOptions:!1},{text:"Datepicker",value:"datepicker",hasOptions:!1},{text:"Input",value:"input",hasOptions:!1},{text:"Radio",value:"radio",hasOptions:!0},{text:"Select",value:"select",hasOptions:!0},{text:"Range(1 - 10)",value:"selectRange",hasOptions:!1},{text:"TextArea",value:"textArea",hasOptions:!1},{text:"Upload File",value:"media",hasOptions:!1}],Z=[{text:"Email",value:"email"},{text:"Number",value:"number"},{text:"Text",value:"text"}],w=n(85893);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var T=function(e){var t=e.defaultOptions,n=(0,p.qo)({control:t.control,name:"input"}),r=n&&P.find((function(e){return e.value===n})).hasOptions,o="input"===n,i=(0,p.Dq)({control:t.control,name:"options"}),a=i.fields,s=i.append,c=i.remove;return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(f.Z,{label:"Label",children:(0,w.jsx)(m.Z,q(q({},t),{},{name:"label"}))}),(0,w.jsx)(f.Z,{label:"Input",children:(0,w.jsx)(b.Z,q(q({},t),{},{name:"input",options:P}))}),o&&(0,w.jsx)(f.Z,{label:"Type",children:(0,w.jsx)(b.Z,q(q({},t),{},{name:"inputType",options:Z}))}),r&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsxs)(j.Z,{children:[(0,w.jsx)(O.Z,{xs:4,md:4,children:(0,w.jsx)(f.Z,{label:"Options"})}),(0,w.jsx)(O.Z,{children:(0,w.jsx)(h.Z,{iconName:"plus",onClick:s})})]}),a.map((function(e,n){return(0,w.jsxs)(u.Fragment,{children:[(0,w.jsxs)(j.Z,{align:"center",children:[(0,w.jsx)(O.Z,{xs:5,md:5,children:(0,w.jsx)(m.Z,q(q({},t),{},{defaultValue:e.value,name:"options[".concat(n,"].label"),placeholder:"Label"}))}),(0,w.jsx)(O.Z,{xs:5,md:5,children:(0,w.jsx)(m.Z,q(q({},t),{},{defaultValue:e.value,name:"options[".concat(n,"].value"),placeholder:"Value"}))}),(0,w.jsx)(O.Z,{xs:2,md:2,children:(0,w.jsx)(h.Z,{iconName:"delete",onClick:function(){return c(n)}})})]}),(0,w.jsx)(x.Z,{marginBottom:"md"})]},e.id)}))]}),(0,w.jsx)(S.Z,q(q({},t),{},{name:"required",data:[{label:"Required",value:!0}],stacked:!0}))]})},I=n(75838),$=n(19501),C=function(e){var t="assetQuestion"===e||"complianceQuestions"===e||"supplierQuestion"===e;return(0,$.Ry)().shape({group:(0,$.Rx)(),input:t&&(0,$.Z_)().required(),label:t&&(0,$.Z_)().required(),name:(0,$.Z_)().required(),questions:(0,$.Xg)(),status:(0,$.Z_)().oneOf(["active","inactive"]).required(),sublocation:(0,$.Xg)()})},D=n(83789),k=[{name:"acquisitionCost",meta:{input:"currencyInput",inputType:"number",label:"Acquisition cost",isSystem:!0,questionType:"tco",required:!0}},{name:"datePutInService",meta:{input:"datepicker",inputType:"text",label:"Date put in service",isSystem:!0,questionType:"tco",required:!0}},{name:"usefulLife",meta:{input:"input",inputType:"number",label:"Useful life (months)",isSystem:!0,questionType:"tco",required:!0}},{name:"maintenanceSpend",meta:{input:"currencyInput",inputType:"number",label:"Maintenance spend (\xa3 p/m)",isSystem:!0,questionType:"tco",required:!0}},{name:"residualValue",meta:{input:"currencyInput",inputType:"number",label:"Residual Value",isSystem:!0,questionType:"tco",required:!0}}],E=[{name:"type",meta:{input:"select",inputType:"text",label:"Type",options:[{label:"Thermo",value:"thermo"},{label:"Occupancy",value:"occupancy"}],questionType:"sensor",isSystem:!0,required:!0}},{name:"brand",meta:{input:"select",inputType:"text",label:"Brand",options:[{label:"AirThings",value:"airthings"},{label:"Other",value:"other"}],questionType:"sensor",isSystem:!0,required:!0}}];function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var F=function(){var e=(0,r.Z)(s().mark((function e(t){var n,r,o,i,a,u,c;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.addTaxonomy,r=t.adminId,o=t.hasSensorQuestions,i=t.hasTCOQuestions,a=t.parentId,u={status:"active",adminId:r,parentId:a,type:"assetQuestion"},c=[],i&&c.push.apply(c,(0,D.Z)(G(k,u))),o&&c.push.apply(c,(0,D.Z)(G(E,u))),e.next=7,n({variables:{objects:[].concat(c)}});case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),G=function(e,t){return e.map((function(e){return N(N({},e),t)}))},Q=n(1323);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=function(e){var t,n,i,a,j,O,h=e.defaultValues,x=e.entity,S=e.entityId,P=e.groups,Z=e.hasSublocation,_=e.isAssetCategoryParent,q=e.onSuccess,$=e.parentId,D=void 0===$?null:$,k=e.systemQuestions,E=(0,Q.x)().user,z=(0,u.useState)(!1),N=z[0],G=z[1],A=h.type,V=(0,u.useState)(!1),B=V[0],L=V[1],J=(0,u.useState)(!1),H=J[0],W=J[1],M="assetQuestion"===A||"complianceQuestions"===A||"supplierQuestion"===A,U=(0,p.cI)({defaultValues:R(R({},h),{},{input:null===h||void 0===h||null===(t=h.meta)||void 0===t?void 0:t.input,inputType:null===h||void 0===h||null===(n=h.meta)||void 0===n?void 0:n.inputType,sensor:(null===h||void 0===h?void 0:h.hasSensor)||!1,label:null===h||void 0===h||null===(i=h.meta)||void 0===i?void 0:i.label,options:null===h||void 0===h||null===(a=h.meta)||void 0===a?void 0:a.options,required:null===h||void 0===h||null===(j=h.meta)||void 0===j?void 0:j.required,sublocation:(null===h||void 0===h||null===(O=h.meta)||void 0===O?void 0:O.sublocation)||!1}),resolver:(0,d.S)(C(A))}),Y=U.control,X=U.errors,K=U.handleSubmit,ee=U.register,te=U.setValue,ne=U.watch,re=ne("sublocation");re="false"!==re&&Boolean(re);var oe=ne("sensor");oe="false"!==oe&&Boolean(oe);var ie=function(e,t){te(e,t),ae()},ae=function(){W(!1),L(!1)},se=(0,c.D)(l.mW,{onCompleted:function(e){var t=e.insert_Taxonomy.returning[0],n=t.id,r=t.type;(N||oe)&&"assetQuestion"!==r?F({hasTCOQuestions:N,hasSensorQuestions:oe,addTaxonomy:ue,adminId:E.accountId,parentId:n}):q&&q(n)}}),ue=(0,o.Z)(se,1)[0],ce=(0,c.D)(l.ze,{onCompleted:function(e){var t=e.update_Taxonomy_by_pk,n=t.id,r=t.type;!k.sensor&&oe&&"assetQuestion"!==r?F({hasTCOQuestions:N,hasSensorQuestions:oe,addTaxonomy:ue,adminId:E.accountId,parentId:n}):q&&q(n)}}),le=(0,o.Z)(ce,1)[0],pe=function(){var e=(0,r.Z)(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D&&(t.parentId=D),!re||!oe){e.next=3;break}return e.abrupt("return",W(!0));case 3:if(!Z||!re||h.id){e.next=5;break}return e.abrupt("return",L(!0));case 5:if(_&&(t.isGroup=!0),t.entity=x,t.entityId=S,t.meta=R(R({},(null===h||void 0===h?void 0:h.meta)||{}),{},{input:t.input,options:t.options,inputType:t.inputType,label:t.label,required:Boolean(t.required),sublocation:t.sublocation}),delete t.input,delete t.inputType,delete t.sensor,delete t.label,delete t.options,delete t.required,delete t.sublocation,t.adminId=E.accountId,null===h||void 0===h||!h.id){e.next=22;break}return e.next=20,le({variables:{id:h.id,changes:t}});case 20:e.next=24;break;case 22:return e.next=24,ue({variables:{objects:[t]}});case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),de={control:Y,errors:X,register:ee},ye=R(R({},de),{},{context:"secondary",size:"sm"});return(0,w.jsxs)(y.Z,{id:"offCanvasForm",handleSubmit:K(pe),children:[(0,w.jsx)(f.Z,{label:"Name",children:(0,w.jsx)(m.Z,R(R({},de),{},{name:"name"}))}),M&&(0,w.jsx)(T,{defaultOptions:de}),(null===P||void 0===P?void 0:P.length)>0&&(0,w.jsx)(f.Z,{label:"Group",children:(0,w.jsx)(b.Z,R(R({},de),{},{name:"parentId",options:P}))}),(0,w.jsx)(f.Z,{label:"Status",children:(0,w.jsx)(b.Z,R(R({},de),{},{name:"status",options:I.bg}))}),"assetCategory"===A&&!_&&!h.id&&(0,w.jsx)(f.Z,{label:"Total cost of ownership",children:(0,w.jsx)(v.Z,{context:"secondary",onToggle:function(e){return G(e)},size:"sm",toggled:N})}),"assetCategory"===A&&!_&&(0,w.jsx)(f.Z,{label:"Sensor",children:(0,w.jsx)(v.Z,{context:"secondary",disabled:k.sensor,onToggle:function(e){return ie("sensor",e)},size:"sm",toggled:oe})}),"assetCategory"===A&&!_&&(0,w.jsx)(f.Z,{label:"Sublocation",children:(0,w.jsx)(v.Z,R(R({},ye),{},{onToggle:function(e){return ie("sublocation",e)},toggled:re}))}),B&&(0,w.jsx)(g.Z,{content:"You can only create one sublocation",context:"warning"}),H&&(0,w.jsx)(g.Z,{content:"You can only select a sub-location or a sensor",context:"warning"}),(0,w.jsx)(m.Z,R(R({},de),{},{name:"sensor",type:"hidden"})),(0,w.jsx)(m.Z,R(R({},de),{},{name:"sublocation",type:"hidden"})),(0,w.jsx)(m.Z,R(R({},de),{},{name:"type",type:"hidden"}))]})};V.defaultProps={hasSublocation:!1,isAssetCategoryParent:!1,systemQuestions:{sensor:!1}}},33462:function(e,t,n){n.d(t,{Im:function(){return d},RE:function(){return y},mW:function(){return f},ze:function(){return m},RQ:function(){return b},fC:function(){return v},uY:function(){return g}});var r,o,i,a,s,u,c,l=n(52209),p=n(54397),d=(0,p.Ps)(r||(r=(0,l.Z)(['\n  query GetTaxonomys(\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: Taxonomy_order_by!\n    $status: String = "active"\n    $type: String\n    $typeGroup: String\n    $parentId: Int\n    $fetchGroup: Boolean! = true\n    $id: Int\n    $isGroup: Boolean = false\n  ) {\n    taxonomy: Taxonomy(\n      limit: $limit\n      offset: $offset\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: $status }\n        type: { _eq: $type }\n        parentId: { _eq: $parentId }\n        id: { _eq: $id }\n        isGroup: { _eq: $isGroup }\n      }\n      order_by: [$orderBy]\n    ) {\n      options: Taxonomies(\n        where: {\n          type: { _eq: $type }\n          name: { _ilike: $q }\n          id: { _eq: $id }\n          status: { _eq: "active" }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n\n        childs: Taxonomies(order_by: { id: asc }, where: { status: { _eq: "active" } }) {\n          taxonomyId: id\n          name\n          type\n          meta\n          status\n        }\n      }\n      id\n      name\n      type\n      status\n      parentId\n      createdAt\n      meta\n      parent: Parent {\n        id\n        name\n        type\n      }\n      childs: Taxonomies(order_by: { id: asc }, where: { status: { _eq: "active" } }) {\n        taxonomyId: id\n        name\n        type\n        meta\n        status\n      }\n      jobs: Taxonomy_Entities_aggregate(\n        where: { Taxonomy: { type: { _eq: "jobTags" } }, entity: { _eq: "Job" } }\n      ) {\n        aggregate {\n          count\n        }\n      }\n    }\n    meta: Taxonomy_aggregate(\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: $status }\n        type: { _eq: $type }\n        parentId: { _eq: $parentId }\n        id: { _eq: $id }\n        isGroup: { _eq: $isGroup }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n    taxonomyGroup: Taxonomy(where: { isGroup: { _eq: true }, type: { _eq: $typeGroup } })\n      @include(if: $fetchGroup) {\n      value: id\n      text: name\n    }\n  }\n']))),y=(0,p.Ps)(o||(o=(0,l.Z)(["\n  query GetTaxonomy($id: Int!) {\n    taxonomy: Taxonomy_by_pk(id: $id) {\n      id\n      name\n      type\n      status\n      parentId\n      createdAt\n      meta\n    }\n  }\n"]))),f=(0,p.Ps)(i||(i=(0,l.Z)(["\n  mutation AddTaxonomy($objects: [Taxonomy_insert_input!]!) {\n    insert_Taxonomy(objects: $objects) {\n      returning {\n        id\n        type\n      }\n    }\n  }\n"]))),m=(0,p.Ps)(a||(a=(0,l.Z)(["\n  mutation UpdateTaxonomy($id: Int!, $changes: Taxonomy_set_input) {\n    update_Taxonomy_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n      type\n    }\n  }\n"]))),b=(0,p.Ps)(s||(s=(0,l.Z)(["\n  query GeTaxonomyWithEntities($type: String!, $entity: String!, $entityId: Int!) {\n    questions: Taxonomy(where: { type: { _eq: $type } }) {\n      id\n      meta\n      name\n      status\n      taxonomy_entity: Taxonomy_Entities(\n        where: { entityId: { _eq: $entityId }, entity: { _eq: $entity } }\n      ) {\n        comments\n      }\n    }\n  }\n"]))),v=(0,p.Ps)(u||(u=(0,l.Z)(["\n  mutation InsertTaxonomyEntity(\n    $entity: String!\n    $entityId: Int!\n    $questions: [Taxonomy_Entity_insert_input!]!\n    $objectStatusLog: [StatusLog_insert_input!]!\n    $hasStatusLog: Boolean!\n  ) {\n    delete_Taxonomy_Entity(where: { entityId: { _eq: $entityId }, entity: { _eq: $entity } }) {\n      returning {\n        id\n      }\n    }\n    insert_Taxonomy_Entity(objects: $questions) {\n      returning {\n        id\n      }\n    }\n\n    insert_StatusLog(objects: $objectStatusLog) @include(if: $hasStatusLog) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),g=(0,p.Ps)(c||(c=(0,l.Z)(["\n  query GetSLAsForJobManage {\n    slas: SLA(order_by: { name: asc }) {\n      id\n      label: name\n      notes\n    }\n  }\n"])))},72197:function(e,t,n){n.d(t,{l:function(){return m}});var r=n(92809),o=n(10219),i=n(67294),a=n(93633),s=n(33462),u=n(65375),c=n(93515),l=n(85893),p=["control","errors","label","name","register","type","filters"];function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var f=function(e,t){var n,r,o=!0;return(null===(n=e.errors[e.name])||void 0===n?void 0:n.message)!==(null===(r=t.errors[t.name])||void 0===r?void 0:r.message)&&(o=!1),["name","type"].forEach((function(n){e[n]!==t[n]&&(o=!1)})),o},m=(0,i.memo)((function(e){var t=e.control,n=e.errors,r=e.label,i=e.name,d=e.register,f=e.type,m=e.filters,b=(0,o.Z)(e,p),v={control:t,errors:n,register:d},g=function(e){var t=(0,a.a)(s.Im,{variables:y(y({isGroup:"assetCategory"===e},m),{},{orderBy:{name:"asc"},type:e})}).data,n=(t=void 0===t?{taxonomy:[]}:t).taxonomy;return"assetCategory"===e?n.map((function(e){return{label:e.name,options:e.options,childs:e.childs,meta:e.meta}})):n.map((function(e){return{label:e.name,value:e.id,childs:e.childs,meta:e.meta}}))}(f);return(0,l.jsx)(u.Z,{id:i,label:r,children:(0,l.jsx)(c.Z,y(y({},v),{},{cacheOptions:!0,isClearable:!0,options:g,name:i},b))})}),f);m.defaultProps={filters:{}}},34770:function(e,t,n){n.d(t,{s:function(){return r},c:function(){return o}});var r=function(e){try{JSON.parse(e)}catch(t){return!1}return!0},o=function(e){try{return JSON.parse(e)}catch(t){return!1}}},75838:function(e,t,n){n.d(t,{bg:function(){return r},WG:function(){return o}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],o=[{text:"Status",value:""},{text:"Open",value:"open"},{text:"Resolved",value:"resolved"},{text:"Closed",value:"closed"}]},70316:function(e,t,n){n.d(t,{J:function(){return q}});var r=n(92809),o=n(80318),i=n(10219),a=n(11163),s=n(67294),u=n(78215),c=n(2356),l=n(42283),p=n(97202),d=n(80284),y=n(65375),f=n(10973),m=n(14347),b=n(66805),v=n(69119),g=n(23855),j=n(83894);function O(e,t,n){var r=(0,s.useState)((function(){if(JSON.parse(window.sessionStorage.getItem(e))&&!Object.values(JSON.parse(window.sessionStorage[e])).includes(n))return t;try{var r=JSON.parse(window.sessionStorage.getItem(e));return r&&(r.startDate=r.startDate?(0,v.Z)((0,g.Z)(r.startDate)):null,r.endDate=r.endDate?(0,j.Z)((0,g.Z)(r.endDate)):null),r||t}catch(o){return console.log(o),t}})),o=r[0],i=r[1];return[o,function(t){try{var n=t instanceof Function?t(o):t;i(n),window.sessionStorage.setItem(e,JSON.stringify(n))}catch(r){console.log(r)}}]}var h=n(85893);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=function(e){var t=e.initialValues,n=e.renderFilters,r=e.setFilters,i=e.lastQuery,a=e.filters,v=t.filterType,g=O("form_data",t,v),j=(0,o.Z)(g,2),x=j[0],P=j[1],Z=(0,l.cI)({defaultValues:x||t}),w=Z.control,_=Z.errors,q=Z.handleSubmit,T=Z.register,I=Z.reset,$=Z.watch,C=Z.setValue,D=S(S({},$()),{},{filterType:v});(0,s.useEffect)((function(){I(D)}),[I]),(0,s.useEffect)((function(){P(D)}),[a]);var k=function(e){var n=e.query;if(n!==i){var o={q:"%".concat(n,"%")||0},a=/^\d+$/.test(n);"id"in t&&(o.id=a?Number(n):null),"meta"in t&&(o.meta=a?{invoiceNumbers:[n]}:null),"jobNumber"in t&&(o.jobNumber=a?String(n):null,o.invoiceNumber=a?Number(n):null),(o.id||o.meta||o.jobNumber)&&(o.q=null),r((function(e){return S(S({},e),o)}))}};return(0,h.jsx)(p.Z,{handleSubmit:q(k),children:(0,h.jsxs)(d.Z,{title:"Filters",children:[(0,h.jsxs)(u.Z,{children:[(0,h.jsx)(c.Z,{sm:12,lg:12,children:(0,h.jsx)(y.Z,{label:"",children:(0,h.jsx)(f.Z,{errors:_,label:"Search",name:"email",placeholder:"Search...",prependSearchIcon:!0,register:T,type:"search"})})}),(0,h.jsx)(c.Z,{sm:12,lg:12,children:n({control:w,errors:_,initialValues:t,register:T,setFilters:r,watch:$,setValue:C,reset:I})})]}),(0,h.jsx)(b.H,{content:"Search",context:"secondary",handleClick:k,type:"submit",children:(0,h.jsx)(m.Z,{content:"Clear",context:"danger",onClick:function(e){Object.keys(t).map((function(e){return C(e,null)})),r(t),I(t),k("")},size:"sm"})})]})})},Z=["FiltersComp","initialFilters","TableComp"];function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var q=function(e){var t=e.FiltersComp,n=e.initialFilters,r=e.TableComp,l=(0,i.Z)(e,Z),p=O("filters",n,n.filterType),d=(0,o.Z)(p,2),y=d[0],f=d[1],m=(0,s.useState)(y||n),b=m[0],v=m[1],g=(0,a.useRouter)().query.show;return(0,s.useEffect)((function(){f(b)}),[b]),(0,h.jsx)(u.Z,{children:(0,h.jsxs)(c.Z,{sm:12,lg:12,children:[(0,h.jsx)(P,{initialValues:n,renderFilters:function(e){return(0,h.jsx)(t,_(_(_({},e),l),{},{show:g}))},setFilters:v,filters:b}),(0,h.jsx)(r,_({filters:b,initialFilters:n},l))]})})}}}]);